import{_ as ce}from"./AppDateTimePicker-7f0cc36c.js";import{C as fe,l as m,aV as _e,aP as Ve,E as $,R as ye,o as f,c as S,q as e,w as s,W as o,s as a,G as j,H as v,a$ as be,b0 as ve,U as d,b1 as i,b2 as ge,bc as we,bd as xe,b3 as Ue,az as h,z as Se,I as q,aX as z,F,a as C,b as B,y as P,aZ as M,a_ as he,a8 as ke,a9 as De,n as _}from"./index-ad06e79a.js";import{a as je}from"./areas-cb180112.js";import{u as Fe,b as Ce}from"./branches-f687d4e9.js";import{g as Be}from"./cities-1428fd23.js";import{g as Ie}from"./days-a80e1e7b.js";import{V as Ne,a as G}from"./VTabs-8f421d6b.js";import{a as He,V as J}from"./VWindowItem-f64698f8.js";import{V as I}from"./VCombobox-26856a8e.js";import{V as k}from"./VSwitch-cab5ab76.js";import"./lazy-4cfe01f9.js";import"./ssrBoot-defe399c.js";import"./VSelect-76fdbbde.js";import"./VList-9ab7df99.js";import"./VDivider-4cc22aef.js";import"./dialog-transition-9757e826.js";import"./VMenu-0f9b48c2.js";import"./VOverlay-907c7a82.js";import"./VCheckboxBtn-f6dd6c6f.js";import"./VSelectionControl-694a1f9e.js";import"./VChip-5e82d9df.js";import"./filter-1b8aa21b.js";const V=x=>(ke("data-v-f9297c42"),x=x(),De(),x),Te=V(()=>_("p",{class:"text-h4 pt-3 pb-2"},"Update Branch",-1)),Ee=V(()=>_("p",{class:"text-h4 pt-3 pb-2"},"Address",-1)),We=V(()=>_("p",{class:"text-h3 py-1 mb-3"},"Order Type",-1)),Ae=V(()=>_("p",{class:"text-h3 py-1 mb-3"},"Branch Slots",-1)),Oe=V(()=>_("p",{class:"text-h4 py-1 mb-3"},"Size",-1)),Re=V(()=>_("p",{class:"text-h4 py-1 mb-3"},"Time",-1)),$e=V(()=>_("p",{class:"text-h4 py-1 mb-3"},"Status",-1)),L={__name:"[id]",setup(x){var R;const y=m(new Date().toISOString().substr(0,10)),X=(R=JSON.parse(localStorage.getItem("userData")))==null?void 0:R.type,N=m(),H=_e(),U=m(!1),T=m([]),D=m([]),E=m([]),W=Ve().params.id,b=m("view"),t=m({start:"",end:"",name_en:"",name_ar:"",phone_no:"",city_id:null,areas:[],street_name:"",building_no:"",email:"",password:"",est_time:"",delivery_fee:.5,code:"",working_days:[],is_active:0,time_slots:[],order_types:[],delivery_types:[],slotsForSelectedDay:[]}),A=async()=>{var n;(n=N.value)==null||n.validate().then(async({valid:u})=>{if(u){U.value=!0;try{await Fe(W,{...t.value,time_slots:{...t.value.time_slots,...t.value.slotsForSelectedDay}}),H.success("Branch updated successfully"),U.value=!1}catch(r){H.error(r.response.data.message),U.value=!1}}})},O=()=>{t.value.time_slots&&t.value.time_slots.length>0&&(t.value.slotsForSelectedDay=t.value.time_slots.filter(n=>n.day===y.value))},Z=()=>{Be().then(({data:n,meta:u})=>{E.value=n.data})},K=()=>{Ie().then(({data:n,meta:u})=>{T.value=n.data})},Q=async()=>{await Ce(W).then(n=>{let{start:u,end:r,name_en:p,name_ar:l,phone_no:c,areas:g,city_id:Y,street_name:ee,building_no:ae,email:le,password:te,est_time:se,delivery_fee:ue,code:oe,days:de,is_active:ne,time_slots:re,order_types:ie,delivery_types:me}=n.data.data;t.value={start:u,end:r,name_en:p,name_ar:l,phone_no:c,areas:g,city_id:Y,street_name:ee,building_no:ae,email:le,password:te,est_time:se,delivery_fee:ue,code:oe,is_active:ne,time_slots:re,order_types:ie,delivery_types:me},console.log(t.value),t.value.working_days=de.map(w=>w.id),t.value.email=n.data.data.user.email,je().then(({data:w,meta:qe})=>{D.value=w.data,t.value.areas.forEach(pe=>{D.value.push(pe)})}).finally(()=>{t.value.areas=t.value.areas.map(w=>w.id)})})};return $(y,n=>{const u=t.value.time_slots.filter(r=>r.day===n)||[];t.value.slotsForSelectedDay=u}),$(()=>[t.value.time_slots,y.value],()=>{O()},{immediate:!0}),ye(()=>{X=="admin"&&(Z(),K(),Q().then(()=>{O()}))}),(n,u)=>{const r=he,p=ce;return f(),S("div",null,[e(d,{class:"mt-4 px-4",justify:"space-around"},{default:s(()=>[e(o,{class:"pt-0"},{default:s(()=>[e(o,{class:"py-5"},{default:s(()=>[e(Ne,{modelValue:a(b),"onUpdate:modelValue":u[0]||(u[0]=l=>j(b)?b.value=l:null),class:"v-tabs-pill"},{default:s(()=>[e(G,{value:"view"},{default:s(()=>[v("Update Branch")]),_:1}),e(G,{value:"slots"},{default:s(()=>[v("Update Slots")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(He,{modelValue:a(b),"onUpdate:modelValue":u[16]||(u[16]=l=>j(b)?b.value=l:null)},{default:s(()=>[e(J,{value:"view"},{default:s(()=>[e(a(be),{ref_key:"refVForm",ref:N,onSubmit:ve(A,["prevent"])},{default:s(()=>[e(o,{class:"px-5 rounded pb-10",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:s(()=>[Te,e(o,null,{default:s(()=>[e(d,{justify:"space-between",align:"start"},{default:s(()=>[e(r,{rules:[a(i)],style:{width:"100%"},class:"pe-3 w-50",modelValue:a(t).name_en,"onUpdate:modelValue":u[1]||(u[1]=l=>a(t).name_en=l),label:"Name"},null,8,["rules","modelValue"]),e(r,{rules:[a(i)],style:{width:"100%"},class:"ps-3 w-50 text-right",dir:"rtl",modelValue:a(t).name_ar,"onUpdate:modelValue":u[2]||(u[2]=l=>a(t).name_ar=l),label:"الاسم"},null,8,["rules","modelValue"])]),_:1}),e(d,{class:"mt-10",justify:"space-between",align:"start"},{default:s(()=>[e(r,{rules:[a(i),a(ge),a(we)],style:{width:"100%"},class:"pe-3 w-50",modelValue:a(t).phone_no,"onUpdate:modelValue":u[3]||(u[3]=l=>a(t).phone_no=l),label:"Phone Number"},null,8,["rules","modelValue"]),e(r,{rules:[a(i),a(xe)],style:{width:"100%"},class:"ps-3 w-50",modelValue:a(t).email,"onUpdate:modelValue":u[4]||(u[4]=l=>a(t).email=l),label:"Email"},null,8,["rules","modelValue"])]),_:1}),e(d,{class:"mt-10",justify:"space-between",align:"end"},{default:s(()=>[e(I,{modelValue:a(t).working_days,"onUpdate:modelValue":u[5]||(u[5]=l=>a(t).working_days=l),multiple:"",rules:[a(i)],style:{width:"100%"},class:"pe-3 w-50",items:a(T),variant:"outlined",label:"Working Days","item-value":"id","item-title":"name","return-object":!1},null,8,["modelValue","rules","items"]),e(p,{modelValue:a(t).start,"onUpdate:modelValue":u[6]||(u[6]=l=>a(t).start=l),label:"Start Working Hours",class:"ps-3 flex-grow-0",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue"])]),_:1}),e(d,{class:"mt-10",justify:"space-between",align:"start"},{default:s(()=>[e(p,{modelValue:a(t).end,"onUpdate:modelValue":u[7]||(u[7]=l=>a(t).end=l),label:"End Working Hours",class:"pe-3 flex-grow-0",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue"]),e(r,{rules:[a(i),a(Ue)],style:{width:"100%"},class:"ps-3 w-50",modelValue:a(t).est_time,"onUpdate:modelValue":u[8]||(u[8]=l=>a(t).est_time=l),label:"Estimate Time"},null,8,["rules","modelValue"])]),_:1}),e(d,{class:"mt-10",justify:"space-between",align:"start"},{default:s(()=>[e(r,{rules:[a(i)],style:{width:"100%"},class:"pe-3 w-50",modelValue:a(t).code,"onUpdate:modelValue":u[9]||(u[9]=l=>a(t).code=l),label:"Branch Code"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1}),e(o,{class:"mt-10 px-5 rounded",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:s(()=>[Ee,e(o,null,{default:s(()=>[e(d,{justify:"space-between",align:"start"},{default:s(()=>[e(I,{modelValue:a(t).city_id,"onUpdate:modelValue":u[10]||(u[10]=l=>a(t).city_id=l),rules:[a(i)],items:a(E),"item-value":"id","item-title":"name",style:{width:"100%"},variant:"outlined",label:"Cities",class:"flex-grow-1 pe-3 my-2 w-50","return-object":!1},null,8,["modelValue","rules","items"]),e(I,{modelValue:a(t).areas,"onUpdate:modelValue":u[11]||(u[11]=l=>a(t).areas=l),multiple:"",rules:[a(i)],disabled:!a(t).city_id,items:a(D),style:{width:"100%"},variant:"outlined",label:"Areas",class:"flex-grow-1 my-2 ps-3 w-50","return-object":!1,"item-value":"id","item-title":"name",clearable:""},null,8,["modelValue","rules","disabled","items"])]),_:1}),e(d,{class:"mt-10",justify:"space-between",align:"start"},{default:s(()=>[e(r,{rules:[a(i)],style:{width:"100%"},class:"pe-3 w-50",modelValue:a(t).street_name,"onUpdate:modelValue":u[12]||(u[12]=l=>a(t).street_name=l),label:"Street Name"},null,8,["rules","modelValue"]),e(r,{rules:[a(i)],style:{width:"100%"},class:"ps-3 w-50",modelValue:a(t).building_no,"onUpdate:modelValue":u[13]||(u[13]=l=>a(t).building_no=l),label:"Building Number"},null,8,["rules","modelValue"])]),_:1})]),_:1}),e(d,{class:"pb-6 mt-8 px-3",align:"center",justify:"center"},{default:s(()=>[e(h,{block:n.$vuetify.display.xs,color:"primary",class:"px-12",loading:a(U),type:"submit"},{default:s(()=>[e(Se,{start:"",icon:"tabler-check"}),v("Update ")]),_:1},8,["block","loading"]),e(k,{class:"ml-7",modelValue:a(t).is_active,"onUpdate:modelValue":u[14]||(u[14]=l=>a(t).is_active=l),"false-value":0,"true-value":1,inset:!1,label:"Active"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(J,{value:"slots"},{default:s(()=>[e(q,{rounded:"lg",class:"pb-6 px-0 mb-10",variant:"flat"},{default:s(()=>[e(z,null,{default:s(()=>[e(d,null,{default:s(()=>[e(o,null,{default:s(()=>[We]),_:1})]),_:1}),e(d,{class:"order-types"},{default:s(()=>[(f(!0),S(F,null,C(a(t).order_types,l=>(f(),B(o,{key:l.id,class:"d-flex",style:{"justify-content":"center","align-items":"center",gap:"20px"}},{default:s(()=>[e(h,{disabled:!l.status},{default:s(()=>[v(P(l.name),1)]),_:2},1032,["disabled"]),e(k,{modelValue:l.status,"onUpdate:modelValue":c=>l.status=c,inset:!1,"true-value":1,"false-value":0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(q,{rounded:"lg",class:"pb-6 px-0",variant:"flat"},{default:s(()=>[e(z,null,{default:s(()=>[e(d,{style:{display:"flex","justify-content":"space-between","align-items":"center"}},{default:s(()=>[e(o,null,{default:s(()=>[Ae]),_:1}),e(o,null,{default:s(()=>[e(p,{modelValue:a(y),"onUpdate:modelValue":u[15]||(u[15]=l=>j(y)?y.value=l:null),config:{minDate:new Date().toISOString().substr(0,10),maxDate:new Date(new Date().setDate(new Date().getDate()+6)).toISOString().substr(0,10)}},null,8,["modelValue","config"])]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(o,{class:"text-center"},{default:s(()=>[Oe]),_:1}),e(o,{class:"text-center"},{default:s(()=>[Re]),_:1}),e(o,{class:"text-center"},{default:s(()=>[$e]),_:1})]),_:1}),(f(!0),S(F,null,C(a(t).slotsForSelectedDay,(l,c)=>(f(),B(d,{key:c,class:"mb-2"},{default:s(()=>[e(o,{class:"text-center"},{default:s(()=>[e(r,{modelValue:l.capacity,"onUpdate:modelValue":g=>l.capacity=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(o,{class:"text-center d-flex",style:{}},{default:s(()=>[e(p,{config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"},value:l.from,"prepend-inner-icon":"tabler-calendar",class:"flex-grow-1 mx-2 my-1",disabled:!0},null,8,["value"]),e(p,{config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"},value:l.to,"prepend-inner-icon":"tabler-calendar",class:"flex-grow-1 mx-2 my-1",disabled:!0},null,8,["value"])]),_:2},1024),e(o,{class:"text-center d-flex",style:{"justify-content":"center","align-items":"center"}},{default:s(()=>[e(k,{modelValue:l.status,"onUpdate:modelValue":g=>l.status=g,inset:!1,"false-value":0,"true-value":1},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128)),e(d,{class:"delivery-types"},{default:s(()=>[(f(!0),S(F,null,C(a(t).delivery_types,l=>(f(),B(o,{key:l.id,class:"d-flex",style:{"justify-content":"center","align-items":"center",gap:"20px"}},{default:s(()=>[e(h,{disabled:!l.status},{default:s(()=>[v(P(l.name),1)]),_:2},1032,["disabled"]),e(k,{modelValue:l.status,"onUpdate:modelValue":c=>l.status=c,inset:!1,"true-value":1,"false-value":0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(o,{class:"mr-10",style:{display:"flex","justify-content":"flex-end","align-items":"center"}},{default:s(()=>[e(h,{onClick:A},{default:s(()=>[v("Save Changes")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}};typeof M=="function"&&M(L);const ma=fe(L,[["__scopeId","data-v-f9297c42"]]);export{ma as default};
