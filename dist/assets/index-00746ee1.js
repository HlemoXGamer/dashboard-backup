import{_ as ee}from"./DialogCloseBtn-513e4898.js";import{r as te,g as le}from"./products-c2b322c9.js";import{r as ae,g as oe}from"./products-a8249be9.js";import{D as K,O as W,l as d,aV as re,r as se,o as _,c as Q,q as e,w as o,s as t,I as M,aX as X,H as w,y as g,az as F,G as k,t as L,n as J,z as G,b as U,A as B,F as ne,R as ue,a1 as j,a2 as q,aZ as Y,Y as de,a_ as ie}from"./index-581c2083.js";import{V as ce}from"./VDialog-9c77a5f1.js";import{V as me}from"./VDataTable-06e6a8ff.js";import{V as pe}from"./VChip-2cd4c1fb.js";import{g as fe}from"./categories-df5ecb75.js";import{g as ge}from"./categories-f7a66fa1.js";import{V as ve,a as Z}from"./VTabs-9a55101d.js";import{V as ye}from"./VSpacer-78f2ea51.js";import{V as E,a as Ve}from"./VWindowItem-c0d01332.js";import{V as z}from"./VCombobox-6fdf6a72.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./dialog-transition-e2ab3ff7.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VSelect-91e75b33.js";import"./VList-800b0139.js";import"./ssrBoot-f2e19377.js";import"./VDivider-007f86e5.js";import"./VMenu-568d971d.js";import"./filter-887944dd.js";import"./VTable-db7fafcb.js";const he={__name:"ProductsTable",props:{products:{type:Array,default:[]},searchTerm:{type:Object,default:{term:"",category:""}},loading:{type:Boolean,default:!1},closed:{type:Boolean,default:!1}},setup(D){var O;const h=D,y=K(),c=y.t,C=W(()=>{if(y.locale.value==="en")return"name_en";if(y.locale.value==="ar")return"name_ar"}),R=(O=JSON.parse(localStorage.getItem("userData")))==null?void 0:O.type,$=d([]),m=d(!1),p=re(),u=d(!1),b=W(()=>[{title:c("Product Code"),key:"code"},{title:c("Product Name"),key:C},{title:c("Price"),key:"price"},{title:c("Status"),key:"is_active"},{title:c("Created Date"),key:"created_at"},{title:c("Actions"),key:"actions",sortable:!1,align:"center"},{title:c("id"),key:"id",align:" d-none"}]),V=s=>{if(parseInt(s)!==0)return{color:"success",text:"Active"};if(parseInt(s)===0)return{color:"secondary",text:"Disabled"}};let x={};const T=s=>{console.log(s),x=s,$.value=JSON.stringify(s),$.value=JSON.parse($.value),u.value=!0},N=async()=>{var s,n;m.value=!0;try{R=="admin"?await te($.value.id):await ae($.value.id),h.products.splice(h.products.indexOf(x),1),p.success("Product deleted successfully"),m.value=!1,u.value=!1}catch(f){p.error((n=(s=f==null?void 0:f.response)==null?void 0:s.data)==null?void 0:n.message)}},v=()=>{let s=h.products,n=h.searchTerm.category,f=h.searchTerm.term;return String(f).length>0&&f!==null&&(s=s.filter(P=>String(P.name_en).toLowerCase().includes(f.toLowerCase()))),String(n).length>0&&n!==null&&(s=s.filter(P=>n.some(i=>P.categories.map(A=>A.id).includes(i)))),s};return(s,n)=>{const f=ee,P=se("IconBtn");return _(),Q(ne,null,[e(ce,{modelValue:t(u),"onUpdate:modelValue":n[3]||(n[3]=i=>k(u)?u.value=i:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[e(f,{onClick:n[0]||(n[0]=i=>u.value=!t(u))}),e(M,{title:"Delete Product"},{default:o(()=>[e(X,null,{default:o(()=>[w(g(s.$t("Are you sure that you want to delete this Product?")),1)]),_:1}),e(X,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[e(F,{color:"secondary",variant:"tonal",onClick:n[1]||(n[1]=i=>u.value=!1),disabled:t(m)},{default:o(()=>[w(g(s.$t("Cancel")),1)]),_:1},8,["disabled"]),e(F,{onClick:n[2]||(n[2]=i=>N()),loading:t(m)},{default:o(()=>[w(g(s.$t("Delete")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(M,{elevation:"0",rounded:"0",class:L(["px-0 mb-0 pb-5 pt-2",{"mt-6":D.closed,"mt-10":!D.closed}]),loading:D.loading},{default:o(()=>[e(t(me),{items:v(),headers:t(b),"items-per-page":15},{"item.is_active":o(({item:i})=>[e(pe,{color:V(i.raw.is_active).color,class:L([`text-${V(i.raw.is_active).color}`,"font-weight-medium"]),size:"small"},{default:o(()=>[w(g(V(i.raw.is_active).text),1)]),_:2},1032,["color","class"])]),"item.actions":o(({item:i})=>[J("div",{class:L({"d-flex gap-1":!D.closed})},[e(P,{onClick:A=>s.$router.push(`/products/edit/${i.raw.id}`)},{default:o(()=>[e(G,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),D.closed?B("",!0):(_(),U(P,{key:0},{default:o(()=>[e(G,{icon:"mdi-delete-outline",onClick:A=>T(i.raw)},null,8,["onClick"])]),_:2},1024))],2)]),_:1},8,["items","headers"])]),_:1},8,["class","loading"])],64)}}},be={class:"text-h4 pt-3 pb-5 px-3"},xe={class:"text-h4 pt-3 pb-0 px-3"},ke={class:"text-h4 pt-3 pb-0 px-3"},we={__name:"index",setup(D){var H;const h=K().t,y=d("products"),c=d([]),C=d([]),R=d([]),$=d([]),m=d([]),p=d(""),u=(H=JSON.parse(localStorage.getItem("userData")))==null?void 0:H.type,b=d(!1),V=d([]),x=d(""),T=d(!1),N=d(!1),v=d({searchTerm:"",selectedCategory:[]}),O=async()=>{T.value=!0,b.value=!0,u=="admin"?await le().then(({data:a,meta:l})=>{C.value=a.data}):u=="markter"&&await oe().then(({data:a,meta:l})=>{C.value=a.data}),R.value=C.value.filter(a=>a.is_active===0),$.value=C.value.filter(a=>a.is_pre===1),b.value=!1,T.value=!1},s=()=>{u=="admin"?fe().then(({data:a,meta:l})=>{c.value=a.data}):u=="markter"&&ge().then(({data:a,meta:l})=>{c.value=a.data})},n=(a=!1)=>{let l={term:"",category:""};return a?(p.value!==""&&p.value!==null&&(l.term=p.value),m.value!==""&&m.value!==null&&(l.category=m.value)):(x.value!==""&&x.value!==null&&(l.term=x.value),V.value!==""&&V.value!==null&&(l.category=V.value)),l},f=()=>{let a={};return v.value.searchTerm!==""&&(a.name=v.value.searchTerm),v.value.selectedCategory.length>0&&(a.category=v.value.selectedCategory),{filters:a}},P=a=>{N.value=!0;const l=new FormData;Object.entries(a).forEach(([S,r])=>{l.append(S,r)});const I=new URLSearchParams(l).toString();b.value=!0,T.value=!0,de.get(`/products?${I}`).then(({data:S})=>{C.value=S.data,meta.value=S.meta}).finally(()=>{b.value=!1,T.value=!1})},i=W(()=>Object.keys(f().filters)),A=()=>{N.value=!1,v.value={searchTerm:"",selectedCategory:[]},O()};return ue(()=>{O(),s()}),(a,l)=>{const I=ie,S=he;return _(),Q("div",null,[e(j,{class:"mx-0 my-0"},{default:o(()=>[e(ve,{modelValue:t(y),"onUpdate:modelValue":l[0]||(l[0]=r=>k(y)?y.value=r:null),class:"mx-auto v-tabs-pill"},{default:o(()=>[e(Z,{value:"products"},{default:o(()=>[w(g(a.$t("Products")),1)]),_:1}),e(Z,{value:"closed_products"},{default:o(()=>[w(g(a.$t("Closed Products")),1)]),_:1})]),_:1},8,["modelValue"]),e(ye)]),_:1}),e(Ve,{modelValue:t(y),"onUpdate:modelValue":l[11]||(l[11]=r=>k(y)?y.value=r:null)},{default:o(()=>[e(E,{value:"products"},{default:o(()=>[e(j,{class:"mt-4 px-4"},{default:o(()=>[e(q,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded"},{default:o(()=>[e(j,{"no-gutters":"",align:"start",justify:"space-between"},{default:o(()=>[J("p",be,g(t(h)("Products")),1),e(F,{class:"mb-5 mt-3 me-3",onClick:l[1]||(l[1]=r=>a.$router.push("/products/add/"))},{default:o(()=>[e(G,{start:"",icon:"tabler-plus"}),w(g(a.$t("Add Product")),1)]),_:1})]),_:1}),e(j,{class:"px-7",align:"center",justify:"space-between"},{default:o(()=>[e(j,{align:"center",justify:"center","justify-lg":"start"},{default:o(()=>[t(u)=="markter"?(_(),U(I,{key:0,"prepend-inner-icon":"tabler-search",modelValue:t(x),"onUpdate:modelValue":l[2]||(l[2]=r=>k(x)?x.value=r:null),placeholder:a.$t("Search for a Product"),class:"mx-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","placeholder"])):B("",!0),t(u)=="admin"?(_(),U(I,{key:1,"prepend-inner-icon":"tabler-search",modelValue:t(v).searchTerm,"onUpdate:modelValue":l[3]||(l[3]=r=>t(v).searchTerm=r),placeholder:a.$t("Search for a Product"),class:"mx-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","placeholder"])):B("",!0),t(u)=="markter"?(_(),U(z,{key:2,"prepend-inner-icon":"tabler-bookmark",multiple:"",placeholder:a.$t("Select a Category"),modelValue:t(V),"onUpdate:modelValue":l[4]||(l[4]=r=>k(V)?V.value=r:null),class:"flex-grow-0 mx-2 mt-2 mt-lg-0 mt-md-0 mt-sm-0",items:t(c),"item-title":"name_en","item-value":"id",style:{width:"300px"},"return-object":!1},null,8,["placeholder","modelValue","items"])):B("",!0),t(u)=="admin"?(_(),U(z,{key:3,"prepend-inner-icon":"tabler-bookmark",multiple:"",placeholder:a.$t("Select a Category"),modelValue:t(v).selectedCategory,"onUpdate:modelValue":l[5]||(l[5]=r=>t(v).selectedCategory=r),class:"flex-grow-0 mx-2 mt-2 mt-lg-0 mt-md-0 mt-sm-0",items:t(c),"item-title":"name_en","item-value":"id",style:{width:"300px"},"return-object":!1},null,8,["placeholder","modelValue","items"])):B("",!0),t(u)=="admin"?(_(),U(F,{key:4,class:"mx-0 mt-0",variant:"tonal",color:"success","prepend-icon":"tabler-search",onClick:l[6]||(l[6]=r=>P(f().filters)),disabled:!t(i).length||t(T)},{default:o(()=>[w(g(a.$t("Search")),1)]),_:1},8,["disabled"])):B("",!0),e(F,{class:"mx-2",variant:"tonal",color:"warning","prepend-icon":"tabler-x",onClick:A,disabled:t(T)||!t(N)},{default:o(()=>[w(g(a.$t("Reset")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),e(S,{loading:t(b),products:t(C),searchTerm:n()},null,8,["loading","products","searchTerm"])]),_:1})]),_:1})]),_:1}),e(E,{value:"closed_products"},{default:o(()=>[e(q,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded mt-4"},{default:o(()=>[J("p",xe,g(t(h)("Closed Products")),1),e(j,{align:"center",justify:"center","justify-lg":"start",class:"mx-0 my-0 px-0 py-0"},{default:o(()=>[e(I,{"prepend-inner-icon":"tabler-search",modelValue:t(p),"onUpdate:modelValue":l[7]||(l[7]=r=>k(p)?p.value=r:null),placeholder:a.$t("Search for a Product"),class:"mx-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","placeholder"]),e(z,{"prepend-inner-icon":"tabler-bookmark",multiple:"",placeholder:a.$t("Select a Category"),modelValue:t(m),"onUpdate:modelValue":l[8]||(l[8]=r=>k(m)?m.value=r:null),class:"flex-grow-0 mx-2 mt-2 mt-lg-0 mt-md-0 mt-sm-0",items:t(c),"item-title":"name_en","item-value":"id",style:{width:"300px"},"return-object":!1},null,8,["placeholder","modelValue","items"])]),_:1}),e(S,{closed:"",loading:t(b),products:t(R),searchTerm:n(!0)},null,8,["loading","products","searchTerm"])]),_:1})]),_:1}),e(E,{value:"pre_products"},{default:o(()=>[e(q,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded mt-4"},{default:o(()=>[J("p",ke,g(t(h)("Pre Products")),1),e(j,{align:"center",justify:"center","justify-lg":"start",class:"mx-0 my-0 px-0 py-0"},{default:o(()=>[e(I,{"prepend-inner-icon":"tabler-search",modelValue:t(p),"onUpdate:modelValue":l[9]||(l[9]=r=>k(p)?p.value=r:null),placeholder:a.$t("Search for a Product"),class:"mx-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","placeholder"]),e(z,{"prepend-inner-icon":"tabler-bookmark",multiple:"",placeholder:a.$t("Select a Category"),modelValue:t(m),"onUpdate:modelValue":l[10]||(l[10]=r=>k(m)?m.value=r:null),class:"flex-grow-0 mx-2 mt-2 mt-lg-0 mt-md-0 mt-sm-0",items:t(c),"item-title":"name_en","item-value":"id",style:{width:"300px"},"return-object":!1},null,8,["placeholder","modelValue","items"])]),_:1}),e(S,{closed:"",loading:t(b),products:t($),searchTerm:n(!0)},null,8,["loading","products","searchTerm"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};typeof Y=="function"&&Y(we);export{we as default};
