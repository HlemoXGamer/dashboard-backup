import{D as ue,O as B,l as u,R as me,o as C,b as D,w as d,q as r,s as a,G as le,U as I,A as se,I as ke,b5 as oe,b6 as X,C as xe,c as Ce,H as O,az as M,y as W,W as ae,t as y,aY as g,aZ as de,a6 as Pe,a_ as je,a8 as Se,a9 as Re,n as Ue}from"./index-682f2e6a.js";import{V as Oe}from"./VDataTable-67defd0e.js";import{V as Be}from"./VPagination-b586a02c.js";import{_ as Ie}from"./AppDateTimePicker-14c2d2c6.js";import{a as De}from"./branches-e8e8397c.js";import{g as Te}from"./deliveries-ef7c0ad7.js";import{g as Ae}from"./areas-987deb91.js";import{g as Ee}from"./agents-a9c1dbd8.js";import{a as ze}from"./products-0bf2b942.js";import{g as Ne}from"./categories-0eeef004.js";import{a as K}from"./stats-8e9f2d4f.js";import{g as Fe,a as _e}from"./deliveries-3e1aee81.js";import{g as qe,a as Le,b as Me,c as We,d as Ke,e as Ge,f as He,h as Je,i as Qe}from"./agents-5bc0dca7.js";import{g as G,d as H,e as J,f as Q}from"./stats-b01531a4.js";import{g as Ye}from"./branches-7f707a64.js";import{g as Ze}from"./deliveries-61c6b9e0.js";import{g as Xe}from"./branches-b37bf8ae.js";import{g as et}from"./deliveries-7a55b98b.js";import{g as tt}from"./areas-0a41bcdf.js";import{g as at}from"./products-0e044d29.js";import{V as lt,a as st}from"./VTabs-e5eff2b4.js";import{V as ot}from"./VSpacer-47b979b4.js";import{V as rt,a as it}from"./VWindowItem-50dc88fa.js";import{V as $}from"./VCombobox-c6183851.js";import"./VCheckboxBtn-691616ae.js";import"./VSelectionControl-112402b4.js";import"./VSelect-8789e440.js";import"./VList-3d2bc339.js";import"./ssrBoot-3ed9260a.js";import"./VDivider-30c85da5.js";import"./dialog-transition-21a01739.js";import"./VMenu-992f9162.js";import"./VOverlay-dba30eee.js";import"./lazy-adf178f7.js";import"./VChip-83fe915e.js";import"./filter-db90137a.js";import"./VTable-c0cceedf.js";const nt={__name:"ProductCategoryReport",props:{filters:{type:Object,default:{}},reports:{type:Array,default:[]},meta:{type:Object,default:{}},gettingReports:{type:Boolean,default:!1},hasProducts:{type:Boolean,default:!1}},setup(h,{emit:P}){const c=h,f=ue().t,T=B(()=>[{title:f("Order ID"),key:"id",width:"200px"},{title:f("Branch"),sortable:!1,key:"branch",width:"200px"},{title:f("Area"),sortable:!1,key:"area",width:"200px"},{title:f("Product"),sortable:!1,key:"first_product",width:"200px"},{title:f("Price"),sortable:!1,key:"price",width:"200px"},{title:f("Quantity"),sortable:!1,key:"quantity",width:"200px"},{title:f("Total Amount"),sortable:!1,key:"total_amount",width:"200px"},{title:f("Created By"),sortable:!1,key:"created_by",width:"200px"},{title:f("Delivery Type"),sortable:!1,key:"delivery_type",width:"200px"}]),V=u(),Y=()=>{P("update-sort-by",V.value)},Z=w=>{P("update-page-n",w)};return me(()=>{}),(w,k)=>(C(),D(ke,{elevation:"0",class:"px-0 mb-0 pb-0 mt-5 pt-3",loading:h.gettingReports},{default:d(()=>[r(a(Oe),{"sort-by":a(V),"onUpdate:sortBy":[k[1]||(k[1]=j=>le(V)?V.value=j:null),Y],items:h.reports,headers:a(T),"items-per-page":15},{bottom:d(()=>[r(I,{class:"mt-3 mb-0 pb-0 mx-0",align:"center",justify:"end"},{default:d(()=>[c.meta.total?(C(),D(Be,{key:0,"total-visible":"5",modelValue:c.meta.current_page,"onUpdate:modelValue":[k[0]||(k[0]=j=>c.meta.current_page=j),Z],length:Math.ceil(c.meta.total/c.meta.per_page),disabled:c.gettingReports,size:35},null,8,["modelValue","length","disabled"])):se("",!0)]),_:1})]),_:1},8,["sort-by","items","headers"])]),_:1},8,["loading"]))}};function dt(){return oe.get("/operation/products?hasExtra")}let{get:ut,show:ta,update:aa,create:la,remove:sa}=X("/operation/categories");function mt(){return oe.get("/logistic/products?hasExtra")}let{get:pt,show:oa,update:ra,create:ia,remove:na}=X("/logistic/categories");function ct(){return oe.get("/finance/products?hasExtra")}let{get:yt,show:da,update:ua,create:ma,remove:pa}=X("/finance/categories"),{get:ft,show:ca,update:ya,create:fa,remove:ga}=X("/agent/categories");const gt=h=>(Se("data-v-0846af30"),h=h(),Re(),h),vt=gt(()=>Ue("p",{class:"text-h4 pt-3 pb-0 mb-3 px-3"},"Products And Categories",-1)),pe={__name:"index",setup(h){const P=ue(),c=P.t,i=JSON.parse(localStorage.getItem("userData")).type,f=B(()=>{if(P.locale.value==="en")return"name_en";if(P.locale.value==="ar")return"name_ar"}),T=u(0),V=u([]),Y=u([]),Z=u([]),w=u([]),k=u([]),j=u([]),re=u([]),ie=u(),v=u(!1),S=u(!1),ee=u(!1),R=u("reports"),ce=u([{title:"Pickup",value:1},{title:"Delivery",value:0}]),o=u({branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[],orderId:"",delivery_type:""}),A=B(()=>o.value.product.length==w.value.length),ye=u([{name:c("Created"),value:"created"},{name:c("Paid"),value:"paid"},{name:c("In Progress"),value:"in_progress"},{name:c("Ready For Delivery"),value:"ready_for_delivery"},{name:c("On The Way"),value:"on_the_way"},{name:c("Delivered"),value:"delivered"},{name:c("Cancelled"),value:"cancelled"}]),fe=u([{name:"Knet",value:"knet"},{name:"Bookey",value:"bookey"},{name:"Credit Card",value:"credit_card"}]),U=u(),ge=e=>{if(v.value=!0,S.value===!0){const t=new FormData,l=x().filters;Object.keys(l).includes("status")&&(Object.keys(l).includes("from")||Object.keys(l).includes("to"))&&(l.status.forEach(p=>{let s=te(p);l.from&&t.append(`${s}From`,l.from),l.to&&t.append(`${s}To`,l.to)}),l==null||delete l.status,l==null||delete l.from,l==null||delete l.to),A.value==!0&&(delete l.product,t.append("allProducts","")),Object.entries(l).forEach(([p,s])=>{t.append(p,s)}),t.append("page",e),t.append("limit",15);const m=new URLSearchParams(t).toString();v.value=!0,S.value=!0,i=="admin"?n(K,m):i=="agent"?n(G,m):i=="finance"?n(H,m):i=="logistic"?n(J,m):i=="operation"&&n(Q,m)}else{const t=new URLSearchParams({page:e,limit:15,sortBy:U.value??""}).toString();i=="admin"?n(K,t):i=="agent"?n(G,t):i=="finance"?n(H,t):i=="logistic"?n(J,t):i=="operation"&&n(Q,t)}},ve=e=>{U.value=e},E=e=>{e().then(({data:t})=>{V.value=t.data})},z=e=>{e().then(({data:t})=>{re.value=t.data})},N=e=>{e().then(({data:t})=>{j.value=t.data})},n=(e,t="allProducts")=>{v.value=!0,e(t).then(({data:l})=>{ie.value=l.meta,k.value=l.data}).finally(()=>{v.value=!1})},F=e=>{e().then(({data:t})=>{Z.value=t.data})},_=e=>{e().then(({data:t})=>{Y.value=t.data})},q=e=>{e().then(({data:t})=>{w.value=t.data})},x=()=>{let e={};return Object.entries(o.value).forEach(([t,l])=>{l!==null&&l.length&&(e[t]=l)}),{filters:e}},ne=()=>{if(o.value.product.length==w.value.length)o.value.product=[];else{let e=w.value.map(t=>t.id).filter(t=>!o.value.product.includes(t));o.value.product.push(...e)}},te=e=>e.replace(/_([a-z])/g,function(t,l){return l.toUpperCase()}),be=e=>{const t=new FormData;t.append("page",1),t.append("limit",15),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(m=>{let p=te(m);e.from&&t.append(`${p}From`,e.from),e.to&&t.append(`${p}To`,e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),A.value==!0&&(delete e.product,t.append("allProducts","")),Object.entries(e).forEach(([m,p])=>{t.append(m,p)});const l=new URLSearchParams(t).toString();v.value=!0,S.value=!0,i=="admin"?n(K,l):i=="agent"?n(G,l):i=="finance"?n(H,l):i=="logistic"?n(J,l):i=="operation"&&n(Q,l)},$e=()=>{S.value=!1,o.value={branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[],delivery_type:""},i=="admin"?n(K):i=="agent"?n(G):i=="finance"?n(H):i=="logistic"?n(J):i=="operation"&&n(Q)},he=()=>{let e={};U.value!==void 0&&U.value.length>0&&(e["sortBy[]"]=`${U.value[0].order}-${U.value[0].key}`);const t=x().filters;Object.entries(t).forEach(([m,p])=>{e[m]=p}),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(m=>{let p=te(m);e.from&&(e[`${p}From`]=e.from),e.to&&(e[`${p}To`]=e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),A.value==!0&&(delete e.product,e.allProducts=""),ee.value=!0;const l=new URLSearchParams(e).toString();Pe.get(`${i!=="admin"?`/${i}`:""}/stats/custom?export${l.length?"&"+l:l}`,{responseType:"arraybuffer"}).then(m=>{const p=new Blob([m.data],{type:"application/vnd.ms-excel"}),s=window.URL.createObjectURL(p),L=document.createElement("a");L.href=s,L.setAttribute("download","custom-report.xlsx"),document.body.appendChild(L),L.click(),document.body.removeChild(L)}).finally(()=>{ee.value=!1})},we=B(()=>Object.keys(x().filters)),Ve=B(()=>(Object.keys(x().filters).includes("product")||Object.keys(x().filters).includes("category"))&&S.value===!0&&v.value===!1),b=B(()=>(T.value+=1,o.value.product.length===0&&o.value.category.length===0));return me(()=>{i=="admin"?(n(K),z(Ae),F(De),E(Te),N(Ee),q(ze),_(Ne)):i=="finance"?(n(H),z(qe),F(Le),E(Me),N(We),q(ct),_(yt)):i=="operation"?(n(Q),z(Ke),F(Fe),E(_e),N(Ge),q(dt),_(ut)):i=="logistic"?(n(J),z(He),F(Ye),E(Ze),N(Je),q(mt),_(pt)):i=="agent"&&(n(G),z(tt),F(Xe),E(et),N(Qe),q(at),_(ft))}),(e,t)=>{const l=je,m=Ie,p=nt;return C(),Ce("div",null,[r(I,{class:"mx-0 my-0"},{default:d(()=>[r(lt,{modelValue:a(R),"onUpdate:modelValue":t[0]||(t[0]=s=>le(R)?R.value=s:null),class:"mx-auto v-tabs-pill"},{default:d(()=>[r(st,{value:"items"},{default:d(()=>[O("Items")]),_:1})]),_:1},8,["modelValue"]),r(ot),r(M,{"prepend-icon":"tabler-upload",color:"success",class:"mr-3",onClick:he,loading:a(ee)},{default:d(()=>[O(W(e.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),r(it,{modelValue:a(R),"onUpdate:modelValue":t[14]||(t[14]=s=>le(R)?R.value=s:null)},{default:d(()=>[r(rt,{value:"items",class:"py-7"},{default:d(()=>[r(ae,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-5"},{default:d(()=>[vt,r(I,{class:y({"flex-column":e.$vuetify.display.xs})},{default:d(()=>[r(ae,{cols:"12",class:"pe-0 v-col-sm-12 v-col-md-10 v-col-lg-10"},{default:d(()=>[r(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[r($,{"prepend-inner-icon":"tabler-building-store",modelValue:a(o).delivery_type,"onUpdate:modelValue":t[1]||(t[1]=s=>a(o).delivery_type=s),items:a(ce),"item-title":"title","return-object":!1,"item-value":"id",placeholder:"Select a Delivery Type",class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","class","style"]),r($,{"prepend-inner-icon":"tabler-package",modelValue:a(o).product,"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).product=s),multiple:"",items:a(w),"item-value":"id","item-title":"name_en","return-object":!1,placeholder:e.$t("Select a Product"),class:y(["mx-2 flex-grow-1 products",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},{"prepend-item":d(()=>[a(A)?se("",!0):(C(),D(M,{key:0,block:"",elevation:"0",text:"",color:"transparent",onClick:ne},{default:d(()=>[O(W(e.$t("Select All")),1)]),_:1})),a(A)?(C(),D(M,{key:1,block:"",elevation:"0",text:"",color:"transparent",onClick:ne},{default:d(()=>[O(W(e.$t("Unselect All")),1)]),_:1})):se("",!0)]),_:1},8,["modelValue","items","placeholder","class","style"]),r($,{"prepend-inner-icon":"tabler-bookmark",multiple:"",modelValue:a(o).category,"onUpdate:modelValue":t[3]||(t[3]=s=>a(o).category=s),items:a(Y),"item-value":"id","item-title":"name_en","return-object":!1,placeholder:e.$t("Select a Category"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),r(l,{placeholder:"Order Number","prepend-inner-icon":"tabler-number",class:"flex-grow-1",modelValue:a(o).orderId,"onUpdate:modelValue":t[4]||(t[4]=s=>a(o).orderId=s),disabled:a(b)},null,8,["modelValue","disabled"])]),_:1}),r(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[r($,{"prepend-inner-icon":"tabler-user",modelValue:a(o).agent,"onUpdate:modelValue":t[5]||(t[5]=s=>a(o).agent=s),disabled:a(b),multiple:"",items:a(j),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select an Agent"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),r($,{"prepend-inner-icon":"tabler-truck-delivery",multiple:"",modelValue:a(o).delivery,"onUpdate:modelValue":t[6]||(t[6]=s=>a(o).delivery=s),disabled:a(b),items:a(V),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select a Delivery"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),(C(),D(m,{modelValue:a(o).from,"onUpdate:modelValue":t[7]||(t[7]=s=>a(o).from=s),placeholder:e.$t("From"),disabled:a(b),key:a(T),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","placeholder","disabled","class","style"])),(C(),D(m,{modelValue:a(o).to,"onUpdate:modelValue":t[8]||(t[8]=s=>a(o).to=s),placeholder:e.$t("To"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":""),disabled:a(b),key:a(T)},null,8,["modelValue","placeholder","class","style","disabled"]))]),_:1}),r(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[r($,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:a(o).branch,"onUpdate:modelValue":t[9]||(t[9]=s=>a(o).branch=s),disabled:a(b),items:a(Z),"item-title":a(f),"return-object":!1,"item-value":"id",placeholder:e.$t("Select a Branch"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","item-title","placeholder","class","style"]),r($,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:a(o).area,"onUpdate:modelValue":t[10]||(t[10]=s=>a(o).area=s),disabled:a(b),items:a(re),"item-title":"name_en","return-object":!1,"item-value":"name_en",placeholder:e.$t("Select an Area"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),r($,{"prepend-inner-icon":"tabler-activity-heartbeat",multiple:"",modelValue:a(o).status,"onUpdate:modelValue":t[11]||(t[11]=s=>a(o).status=s),disabled:a(b),items:a(ye),"item-title":"name","item-value":"value","return-object":!1,placeholder:e.$t("Select a Status"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),r($,{"prepend-inner-icon":"tabler-activity-heartbeat","return-object":!1,multiple:"",modelValue:a(o).payment,"onUpdate:modelValue":t[12]||(t[12]=s=>a(o).payment=s),disabled:a(b),items:a(fe),"item-title":"name","item-value":"value",placeholder:e.$t("Select a Payment Method"),class:y(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"])]),_:1})]),_:1}),r(ae,{cols:"12",class:"mt-2 v-col-sm-12 v-col-md-2 v-col-lg-2"},{default:d(()=>[r(M,{class:"mx-0",block:"",variant:"tonal",color:"warning","prepend-icon":"tabler-x",onClick:$e,disabled:a(v)||!a(S)},{default:d(()=>[O(W(e.$t("Reset")),1)]),_:1},8,["disabled"]),r(M,{class:"mx-0 mt-5",block:"",variant:"tonal",color:"success","prepend-icon":"tabler-search",onClick:t[13]||(t[13]=s=>be(x().filters)),disabled:!a(we).length||a(v)},{default:d(()=>[O(W(e.$t("Search")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"]),r(p,{hasProducts:a(Ve),gettingReports:a(v),meta:a(ie),reports:a(k),filters:x(),onUpdateSortBy:ve,onUpdatePageN:ge},null,8,["hasProducts","gettingReports","meta","reports","filters"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};typeof de=="function"&&de(pe);const va=xe(pe,[["__scopeId","data-v-0846af30"]]);export{va as default};
