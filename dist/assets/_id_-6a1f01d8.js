import{_ as oe}from"./AppTextarea-85522350.js";import{l as d,aP as ne,aV as ie,R as ue,o as f,b as _,w as n,q as o,U as p,W as b,n as T,y as z,s as t,b1 as c,b3 as de,A as w,c as J,F as pe,a as me,z as Z,b4 as ce,G as fe,az as ge,H as ve,b0 as _e,a$ as be,aZ as K,aW as Ve,a_ as xe}from"./index-74fdcc91.js";import{g as ye}from"./categories-7b7b01c9.js";import{s as we,d as ke,u as he}from"./products-d7afc840.js";import{g as $e,a as Ue}from"./extra-flavors-5c4a4e1c.js";import{g as Ie}from"./categories-ca3deb7b.js";import{s as Pe,a as Fe,u as je}from"./products-0a2b26bb.js";import{t as Ce}from"./files-2e167225.js";import{V as O}from"./VCombobox-0d922615.js";import{V as Ne}from"./VFileInput-b6af9ac2.js";import{V as k}from"./VSwitch-606d44e1.js";import"./VSelect-f0d684cd.js";import"./VList-46baac2b.js";import"./ssrBoot-b7abb761.js";import"./VDivider-65a1a2a2.js";import"./dialog-transition-4f838b9f.js";import"./VMenu-9b828eb3.js";import"./VOverlay-81a77b3c.js";import"./lazy-de51d0d2.js";import"./VCheckboxBtn-35e59c47.js";import"./VSelectionControl-742d99c7.js";import"./VChip-e753e051.js";import"./filter-8a14dfb6.js";const Se={class:"text-h4 pt-3 pb-2 px-3"},qe={class:"text-h4 pt-3 pb-2 px-3"},Be={class:"position-relative"},Ee={__name:"[id]",setup(Re){var H;const V=d(!1),u=(H=JSON.parse(localStorage.getItem("userData")))==null?void 0:H.type,g=ne().params.id,x=d([]),m=d([]),h=d([]),L=d([]),M=d([]),y=ie(),W=d(),e=d({code:"",categories:[],created_at:"",description_ar:"",description_en:"",has_image:0,has_note:0,id:"",images:"",in_stock:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",extras:[],flavors:[],extra_quantity:1,is_pre:0}),G=d([]),Q=async l=>{if(l instanceof File){let a=await Ce(l);m.value.push({id:null,url:a}),G.value.push(l)}},X=async()=>{await Q(x.value.pop())},Y=async()=>{u=="admin"?await we(g).then(l=>{let{code:a,created_at:r,description_ar:i,description_en:s,categories:$,has_image:U,has_note:I,id:P,images:F,in_stock:j,is_active:C,name_ar:N,name_en:S,prep_time:q,price:B,extras:E,flavors:R,extra_quantity:A,is_pre:D}=l.data.data;e.value={code:a,created_at:r,description_ar:i,description_en:s,has_image:U,has_note:I,id:P,images:F,in_stock:j,is_active:C,name_ar:N,name_en:S,prep_time:q,price:B,extras:E,flavors:R,extra_quantity:A,is_pre:D},e.value.categories=l.data.data.categories.map(v=>v.id),e.value.extras=l.data.data.extras.map(v=>v.id),e.value.flavors=l.data.data.flavors.map(v=>v.id),m.value=e.value.images}):await Pe(g).then(l=>{let{code:a,created_at:r,categories:i,description_ar:s,description_en:$,has_image:U,has_note:I,id:P,images:F,in_stock:j,is_active:C,name_ar:N,name_en:S,prep_time:q,price:B,extras:E,flavors:R,extra_quantity:A,is_pre:D}=l.data.data;e.value={code:a,categories:i,created_at:r,description_ar:s,description_en:$,has_image:U,has_note:I,id:P,images:F,in_stock:j,is_active:C,name_ar:N,name_en:S,prep_time:q,price:B,extras:E,flavors:R,extra_quantity:A,is_pre:D},m.value=e.value.images})},ee=async l=>{if(re(l.url))try{m.value.splice(m.value.indexOf(l),1);const{data:a}=u=="admin"?await ke({path:l.url.split("/").pop(),product_id:g}):await Fe({path:l.url.split("/").pop(),product_id:g});y.success(a.message)}catch(a){y.error(a.response.data.message)}else m.value.splice(m.value.indexOf(l),1)},ae=async()=>{var l;(l=W.value)==null||l.validate().then(async({valid:a})=>{if(a){V.value=!0;let r=new FormData;r.append("code",e.value.code),r.append("created_at",e.value.created_at),r.append("categories",e.value.categories),r.append("description_ar",e.value.description_ar),r.append("description_en",e.value.description_en),r.append("has_image",e.value.has_image),r.append("has_note",e.value.has_note),r.append("id",e.value.id),r.append("in_stock",e.value.in_stock),r.append("is_active",e.value.is_active),r.append("name_ar",e.value.name_ar),r.append("name_en",e.value.name_en),r.append("prep_time",e.value.prep_time),r.append("price",e.value.price),r.append("is_pre",e.value.is_pre),e.value.extras.concat(e.value.flavors).forEach((i,s)=>{r.append(`extra_flavors[${s}]`,i)}),r.append("quantity",e.value.extra_quantity),G.value.forEach((i,s)=>{r.append(`images[${s}]`,i)});try{u=="admin"?await he(g,r):await je(g,r),y.success("Product updated successfully"),V.value=!1,Ve.back()}catch(i){y.error(i.response.data.message),V.value=!1}}})},te=()=>{u=="admin"?ye().then(({data:l,meta:a})=>{h.value=l.data}):u=="markter"&&Ie().then(({data:l,meta:a})=>{h.value=l.data})},le=()=>{u=="admin"&&$e().then(({data:l,meta:a})=>{M.value=l.data})},se=()=>{u=="admin"&&Ue().then(({data:l,meta:a})=>{L.value=l.data})};function re(l){return/^(ftp|http|https):\/\/[^ "]+$/.test(l)}return ue(()=>{te(),le(),se(),Y()}),(l,a)=>{const r=xe,i=oe;return f(),_(be,{ref_key:"refVForm",ref:W,onSubmit:_e(ae,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[o(p,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[o(b,{cols:"7",style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-7"},{default:n(()=>[T("p",Se,z(l.$t("Update Product")),1),o(b,{class:"px-5"},{default:n(()=>[o(p,{justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-package",class:"flex-grow-1 me-1",rules:[t(c)],modelValue:t(e).name_en,"onUpdate:modelValue":a[0]||(a[0]=s=>t(e).name_en=s),label:"Name"},null,8,["rules","modelValue"]),o(r,{"append-inner-icon":"tabler-package",class:"flex-grow-1 ms-1 text-right",rules:[t(c)],modelValue:t(e).name_ar,"onUpdate:modelValue":a[1]||(a[1]=s=>t(e).name_ar=s),label:"الاسم",dir:"rtl"},null,8,["rules","modelValue"])]),_:1}),o(p,{class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(i,{class:"flex-grow-1 me-1",rules:[t(c)],modelValue:t(e).description_en,"onUpdate:modelValue":a[2]||(a[2]=s=>t(e).description_en=s),label:"Description"},null,8,["rules","modelValue"]),o(i,{class:"flex-grow-1 ms-1 text-right",rules:[t(c)],dir:"rtl",modelValue:t(e).description_ar,"onUpdate:modelValue":a[3]||(a[3]=s=>t(e).description_ar=s),label:"الوصف"},null,8,["rules","modelValue"])]),_:1}),t(u)=="admin"?(f(),_(p,{key:0,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-coins",modelValue:t(e).price,"onUpdate:modelValue":a[4]||(a[4]=s=>t(e).price=s),rules:[t(c),t(de)],class:"flex-grow-1 me-1",label:l.$t("Product Price")},null,8,["modelValue","rules","label"]),o(O,{"prepend-inner-icon":"tabler-bookmark",multiple:"",items:t(h),"item-value":"id","item-title":"name_en","return-object":!1,rules:[t(c)],modelValue:t(e).categories,"onUpdate:modelValue":a[5]||(a[5]=s=>t(e).categories=s),class:"flex-grow-0 ms-1 w-50 mt-6",label:l.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):w("",!0),t(u)=="admin"?(f(),_(p,{key:1,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:t(e).code,"onUpdate:modelValue":a[6]||(a[6]=s=>t(e).code=s),rules:[t(c)],class:"flex-grow-1 me-1",label:l.$t("Product Code")},null,8,["modelValue","rules","label"]),o(r,{"prepend-inner-icon":"tabler-clock",modelValue:t(e).prep_time,"onUpdate:modelValue":a[7]||(a[7]=s=>t(e).prep_time=s),rules:[t(c)],class:"flex-grow-1 ms-1",label:l.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):w("",!0),t(u)=="admin"?(f(),_(p,{key:2,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(O,{"prepend-inner-icon":"tabler-package",multiple:"","return-object":!1,items:t(L),"item-value":"id","item-title":"name",modelValue:t(e).extras,"onUpdate:modelValue":a[8]||(a[8]=s=>t(e).extras=s),class:"flex-grow-1 ms-1 mt-3",label:l.$t("Select Extra")},null,8,["items","modelValue","label"]),o(O,{multiple:"","prepend-inner-icon":"tabler-package","return-object":!1,items:t(M),"item-value":"id","item-title":"name",modelValue:t(e).flavors,"onUpdate:modelValue":a[9]||(a[9]=s=>t(e).flavors=s),class:"flex-grow-1 ms-1 mt-3",label:l.$t("Select Flavor")},null,8,["items","modelValue","label"])]),_:1})):w("",!0)]),_:1})]),_:1}),o(b,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[T("p",qe,z(l.$t("Images")),1),o(p,null,{default:n(()=>[o(b,null,{default:n(()=>[o(p,{class:"px-5"},{default:n(()=>[(f(!0),J(pe,null,me(t(m),s=>(f(),J("div",null,[T("div",Be,[o(Z,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:$=>ee(s)},null,8,["onClick"]),o(ce,{"prepend-icon":"tabler-camera",src:s.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),o(Ne,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:l.$t("Upload image"),modelValue:t(x),"onUpdate:modelValue":a[10]||(a[10]=s=>fe(x)?x.value=s:null),onChange:X},null,8,["label","modelValue"])]),_:1})]),_:1}),t(u)=="admin"?(f(),_(b,{key:0,class:"mt-2"},{default:n(()=>[o(k,{modelValue:t(e).is_active,"onUpdate:modelValue":a[11]||(a[11]=s=>t(e).is_active=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Active")},null,8,["modelValue","label"]),o(k,{modelValue:t(e).has_image,"onUpdate:modelValue":a[12]||(a[12]=s=>t(e).has_image=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Image")},null,8,["modelValue","label"]),o(k,{modelValue:t(e).has_note,"onUpdate:modelValue":a[13]||(a[13]=s=>t(e).has_note=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Note")},null,8,["modelValue","label"]),o(k,{modelValue:t(e).is_pre,"onUpdate:modelValue":a[14]||(a[14]=s=>t(e).is_pre=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Is Pre")},null,8,["modelValue","label"])]),_:1})):w("",!0),o(p,{class:"px-5 mt-2"},{default:n(()=>[o(ge,{color:"primary",loading:t(V),type:"submit",block:""},{default:n(()=>[o(Z,{start:"",icon:"tabler-check"}),ve(z(l.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])}}};typeof K=="function"&&K(Ee);export{Ee as default};
