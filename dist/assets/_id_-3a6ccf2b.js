import{_ as Q}from"./AppTextarea-65db8f1d.js";import{l as c,aP as X,aV as Y,R as ee,o as g,b as w,w as n,q as r,a1 as p,a2 as _,n as S,y as B,s as t,b1 as m,b3 as ae,A as R,c as O,F as te,a as le,z as q,b4 as se,G as oe,az as re,H as ne,b0 as ie,a$ as de,aZ as E,aW as ue,a_ as pe}from"./index-581c2083.js";import{g as me}from"./categories-df5ecb75.js";import{s as ce,b as fe,u as ge}from"./products-c2b322c9.js";import{g as _e}from"./categories-f7a66fa1.js";import{s as be,a as ve,u as Ve}from"./products-a8249be9.js";import{t as we}from"./files-2e167225.js";import{V as ye}from"./VCombobox-6fdf6a72.js";import{V as he}from"./VFileInput-2d78526d.js";import{V as A}from"./VSwitch-084d9c96.js";import"./VSelect-91e75b33.js";import"./VList-800b0139.js";import"./ssrBoot-f2e19377.js";import"./VDivider-007f86e5.js";import"./dialog-transition-e2ab3ff7.js";import"./VMenu-568d971d.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VChip-2cd4c1fb.js";import"./filter-887944dd.js";const ke={class:"text-h4 pt-3 pb-2 px-3"},xe={class:"text-h4 pt-3 pb-2 px-3"},$e={class:"position-relative"},Ue={__name:"[id]",setup(Ie){var z;const b=c(!1),d=(z=JSON.parse(localStorage.getItem("userData")))==null?void 0:z.type,f=X().params.id,v=c([]),u=c([]),y=c([]),V=Y(),D=c(),e=c({code:"",categories:[],created_at:"",description_ar:"",description_en:"",has_image:0,has_note:0,id:"",images:"",in_stock:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:""}),T=c([]),L=async l=>{if(l instanceof File){let a=await we(l);u.value.push({id:null,url:a}),T.value.push(l)}},M=async()=>{await L(v.value.pop())},G=async()=>{d=="admin"?await ce(f).then(l=>{let{code:a,created_at:o,description_ar:i,description_en:s,categories:h,has_image:k,has_note:x,id:$,images:U,in_stock:I,is_active:P,name_ar:C,name_en:F,prep_time:N,price:j}=l.data.data;e.value={code:a,created_at:o,description_ar:i,description_en:s,has_image:k,has_note:x,id:$,images:U,in_stock:I,is_active:P,name_ar:C,name_en:F,prep_time:N,price:j},e.value.categories=l.data.data.categories.map(K=>K.id),u.value=e.value.images}):await be(f).then(l=>{let{code:a,created_at:o,categories:i,description_ar:s,description_en:h,has_image:k,has_note:x,id:$,images:U,in_stock:I,is_active:P,name_ar:C,name_en:F,prep_time:N,price:j}=l.data.data;e.value={code:a,categories:i,created_at:o,description_ar:s,description_en:h,has_image:k,has_note:x,id:$,images:U,in_stock:I,is_active:P,name_ar:C,name_en:F,prep_time:N,price:j},u.value=e.value.images})},H=async l=>{if(Z(l.url))try{u.value.splice(u.value.indexOf(l),1);const{data:a}=d=="admin"?await fe({path:l.url.split("/").pop(),product_id:f}):await ve({path:l.url.split("/").pop(),product_id:f});V.success(a.message)}catch(a){V.error(a.response.data.message)}else u.value.splice(u.value.indexOf(l),1)},J=async()=>{var l;(l=D.value)==null||l.validate().then(async({valid:a})=>{if(a){b.value=!0;let o=new FormData;o.append("code",e.value.code),o.append("created_at",e.value.created_at),o.append("categories",e.value.categories),o.append("description_ar",e.value.description_ar),o.append("description_en",e.value.description_en),o.append("has_image",e.value.has_image),o.append("has_note",e.value.has_note),o.append("id",e.value.id),o.append("in_stock",e.value.in_stock),o.append("is_active",e.value.is_active),o.append("name_ar",e.value.name_ar),o.append("name_en",e.value.name_en),o.append("prep_time",e.value.prep_time),o.append("price",e.value.price),T.value.forEach((i,s)=>{o.append(`images[${s}]`,i)});try{d=="admin"?await ge(f,o):await Ve(f,o),V.success("Product updated successfully"),b.value=!1,ue.back()}catch(i){V.error(i.response.data.message),b.value=!1}}})},W=()=>{d=="admin"?me().then(({data:l,meta:a})=>{y.value=l.data}):d=="markter"&&_e().then(({data:l,meta:a})=>{y.value=l.data})};function Z(l){return/^(ftp|http|https):\/\/[^ "]+$/.test(l)}return ee(()=>{W(),G()}),(l,a)=>{const o=pe,i=Q;return g(),w(de,{ref_key:"refVForm",ref:D,onSubmit:ie(J,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[r(p,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[r(_,{cols:"7",style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-7"},{default:n(()=>[S("p",ke,B(l.$t("Update Product")),1),r(_,{class:"px-5"},{default:n(()=>[r(p,{justify:"space-between",align:"center"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-package",class:"flex-grow-1 me-1",rules:[t(m)],modelValue:t(e).name_en,"onUpdate:modelValue":a[0]||(a[0]=s=>t(e).name_en=s),label:"Name"},null,8,["rules","modelValue"]),r(o,{"append-inner-icon":"tabler-package",class:"flex-grow-1 ms-1 text-right",rules:[t(m)],modelValue:t(e).name_ar,"onUpdate:modelValue":a[1]||(a[1]=s=>t(e).name_ar=s),label:"الاسم",dir:"rtl"},null,8,["rules","modelValue"])]),_:1}),r(p,{class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[r(i,{class:"flex-grow-1 me-1",rules:[t(m)],modelValue:t(e).description_en,"onUpdate:modelValue":a[2]||(a[2]=s=>t(e).description_en=s),label:"Description"},null,8,["rules","modelValue"]),r(i,{class:"flex-grow-1 ms-1 text-right",rules:[t(m)],dir:"rtl",modelValue:t(e).description_ar,"onUpdate:modelValue":a[3]||(a[3]=s=>t(e).description_ar=s),label:"الوصف"},null,8,["rules","modelValue"])]),_:1}),t(d)=="admin"?(g(),w(p,{key:0,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-coins",modelValue:t(e).price,"onUpdate:modelValue":a[4]||(a[4]=s=>t(e).price=s),rules:[t(m),t(ae)],class:"flex-grow-1 mr-1",label:l.$t("Product Price")},null,8,["modelValue","rules","label"]),r(ye,{"prepend-inner-icon":"tabler-bookmark",multiple:"",items:t(y),"item-value":"id","item-title":"name_en","return-object":!1,rules:[t(m)],modelValue:t(e).categories,"onUpdate:modelValue":a[5]||(a[5]=s=>t(e).categories=s),class:"flex-grow-0 ml-1 w-50 mt-6",label:l.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):R("",!0),t(d)=="admin"?(g(),w(p,{key:1,class:"mt-10 pb-10",justify:"space-between",align:"center"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-dna-2",modelValue:t(e).code,"onUpdate:modelValue":a[6]||(a[6]=s=>t(e).code=s),rules:[t(m)],class:"flex-grow-1 mr-1",label:l.$t("Product Code")},null,8,["modelValue","rules","label"]),r(o,{"prepend-inner-icon":"tabler-clock",modelValue:t(e).prep_time,"onUpdate:modelValue":a[7]||(a[7]=s=>t(e).prep_time=s),rules:[t(m)],class:"flex-grow-1 ml-1",label:l.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):R("",!0)]),_:1})]),_:1}),r(_,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[S("p",xe,B(l.$t("Images")),1),r(p,null,{default:n(()=>[r(_,null,{default:n(()=>[r(p,{class:"px-5"},{default:n(()=>[(g(!0),O(te,null,le(t(u),s=>(g(),O("div",null,[S("div",$e,[r(q,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:h=>H(s)},null,8,["onClick"]),r(se,{"prepend-icon":"tabler-camera",src:s.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),r(he,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:l.$t("Upload image"),modelValue:t(v),"onUpdate:modelValue":a[8]||(a[8]=s=>oe(v)?v.value=s:null),onChange:M},null,8,["label","modelValue"])]),_:1})]),_:1}),t(d)=="admin"?(g(),w(_,{key:0,class:"mt-2"},{default:n(()=>[r(A,{modelValue:t(e).is_active,"onUpdate:modelValue":a[9]||(a[9]=s=>t(e).is_active=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Active")},null,8,["modelValue","label"]),r(A,{modelValue:t(e).has_image,"onUpdate:modelValue":a[10]||(a[10]=s=>t(e).has_image=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Image")},null,8,["modelValue","label"]),r(A,{modelValue:t(e).has_note,"onUpdate:modelValue":a[11]||(a[11]=s=>t(e).has_note=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Note")},null,8,["modelValue","label"])]),_:1})):R("",!0),r(p,{class:"px-5 mt-2"},{default:n(()=>[r(re,{color:"primary",loading:t(b),type:"submit",block:""},{default:n(()=>[r(q,{start:"",icon:"tabler-check"}),ne(B(l.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])}}};typeof E=="function"&&E(Ue);export{Ue as default};
