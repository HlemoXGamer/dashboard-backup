import{_ as ra}from"./AppDateTimePicker-ea2a4526.js";import{_ as na}from"./DialogCloseBtn-513e4898.js";import{h as D}from"./stats-e4bb8cc2.js";import{C as ua,p as oa,a as da,b as ma,B as ca,d as va,c as ia,f as pa,g as w}from"./stats-ff37ee98.js";import{h as L,i as j,j as E,k as P}from"./stats-990a9a58.js";import{d as ba,h as z,l as _,D as fa,R as ha,o as T,c as _a,q as o,w as c,I as ya,aX as G,s as d,G as k,az as O,H as x,y,b as R,A as H,a1 as A,a2 as W,n as I,aZ as X,Y as $a}from"./index-581c2083.js";import{V as ga}from"./VDialog-9c77a5f1.js";import{V as Va,a as Y}from"./VTabs-9a55101d.js";import{V as F}from"./VSpacer-78f2ea51.js";import{V as Z,a as ka}from"./VWindowItem-c0d01332.js";import{V as K}from"./VSelect-91e75b33.js";import{V as Q}from"./VDataTable-06e6a8ff.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./dialog-transition-e2ab3ff7.js";import"./ssrBoot-f2e19377.js";import"./VList-800b0139.js";import"./VDivider-007f86e5.js";import"./VMenu-568d971d.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VChip-2cd4c1fb.js";import"./filter-887944dd.js";import"./VTable-db7fafcb.js";ua.register(oa,da,ma,ca,va,ia);const aa=ba({name:"BarChart",props:{chartId:{type:String,default:"bar-chart"},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{default:"",type:String},styles:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},chartOptions:{type:Object,default:()=>({})}},setup($){return()=>z(z(pa),{data:$.chartData,options:$.chartOptions,chartId:$.chartId,width:$.width,height:$.height,cssClasses:$.cssClasses,styles:$.styles,plugins:$.plugins})}}),Ca={class:"text-h4 ps-3 pt-3"},xa={class:"text-h4 mt-12 ps-1"},Ba={class:"text-h4 ps-3 pt-3"},Sa={class:"text-h4 mt-12 ps-1"},Ta={__name:"index",setup($){var q;const m=(q=JSON.parse(localStorage.getItem("userData")))==null?void 0:q.type,B=JSON.parse(localStorage.getItem("userData")),r=_(0),p=_("today"),i=_(!1),N=_({export:!1}),v=_(0),f=_(0),C=_(!1),g=_(null),V=_(null),a=_({area:[],branch:[]}),h=fa().t,J=[{title:h("Custom"),value:"custom"},{title:h("This Month"),value:"month"},{title:h("This Week"),value:"week"},{title:h("Today"),value:"today"}],s={labels:[],datasets:[{label:h("Orders"),maxBarThickness:30,backgroundColor:"#ffcf5c",borderColor:"transparent",borderRadius:{topRight:5,topLeft:5},data:[]},{label:h("Sales"),maxBarThickness:30,backgroundColor:"#4169e1",borderColor:"transparent",borderRadius:{topRight:5,topLeft:5},data:[]}]},n={labels:[],datasets:[{label:h("Orders"),maxBarThickness:30,backgroundColor:"#ffcf5c",borderColor:"transparent",borderRadius:{topRight:5,topLeft:5},data:[]},{label:h("Sales"),maxBarThickness:30,backgroundColor:"#4169e1",borderColor:"transparent",borderRadius:{topRight:5,topLeft:5},data:[]}]},ea=[{title:h("Branch"),key:"name.en",sortable:!1},{title:h("Sales Amount"),key:"orders_amount"},{title:h("Number of Orders"),key:"orders_count"}],la=[{title:h("Area"),key:"name.en",sortable:!1},{title:h("Sales Amount"),key:"orders_amount"},{title:h("Number of Orders"),key:"orders_count"}],U=u=>{if(i.value=!0,u===!0){C.value=!1;let e=g.value,t=V.value;m=="admin"?D(`${r.value}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="restaurant"?w(`${r.value}&branch=${B.branch_id}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="operation"?L(`${r.value}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="logistic"?j(`${r.value}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="finance"?E(`${r.value}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="agent"&&P(`${r.value}${e!==null?"&from="+e:""}${t!==null?"&to="+t:""}`).then(({data:b})=>{a.value[r.value]=b,r.value=="area"?(n.labels=a.value.area.map(l=>l.name.en),n.datasets[0].data=a.value.area.map(l=>l.orders_count),n.datasets[1].data=a.value.area.map(l=>l.orders_amount)):(s.labels=a.value.branch.map(l=>l.name.en),s.datasets[0].data=a.value.branch.map(l=>l.orders_count),s.datasets[1].data=a.value.branch.map(l=>l.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1})}else m=="admin"?D(`${r.value}&${p.value}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="restaurant"?w(`${r.value}&${p.value}&branch=${B.branch_id}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="operation"?L(`${r.value}&${p.value}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="logistic"?j(`${r.value}&${p.value}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="finance"?E(`${r.value}&${p.value}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1}):m=="agent"&&P(`${r.value}&${p.value}`).then(({data:e})=>{a.value[r.value]=e,r.value=="area"?(n.labels=a.value.area.map(t=>t.name.en),n.datasets[0].data=a.value.area.map(t=>t.orders_count),n.datasets[1].data=a.value.area.map(t=>t.orders_amount)):(s.labels=a.value.branch.map(t=>t.name.en),s.datasets[0].data=a.value.branch.map(t=>t.orders_count),s.datasets[1].data=a.value.branch.map(t=>t.orders_amount))}).finally(()=>{i.value=!1,v.value+=1,f.value+=1})},ta=()=>{C.value=!1,p.value="today",g.value=_(null),V.value=_(null),U(!0)},M=()=>{setTimeout(()=>{p.value=="custom"?C.value=!0:U(!1)},100)},sa=async()=>{let u=g.value,e=V.value;N.value.export=!0;try{await $a.get(`${m!=="admin"?m=="restaurant"?"restaurant-apis":m:""}/stats/branchArea?type=${r.value}&${p.value}${u!==null?"&from="+u:""}${e!==null?"&to="+e:""}&export${m=="restaurant"?"&branch="+B.branch_id:""}`,{responseType:"arraybuffer"}).then(t=>{const b=new Blob([t.data],{type:"application/vnd.ms-excel"}),l=window.URL.createObjectURL(b),S=document.createElement("a");S.href=l,S.setAttribute("download",`${r.value}-report-${p.value}.xlsx`),document.body.appendChild(S),S.click(),document.body.removeChild(S)})}catch(t){console.log(t)}finally{N.value.export=!1}};return ha(()=>{m=="restaurant"?(w(`branch&today&branch=${B.branch_id}`).then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1}),w(`area&today&branch=${B.branch_id}`).then(({data:u})=>{a.value.area=u,n.labels=a.value.area.map(e=>e.name.en),n.datasets[0].data=a.value.area.map(e=>e.orders_count),n.datasets[1].data=a.value.area.map(e=>e.orders_amount)}).finally(()=>{f.value+=1})):m=="admin"?(D("branch&today").then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1}),D("area&today").then(({data:u})=>{a.value.area=u,n.labels=a.value.area.map(e=>e.name.en),n.datasets[0].data=a.value.area.map(e=>e.orders_count),n.datasets[1].data=a.value.area.map(e=>e.orders_amount)}).finally(()=>{f.value+=1})):m=="operation"?L("branch&today").then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1}):m=="logistic"?j("branch&today").then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1}):m=="finance"?E("branch&today").then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1}):m=="agent"&&P("branch&today").then(({data:u})=>{a.value.branch=u,s.labels=a.value.branch.map(e=>e.name.en),s.datasets[0].data=a.value.branch.map(e=>e.orders_count),s.datasets[1].data=a.value.branch.map(e=>e.orders_amount)}).finally(()=>{v.value+=1})}),(u,e)=>{const t=na,b=ra;return T(),_a("div",null,[o(ga,{modelValue:d(C),"onUpdate:modelValue":e[4]||(e[4]=l=>k(C)?C.value=l:null),persistent:"",class:"v-dialog-sm"},{default:c(()=>[o(t,{onClick:e[0]||(e[0]=l=>ta())}),o(ya,{title:u.$t("Pick a custom Date")},{default:c(()=>[o(G,{class:"d-flex"},{default:c(()=>[o(b,{class:"me-1",placeholder:u.$t("From"),"prepend-inner-icon":"tabler-calendar",modelValue:d(g),"onUpdate:modelValue":e[1]||(e[1]=l=>k(g)?g.value=l:null)},null,8,["placeholder","modelValue"]),o(b,{class:"ms-1",placeholder:u.$t("To"),"prepend-inner-icon":"tabler-calendar",modelValue:d(V),"onUpdate:modelValue":e[2]||(e[2]=l=>k(V)?V.value=l:null)},null,8,["placeholder","modelValue"])]),_:1}),o(G,{class:"d-flex justify-end gap-3 flex-wrap"},{default:c(()=>[o(O,{onClick:e[3]||(e[3]=l=>U(!0)),loading:d(i),disabled:!d(g)&&!d(V)},{default:c(()=>[x(y(u.$t("Pick")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),o(A,{class:"mx-0 my-0"},{default:c(()=>[o(Va,{modelValue:d(r),"onUpdate:modelValue":e[5]||(e[5]=l=>k(r)?r.value=l:null),class:"mx-auto v-tabs-pill"},{default:c(()=>[o(Y,{value:"branch"},{default:c(()=>[x(y(u.$t("Top Branches")),1)]),_:1}),d(m)!=="finance"&&d(m)!=="operation"&&d(m)!=="logistic"?(T(),R(Y,{key:0,value:"area"},{default:c(()=>[x(y(u.$t("Top Areas")),1)]),_:1})):H("",!0)]),_:1},8,["modelValue"]),o(F),o(O,{"prepend-icon":"tabler-upload",color:"success",class:"mr-3",onClick:sa,loading:d(N).export},{default:c(()=>[x(y(u.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),o(ka,{modelValue:d(r),"onUpdate:modelValue":e[10]||(e[10]=l=>k(r)?r.value=l:null)},{default:c(()=>[o(Z,{value:"branch",class:"py-7"},{default:c(()=>[o(W,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-10"},{default:c(()=>[I("p",Ca,y(u.$t("Branches Sales/Orders")),1),o(A,{class:"mx-0 py-0 px-4 py-5 mt-1"},{default:c(()=>[o(K,{items:J,"item-value":"value",disabled:d(i),"item-title":"title",modelValue:d(p),"onUpdate:modelValue":e[6]||(e[6]=l=>k(p)?p.value=l:null),label:u.$t("Select a period of time"),"prepend-inner-icon":"tabler-clock"},null,8,["disabled","modelValue","label"]),o(O,{class:"ms-2",onClick:e[7]||(e[7]=l=>M()),loading:d(i)},{default:c(()=>[x(y(u.$t("Search")),1)]),_:1},8,["loading"]),o(F)]),_:1}),o(A,{class:"mx-0 my-0 px-4 mt-5"},{default:c(()=>[(T(),R(d(aa),{height:200,"chart-data":s,key:d(v)})),I("p",xa,y(u.$t("Top Branches")),1),o(d(Q),{headers:ea,items:d(a).branch,class:"mt-1"},null,8,["items"])]),_:1})]),_:1})]),_:1}),d(m)!=="finance"&&d(m)!=="operation"&&d(m)!=="logistic"?(T(),R(Z,{key:0,value:"area",class:"py-7"},{default:c(()=>[o(W,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-10"},{default:c(()=>[I("p",Ba,y(u.$t("Areas Sales/Orders")),1),o(A,{class:"mx-0 py-0 px-4 py-5 mt-1"},{default:c(()=>[o(K,{items:J,"item-value":"value",disabled:d(i),"item-title":"title",modelValue:d(p),"onUpdate:modelValue":e[8]||(e[8]=l=>k(p)?p.value=l:null),label:u.$t("Select a period of time"),"prepend-inner-icon":"tabler-clock"},null,8,["disabled","modelValue","label"]),o(O,{class:"ms-2",onClick:e[9]||(e[9]=l=>M()),loading:d(i)},{default:c(()=>[x(y(u.$t("Search")),1)]),_:1},8,["loading"]),o(F)]),_:1}),o(A,{class:"mx-0 my-0 px-4 mt-5"},{default:c(()=>[o(W,{class:"mx-0 my-0 py-0 px-0"},{default:c(()=>[(T(),R(d(aa),{height:200,"chart-data":n,key:d(f)})),I("p",Sa,y(u.$t("Top Areas")),1),o(d(Q),{headers:la,items:d(a).area,class:"mt-1"},null,8,["items"])]),_:1})]),_:1})]),_:1})]),_:1})):H("",!0)]),_:1},8,["modelValue"])])}}};typeof X=="function"&&X(Ta);export{Ta as default};
