import{_ as E}from"./DialogCloseBtn-338c2407.js";import{u as G,a as H,r as W,b as X,g as Z,c as K}from"./vouchers-3ba1f946.js";import{D as U,l as p,aV as P,O as Q,r as ee,o as D,c as ae,q as e,w as a,s as r,I,aX as x,H as d,az as h,G as N,t as F,y as T,n as j,z as g,b as A,A as J,F as te,R as le,W as se,U as z,aY as oe,aZ as L,a_ as ne}from"./index-ad06e79a.js";import{V as R}from"./VDialog-fbd7f1ae.js";import{V as re}from"./VDataTable-c727e2d1.js";import{V as ie}from"./VChip-5e82d9df.js";import"./VOverlay-907c7a82.js";import"./lazy-4cfe01f9.js";import"./dialog-transition-9757e826.js";import"./VCheckboxBtn-f6dd6c6f.js";import"./VSelectionControl-694a1f9e.js";import"./VSelect-76fdbbde.js";import"./VList-9ab7df99.js";import"./ssrBoot-defe399c.js";import"./VDivider-4cc22aef.js";import"./VMenu-0f9b48c2.js";import"./filter-1b8aa21b.js";import"./VTable-31714374.js";const ue={class:"d-flex gap-1"},ce={__name:"VouchersTable",props:{search:{type:String,default:""},vouchers:{type:Array,default:()=>[]},searhc:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(k){var O;const v=k,u=U().t,f=(O=JSON.parse(localStorage.getItem("userData")))==null?void 0:O.type,s=p([]),c=p(!1),m=P(),o=p(!1),i=p(!1),S=Q(()=>[{title:u("Voucher Code"),key:"v_code"},{title:u("Name"),sortable:!1,key:"v_name"},{title:u("Limit"),key:"v_limit"},{title:u("Min. Total"),key:"v_min_total"},{title:u("Amount"),key:"v_amount"},{title:u("Type"),sortable:!1,key:"v_type_name"},{title:u("Usage"),key:"v_usage"},{title:u("Status"),align:"center",key:"v_is_active"},{title:u("Actions"),key:"actions",sortable:!1,align:"center"}]),y=n=>{if(parseInt(n)!==0)return{color:"success",text:"Active"};if(parseInt(n)===0)return{color:"secondary",text:"Disabled"}},$=(n,t,V,_)=>V.raw.v_name.toLowerCase().includes(t.toLowerCase())?V.raw.v_name.toLowerCase().includes(t.toLowerCase()):!1;let w={};const B=n=>{w=n,s.value=JSON.stringify(n),s.value=JSON.parse(s.value),o.value=!0},M=async()=>{c.value=!0;let n=0;try{s.value.v_is_active===1?s.value.v_is_active=0:(s.value.v_is_active=1,n=1),f==="admin"?await G(s.value.v_id,s.value):await H(s.value.v_id,s.value),w.v_is_active=n,m.success("Voucher updated successfully"),c.value=!1,o.value=!1}catch(t){m.error(t.response.data.message)}},Y=n=>{w=n,s.value=JSON.stringify(n),s.value=JSON.parse(s.value),i.value=!0},q=async()=>{c.value=!0;try{f==="admin"?await W(s.value.v_id):await X(s.value.v_id),v.vouchers.splice(v.vouchers.indexOf(w),1),m.success("Voucher deleted successfully"),c.value=!1,i.value=!1}catch(n){m.error(n.response.data.message)}};return(n,t)=>{const V=E,_=ee("IconBtn");return D(),ae(te,null,[e(R,{modelValue:r(o),"onUpdate:modelValue":t[3]||(t[3]=l=>N(o)?o.value=l:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(V,{onClick:t[0]||(t[0]=l=>o.value=!r(o))}),e(I,{title:"Toggle Voucher"},{default:a(()=>[e(x,null,{default:a(()=>[d(" Are you sure that you want to turn on/off this Voucher? ")]),_:1}),e(x,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(h,{color:"secondary",variant:"tonal",onClick:t[1]||(t[1]=l=>o.value=!1),disabled:r(c)},{default:a(()=>[d(" Cancel ")]),_:1},8,["disabled"]),e(h,{onClick:t[2]||(t[2]=l=>M()),loading:r(c)},{default:a(()=>[d(" Yes ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(R,{modelValue:r(i),"onUpdate:modelValue":t[7]||(t[7]=l=>N(i)?i.value=l:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(V,{onClick:t[4]||(t[4]=l=>i.value=!r(i))}),e(I,{title:"Delete Voucher"},{default:a(()=>[e(x,null,{default:a(()=>[d(" Are you sure that you want to delete this Voucher? ")]),_:1}),e(x,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(h,{color:"secondary",variant:"tonal",onClick:t[5]||(t[5]=l=>i.value=!1),disabled:r(c)},{default:a(()=>[d(" Cancel ")]),_:1},8,["disabled"]),e(h,{onClick:t[6]||(t[6]=l=>q()),loading:r(c)},{default:a(()=>[d(" Delete ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{elevation:"0",rounded:"0",class:"px-0 mb-0 pb-5 mt-10 pt-2",loading:k.loading},{default:a(()=>[e(r(re),{search:k.search,items:v.vouchers,headers:r(S),"items-per-page":15,"custom-filter":$},{"item.v_is_active":a(({item:l})=>[e(ie,{color:y(l.value.v_is_active).color,class:F([`text-${y(l.value.v_is_active).color}`,"font-weight-medium"]),size:"small"},{default:a(()=>[d(T(y(l.value.v_is_active).text),1)]),_:2},1032,["color","class"])]),"item.actions":a(({item:l})=>[j("div",ue,[e(_,{onClick:b=>n.$router.push(`vouchers/view/${l.raw.v_id}`)},{default:a(()=>[e(g,{icon:"mdi-eye"})]),_:2},1032,["onClick"]),e(_,{onClick:b=>n.$router.push(`vouchers/edit/${l.raw.v_id}`)},{default:a(()=>[e(g,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),e(_,{onClick:b=>Y(l.value)},{default:a(()=>[e(g,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"]),l.value.v_is_active===1?(D(),A(_,{key:0,onClick:b=>B(l.value)},{default:a(()=>[e(g,{icon:"mdi-ban"})]),_:2},1032,["onClick"])):J("",!0),l.value.v_is_active===0?(D(),A(_,{key:1,onClick:b=>B(l.value)},{default:a(()=>[e(g,{icon:"mdi-play"})]),_:2},1032,["onClick"])):J("",!0)])]),_:1},8,["search","items","headers"])]),_:1},8,["loading"])],64)}}},de={class:"text-h4 pt-3 pb-2 px-3"},ve={__name:"index",setup(k){var m;const v=U().t,C=p([]),u=p(""),f=p(!1),s=(m=JSON.parse(localStorage.getItem("userData")))==null?void 0:m.type,c=async()=>{f.value=!0,s=="admin"?await Z().then(({data:o,meta:i})=>{C.value=o.data}):s=="markter"&&await K().then(({data:o,meta:i})=>{C.value=o.data}),f.value=!1};return le(()=>{c()}),(o,i)=>{const S=ne,y=ce;return D(),A(z,{class:"mt-4 px-4"},{default:a(()=>[e(se,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded"},{default:a(()=>[j("p",de,T(r(v)("Vouchers")),1),e(z,{class:"ps-lg-1 pe-lg-5 ps-md-1 pe-md-5 ps-sm-1 pe-sm-5 mx-0 w-100",align:"center",justify:"space-between"},{default:a(()=>[e(S,{"prepend-inner-icon":"tabler-search",modelValue:r(u),"onUpdate:modelValue":i[0]||(i[0]=$=>N(u)?u.value=$:null),placeholder:r(v)("Search for a Voucher"),class:F(["mx-lg-2",o.$vuetify.display.xs?"w-100":""]),style:oe(o.$vuetify.display.xs?"width: 100%;":"width: 300px;")},null,8,["modelValue","placeholder","class","style"]),e(h,{block:o.$vuetify.display.xs,class:"mt-lg-0 mt-md-0 mt-sm-0 mt-3",onClick:i[1]||(i[1]=$=>o.$router.push("vouchers/add/"))},{default:a(()=>[e(g,{start:"",icon:"tabler-plus"}),d(T(r(v)("Add Voucher")),1)]),_:1},8,["block"])]),_:1}),e(y,{loading:r(f),vouchers:r(C),search:r(u)},null,8,["loading","vouchers","search"])]),_:1})]),_:1})}}};typeof L=="function"&&L(ve);export{ve as default};
