import{D as te,O as D,l as f,R as ae,o as Q,b as H,w as n,q as o,s as l,G as J,t as h,H as j,y as w,n as ee,U as T,A as de,I as ue,C as we,c as $e,az as X,W as G,aY as P,aZ as re,a6 as xe}from"./index-0bb0cc22.js";import{V as pe}from"./VDataTable-572aad38.js";import{V as ke}from"./VChip-e155d780.js";import{V as me}from"./VPagination-35db419a.js";import{_ as Ve}from"./AppDateTimePicker-3f8e0ddf.js";import{a as _e}from"./branches-b77eb682.js";import{g as Pe}from"./deliveries-e6384edf.js";import{g as Re}from"./areas-cc050dd0.js";import{g as Ce}from"./agents-9773aee8.js";import{a as F}from"./stats-c0f95063.js";import{g as je,a as Oe}from"./deliveries-383d0e4b.js";import{g as Be,a as Se,b as Ue,c as De,d as Te,e as Ie,f as Ae,h as Ee,i as ze}from"./agents-7d896e0e.js";import{g as L,d as q,e as M,f as W}from"./stats-0652b553.js";import{g as Ne}from"./branches-3140bb79.js";import{g as Fe}from"./deliveries-954e4419.js";import{g as Le}from"./branches-9eea947f.js";import{g as qe}from"./deliveries-0cdfdd98.js";import{g as Me}from"./areas-802724d0.js";import{V as We,a as ie}from"./VTabs-0423bf7d.js";import{V as Qe}from"./VSpacer-46486279.js";import{V as ne,a as Ge}from"./VWindowItem-5fc61fd0.js";import{V as U}from"./VCombobox-548e6126.js";import"./VCheckboxBtn-7ff81017.js";import"./VSelectionControl-aba741ed.js";import"./VSelect-6fcb57fa.js";import"./VList-960630c2.js";import"./ssrBoot-e4838fc0.js";import"./VDivider-ea64b2d6.js";import"./dialog-transition-71d07923.js";import"./VMenu-eab6c9ac.js";import"./VOverlay-61faf366.js";import"./lazy-765d4dbc.js";import"./filter-654261dc.js";import"./VTable-8db878f5.js";const He={__name:"LayoutsReportsTable",props:{filters:{type:Object,default:{}},reports:{type:Array,default:[]},meta:{type:Object,default:{}},gettingReports:{type:Boolean,default:!1},hasProducts:{type:Boolean,default:!1}},setup(x,{emit:$}){const u=x,a=te().t,O=D(()=>u.hasProducts===!1?[{title:a("Order ID"),key:"id",width:"200px"},{title:a("Branch"),sortable:!1,key:"branch",width:"200px"},{title:a("Product"),sortable:!1,key:"first_product",width:"200px"},{title:a("Total Amount"),sortable:!1,key:"total_amount",width:"200px"},{title:a("Status"),sortable:!1,key:"status",width:"200px"},{title:a("Delivery Name"),sortable:!1,key:"delivery_name",width:"200px"},{title:a("Agent"),sortable:!1,key:"agent_name",width:"200px"},{title:a("Area"),sortable:!1,key:"area",width:"200px"},{title:a("Paid Date"),sortable:!1,key:"paid_at",width:"200px"},{title:a("In Progress"),sortable:!1,key:"in_progress",width:"200px"},{title:a("Ready For Delivery"),sortable:!1,key:"ready_for_delivery",width:"200px"},{title:a("On The Way"),sortable:!1,key:"on_the_way",width:"200px"},{title:a("Estimated Time"),sortable:!1,key:"est_time",width:"200px"},{title:a("Delivered"),sortable:!1,key:"delivered_at",width:"200px"},{title:a("Payment Method"),sortable:!1,key:"payment_method",width:"200px"},{title:a("Customer Name"),sortable:!1,key:"customer_name",width:"200px"},{title:a("Phone Number"),sortable:!1,key:"customer_phone",width:"200px"},{title:a("Customer Email"),sortable:!1,key:"customer_email",width:"200px"},{title:a("User Type"),key:"user_type",align:"center",sortable:!1},{title:a("Order Type"),key:"order_type",align:"center",sortable:!1}]:[{title:a("Order ID"),key:"id",width:"200px"},{title:a("Branch"),sortable:!1,key:"branch",width:"200px"},{title:a("Area"),sortable:!1,key:"area",width:"200px"},{title:a("Product"),sortable:!1,key:"first_product",width:"200px"},{title:a("Price"),sortable:!1,key:"price",width:"200px"},{title:a("Quantity"),sortable:!1,key:"quantity",width:"200px"},{title:a("Total Amount"),sortable:!1,key:"total_amount",width:"200px"}]),v=c=>{if(c=="created")return{color:"warning",text:a("Created")};if(c=="ready_for_delivery")return{color:"#2FE9D0",text:a("Ready For Delivery")};if(c=="in_progress")return{color:"#E9982F",text:a("In Progress")};if(c=="cancelled")return{color:"danger",text:a("Cancelled")};if(c=="on_the_way")return{color:"grey lighten-3 black--text",text:a("On The Way")};if(c=="paid")return{color:"success",text:a("Paid")};if(c=="delivered")return{color:"blue-lighten-1",text:a("Delivered")}},k=f(),R=()=>{$("update-sort-by",k.value)},C=c=>{$("update-page-n",c)};return ae(()=>{}),(c,b)=>(Q(),H(ue,{elevation:"0",class:"px-0 mb-0 pb-0 mt-5 pt-3",loading:x.gettingReports},{default:n(()=>[o(l(pe),{"sort-by":l(k),"onUpdate:sortBy":[b[1]||(b[1]=p=>J(k)?k.value=p:null),R],items:x.reports,headers:l(O),"items-per-page":15},{"item.status":n(({item:p})=>[o(ke,{color:v(p.raw.status).color,class:h([`text-${v(p.raw.status).color}`,"font-weight-medium"]),size:"small"},{default:n(()=>[j(w(v(p.raw.status).text),1)]),_:2},1032,["color","class"])]),"item.user_type":n(({item:p})=>[j(w(String(p.raw.user_type).replace(/^\w/,V=>V.toUpperCase()))+" ",1),ee("small",null,w(p.raw.creator),1)]),bottom:n(()=>[o(T,{class:"mt-3 mb-0 pb-0 mx-0",align:"center",justify:"end"},{default:n(()=>[u.meta.total?(Q(),H(me,{key:0,"total-visible":"5",modelValue:u.meta.current_page,"onUpdate:modelValue":[b[0]||(b[0]=p=>u.meta.current_page=p),C],length:Math.ceil(u.meta.total/u.meta.per_page),disabled:u.gettingReports,size:35},null,8,["modelValue","length","disabled"])):de("",!0)]),_:1})]),_:1},8,["sort-by","items","headers"])]),_:1},8,["loading"]))}},Je={__name:"CustomizedReportsTable",props:{filters:{type:Object,default:{}},reports:{type:Array,default:[]},meta:{type:Object,default:{}},gettingReports:{type:Boolean,default:!1},hasProducts:{type:Boolean,default:!1}},setup(x,{emit:$}){const u=x,a=te().t,O=D(()=>u.hasProducts===!1?[{title:a("Order ID"),key:"id"},{title:a("Date"),sortable:!1,key:"date"},{title:a("Time"),sortable:!1,key:"time"},{title:a("Branch"),sortable:!1,key:"branch"},{title:a("Product"),sortable:!1,key:"first_product"}]:[{title:a("Order ID"),key:"id",width:"200px"},{title:a("Branch"),sortable:!1,key:"branch",width:"200px"},{title:a("Area"),sortable:!1,key:"area",width:"200px"},{title:a("Product"),sortable:!1,key:"first_product",width:"200px"},{title:a("Price"),sortable:!1,key:"price",width:"200px"},{title:a("Quantity"),sortable:!1,key:"quantity",width:"200px"},{title:a("Total Amount"),sortable:!1,key:"total_amount",width:"200px"},{title:a("Delivery Date"),sortable:!1,key:"delivery_date",width:"200px"},{title:a("Created By"),sortable:!1,key:"created_by",width:"200px"}]),v=f(),k=()=>{$("update-sort-by",v.value)},R=C=>{$("update-page-n",C)};return ae(()=>{}),(C,c)=>(Q(),H(ue,{elevation:"0",class:"px-0 mb-0 pb-0 mt-5 pt-3",loading:x.gettingReports},{default:n(()=>[o(l(pe),{"sort-by":l(v),"onUpdate:sortBy":[c[1]||(c[1]=b=>J(v)?v.value=b:null),k],items:x.reports,headers:l(O),"items-per-page":15},{bottom:n(()=>[o(T,{class:"mt-3 mb-0 pb-0 mx-0",align:"center",justify:"end"},{default:n(()=>[u.meta.total?(Q(),H(me,{key:0,"total-visible":"5",modelValue:u.meta.current_page,"onUpdate:modelValue":[c[0]||(c[0]=b=>u.meta.current_page=b),R],length:Math.ceil(u.meta.total/u.meta.per_page),disabled:u.gettingReports,size:35},null,8,["modelValue","length","disabled"])):de("",!0)]),_:1})]),_:1},8,["sort-by","items","headers"])]),_:1},8,["loading"]))}};const Ke={class:"text-h4 pt-3 pb-0 mb-3 px-3"},Ye={class:"text-h4 pt-3 pb-0 mb-3 px-3"},ce={__name:"index",setup(x){const $=te(),u=$.t,r=JSON.parse(localStorage.getItem("userData")).type,a=D(()=>{if($.locale.value==="en")return"name_en";if($.locale.value==="ar")return"name_ar"}),O=f([]);f([]);const v=f([]),k=f([]),R=f([]),C=f([]),c=f([]),b=f(),p=f(!1),V=f(!1),K=f(!1),B=f("reports"),m=f({branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[],orderId:""}),Y=D(()=>m.value.product.length==k.value.length),fe=f([{name:u("Created"),value:"created"},{name:u("Paid"),value:"paid"},{name:u("In Progress"),value:"in_progress"},{name:u("Ready For Delivery"),value:"ready_for_delivery"},{name:u("On The Way"),value:"on_the_way"},{name:u("Delivered"),value:"delivered"},{name:u("Cancelled"),value:"cancelled"}]),ye=f([{name:"Knet",value:"knet"},{name:"Bookey",value:"bookey"},{name:"Credit Card",value:"credit_card"}]),S=f(),le=e=>{if(p.value=!0,V.value===!0){const t=new FormData,s=_().filters;Object.keys(s).includes("status")&&(Object.keys(s).includes("from")||Object.keys(s).includes("to"))&&(s.status.forEach(g=>{let i=Z(g);s.from&&t.append(`${i}From`,s.from),s.to&&t.append(`${i}To`,s.to)}),s==null||delete s.status,s==null||delete s.from,s==null||delete s.to),Y.value==!0&&(delete s.product,t.append("allProducts","")),Object.entries(s).forEach(([g,i])=>{t.append(g,i)}),t.append("page",e),t.append("limit",15);const y=new URLSearchParams(t).toString();p.value=!0,V.value=!0,r=="admin"?d(F,y):r=="agent"?d(L,y):r=="finance"?d(q,y):r=="logistic"?d(M,y):r=="operation"&&d(W,y)}else{const t=new URLSearchParams({page:e,limit:15,sortBy:S.value??""}).toString();r=="admin"?d(F,t):r=="agent"?d(L,t):r=="finance"?d(q,t):r=="logistic"?d(M,t):r=="operation"&&d(W,t)}},se=e=>{S.value=e},I=e=>{e().then(({data:t})=>{O.value=t.data})},A=e=>{e().then(({data:t})=>{c.value=t.data})},E=e=>{e().then(({data:t})=>{C.value=t.data})},d=(e,t="")=>{p.value=!0,e(t).then(({data:s})=>{b.value=s.meta,R.value=s.data}).finally(()=>{p.value=!1})},z=e=>{e().then(({data:t})=>{v.value=t.data})},_=()=>{let e={};return Object.entries(m.value).forEach(([t,s])=>{s!==null&&s.length&&(e[t]=s)}),{filters:e}},Z=e=>e.replace(/_([a-z])/g,function(t,s){return s.toUpperCase()}),ge=e=>{const t=new FormData;t.append("page",1),t.append("limit",15),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(y=>{let g=Z(y);e.from&&t.append(`${g}From`,e.from),e.to&&t.append(`${g}To`,e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),Y.value==!0&&(delete e.product,t.append("allProducts","")),Object.entries(e).forEach(([y,g])=>{t.append(y,g)});const s=new URLSearchParams(t).toString();p.value=!0,V.value=!0,r=="admin"?d(F,s):r=="agent"?d(L,s):r=="finance"?d(q,s):r=="logistic"?d(M,s):r=="operation"&&d(W,s)},be=()=>{V.value=!1,m.value={branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[]},r=="admin"?d(F):r=="agent"?d(L):r=="finance"?d(q):r=="logistic"?d(M):r=="operation"&&d(W)},ve=()=>{let e={};S.value!==void 0&&S.value.length>0&&(e["sortBy[]"]=`${S.value[0].order}-${S.value[0].key}`);const t=_().filters;Object.entries(t).forEach(([y,g])=>{e[y]=g}),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(y=>{let g=Z(y);e.from&&(e[`${g}From`]=e.from),e.to&&(e[`${g}To`]=e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),Y.value==!0&&(delete e.product,e.allProducts=""),K.value=!0;const s=new URLSearchParams(e).toString();xe.get(`${r!=="admin"?`/${r}`:""}/stats/custom?export${s.length?"&"+s:s}`,{responseType:"arraybuffer"}).then(y=>{const g=new Blob([y.data],{type:"application/vnd.ms-excel"}),i=window.URL.createObjectURL(g),N=document.createElement("a");N.href=i,N.setAttribute("download","custom-report.xlsx"),document.body.appendChild(N),N.click(),document.body.removeChild(N)}).finally(()=>{K.value=!1})},he=D(()=>Object.keys(_().filters)),oe=D(()=>(Object.keys(_().filters).includes("product")||Object.keys(_().filters).includes("category"))&&V.value===!0&&p.value===!1);return ae(()=>{r=="admin"?(d(F),A(Re),z(_e),I(Pe),E(Ce)):r=="finance"?(d(q),A(Be),z(Se),I(Ue),E(De)):r=="operation"?(d(W),A(Te),z(je),I(Oe),E(Ie)):r=="logistic"?(d(M),A(Ae),z(Ne),I(Fe),E(Ee)):r=="agent"&&(d(L),A(Me),z(Le),I(qe),E(ze))}),(e,t)=>{const s=Ve,y=Je,g=He;return Q(),$e("div",null,[o(T,{class:"mx-0 my-0"},{default:n(()=>[o(We,{modelValue:l(B),"onUpdate:modelValue":t[0]||(t[0]=i=>J(B)?B.value=i:null),class:"mx-auto v-tabs-pill"},{default:n(()=>[o(ie,{value:"customized"},{default:n(()=>[j(w(e.$t("cutomized")),1)]),_:1}),o(ie,{value:"layouts"},{default:n(()=>[j(w(e.$t("layouts")),1)]),_:1})]),_:1},8,["modelValue"]),o(Qe),o(X,{"prepend-icon":"tabler-upload",color:"success",class:"mr-3",onClick:ve,loading:l(K)},{default:n(()=>[j(w(e.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),o(Ge,{modelValue:l(B),"onUpdate:modelValue":t[10]||(t[10]=i=>J(B)?B.value=i:null)},{default:n(()=>[o(ne,{value:"customized",class:"py-7"},{default:n(()=>[o(G,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-5"},{default:n(()=>[ee("p",Ke,w(e.$t("Customized Reports")),1),o(T,{class:h({"flex-column":e.$vuetify.display.xs})},{default:n(()=>[o(G,{cols:"12",class:"pe-0 v-col-sm-12 v-col-md-10 v-col-lg-10"},{default:n(()=>[o(T,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-0 pe-0",align:"center",justify:"space-between"},{default:n(()=>[o(U,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:l(m).branch,"onUpdate:modelValue":t[1]||(t[1]=i=>l(m).branch=i),items:l(v),"item-title":l(a),"return-object":!1,"item-value":"id",placeholder:e.$t("Select a Branch"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","item-title","placeholder","class","style"]),o(U,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:l(m).area,"onUpdate:modelValue":t[2]||(t[2]=i=>l(m).area=i),items:l(c),"item-title":"name_en","return-object":!1,"item-value":"name_en",placeholder:e.$t("Select an Area"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),o(U,{"prepend-inner-icon":"tabler-activity-heartbeat",multiple:"",modelValue:l(m).status,"onUpdate:modelValue":t[3]||(t[3]=i=>l(m).status=i),items:l(fe),"item-title":"name","item-value":"value","return-object":!1,placeholder:e.$t("Select a Status"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),o(U,{"prepend-inner-icon":"tabler-activity-heartbeat","return-object":!1,multiple:"",modelValue:l(m).payment,"onUpdate:modelValue":t[4]||(t[4]=i=>l(m).payment=i),items:l(ye),"item-title":"name","item-value":"value",placeholder:e.$t("Select a Payment Method"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"])]),_:1}),o(T,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:n(()=>[o(U,{"prepend-inner-icon":"tabler-user",modelValue:l(m).agent,"onUpdate:modelValue":t[5]||(t[5]=i=>l(m).agent=i),multiple:"",items:l(C),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select an Agent"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),o(U,{"prepend-inner-icon":"tabler-truck-delivery",multiple:"",modelValue:l(m).delivery,"onUpdate:modelValue":t[6]||(t[6]=i=>l(m).delivery=i),items:l(O),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select a Delivery"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),o(s,{modelValue:l(m).from,"onUpdate:modelValue":t[7]||(t[7]=i=>l(m).from=i),placeholder:e.$t("From"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","placeholder","class","style"]),o(s,{modelValue:l(m).to,"onUpdate:modelValue":t[8]||(t[8]=i=>l(m).to=i),placeholder:e.$t("To"),class:h(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:P(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","placeholder","class","style"])]),_:1})]),_:1}),o(G,{cols:"12",class:"mt-2 v-col-sm-12 v-col-md-2 v-col-lg-2"},{default:n(()=>[o(X,{class:"mx-0",block:"",variant:"tonal",color:"warning","prepend-icon":"tabler-x",onClick:be,disabled:l(p)||!l(V)},{default:n(()=>[j(w(e.$t("Reset")),1)]),_:1},8,["disabled"]),o(X,{class:"mx-0 mt-5",block:"",variant:"tonal",color:"success","prepend-icon":"tabler-search",onClick:t[9]||(t[9]=i=>ge(_().filters)),disabled:!l(he).length||l(p)},{default:n(()=>[j(w(e.$t("Search")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"]),o(y,{hasProducts:l(oe),gettingReports:l(p),meta:l(b),reports:l(R),filters:_(),onUpdateSortBy:se,onUpdatePageN:le},null,8,["hasProducts","gettingReports","meta","reports","filters"])]),_:1})]),_:1}),o(ne,{value:"layouts",class:"py-7"},{default:n(()=>[o(G,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-5"},{default:n(()=>[ee("p",Ye,w(e.$t("layouts_reports")),1),o(g,{hasProducts:l(oe),gettingReports:l(p),meta:l(b),reports:l(R),filters:_(),onUpdateSortBy:se,onUpdatePageN:le},null,8,["hasProducts","gettingReports","meta","reports","filters"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};typeof re=="function"&&re(ce);const St=we(ce,[["__scopeId","data-v-f600abb4"]]);export{St as default};
