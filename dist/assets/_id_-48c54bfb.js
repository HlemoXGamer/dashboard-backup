import{_ as oe}from"./AppTextarea-08c95d83.js";import{l as d,aP as ne,aV as ie,R as ue,o as f,b as v,w as n,q as o,U as p,W as _,n as D,y as T,s as a,b1 as c,b3 as de,A as y,b4 as pe,c as H,F as me,a as ce,z as J,b5 as fe,G as ge,az as ve,H as _e,b0 as be,a$ as Ve,aZ as Z,aW as xe,a_ as ye}from"./index-ae436fe7.js";import{g as we}from"./categories-eb58dd57.js";import{s as ke,b as he,u as $e}from"./products-1699b9e0.js";import{g as Ue,a as Ie}from"./extra-flavors-fada5fda.js";import{g as Pe}from"./categories-323e4fed.js";import{s as qe,a as Fe,u as je}from"./products-0c3d1fa8.js";import{t as Ce}from"./files-2e167225.js";import{V as z}from"./VCombobox-00c6c73c.js";import{V as Ne}from"./VFileInput-1eda2607.js";import{V as w}from"./VSwitch-2de61c53.js";import"./VSelect-37a65f33.js";import"./VList-5353bc34.js";import"./ssrBoot-23d40ca5.js";import"./VDivider-b42cad0f.js";import"./dialog-transition-568cfe1a.js";import"./VMenu-2753b03a.js";import"./VOverlay-b7c1cab0.js";import"./lazy-98a42def.js";import"./VCheckboxBtn-b63b227c.js";import"./VSelectionControl-36f39ce1.js";import"./VChip-4bd7dba5.js";import"./filter-c9d71b19.js";const Se={class:"text-h4 pt-3 pb-2 px-3"},Be={class:"text-h4 pt-3 pb-2 px-3"},Ee={class:"position-relative"},Re={__name:"[id]",setup(Ae){var G;const b=d(!1),u=(G=JSON.parse(localStorage.getItem("userData")))==null?void 0:G.type,g=ne().params.id,V=d([]),m=d([]),k=d([]),O=d([]),L=d([]),x=ie(),M=d(),e=d({code:"",categories:[],created_at:"",description_ar:"",description_en:"",has_image:0,has_note:0,id:"",images:"",in_stock:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",extras:[],flavors:[],extra_quantity:1,is_pre:0}),W=d([]),K=async l=>{if(l instanceof File){let t=await Ce(l);m.value.push({id:null,url:t}),W.value.push(l)}},Q=async()=>{await K(V.value.pop())},X=async()=>{u=="admin"?await ke(g).then(l=>{let{code:t,created_at:r,description_ar:i,description_en:s,categories:h,has_image:$,has_note:U,id:I,images:P,in_stock:q,is_active:F,name_ar:j,name_en:C,prep_time:N,price:S,extras:B,flavors:E,extra_quantity:R,is_pre:A}=l.data.data;e.value={code:t,created_at:r,description_ar:i,description_en:s,has_image:$,has_note:U,id:I,images:P,in_stock:q,is_active:F,name_ar:j,name_en:C,prep_time:N,price:S,extras:B,flavors:E,extra_quantity:R,is_pre:A},e.value.categories=l.data.data.categories.map(re=>re.id),m.value=e.value.images}):await qe(g).then(l=>{let{code:t,created_at:r,categories:i,description_ar:s,description_en:h,has_image:$,has_note:U,id:I,images:P,in_stock:q,is_active:F,name_ar:j,name_en:C,prep_time:N,price:S,extras:B,flavors:E,extra_quantity:R,is_pre:A}=l.data.data;e.value={code:t,categories:i,created_at:r,description_ar:s,description_en:h,has_image:$,has_note:U,id:I,images:P,in_stock:q,is_active:F,name_ar:j,name_en:C,prep_time:N,price:S,extras:B,flavors:E,extra_quantity:R,is_pre:A},m.value=e.value.images})},Y=async l=>{if(se(l.url))try{m.value.splice(m.value.indexOf(l),1);const{data:t}=u=="admin"?await he({path:l.url.split("/").pop(),product_id:g}):await Fe({path:l.url.split("/").pop(),product_id:g});x.success(t.message)}catch(t){x.error(t.response.data.message)}else m.value.splice(m.value.indexOf(l),1)},ee=async()=>{var l;(l=M.value)==null||l.validate().then(async({valid:t})=>{if(t){b.value=!0;let r=new FormData;r.append("code",e.value.code),r.append("created_at",e.value.created_at),r.append("categories",e.value.categories),r.append("description_ar",e.value.description_ar),r.append("description_en",e.value.description_en),r.append("has_image",e.value.has_image),r.append("has_note",e.value.has_note),r.append("id",e.value.id),r.append("in_stock",e.value.in_stock),r.append("is_active",e.value.is_active),r.append("name_ar",e.value.name_ar),r.append("name_en",e.value.name_en),r.append("prep_time",e.value.prep_time),r.append("price",e.value.price),r.append("is_pre",e.value.is_pre),e.value.extras.concat(e.value.flavors).forEach((i,s)=>{r.append(`extra_flavors[${s}]`,i)}),r.append("quantity",e.value.extra_quantity),W.value.forEach((i,s)=>{r.append(`images[${s}]`,i)});try{u=="admin"?await $e(g,r):await je(g,r),x.success("Product updated successfully"),b.value=!1,xe.back()}catch(i){x.error(i.response.data.message),b.value=!1}}})},ae=()=>{u=="admin"?we().then(({data:l,meta:t})=>{k.value=l.data}):u=="markter"&&Pe().then(({data:l,meta:t})=>{k.value=l.data})},te=()=>{u=="admin"&&Ue().then(({data:l,meta:t})=>{L.value=l.data})},le=()=>{u=="admin"&&Ie().then(({data:l,meta:t})=>{O.value=l.data})};function se(l){return/^(ftp|http|https):\/\/[^ "]+$/.test(l)}return ue(()=>{ae(),te(),le(),X()}),(l,t)=>{const r=ye,i=oe;return f(),v(Ve,{ref_key:"refVForm",ref:M,onSubmit:be(ee,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[o(p,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[o(_,{cols:"7",style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-7"},{default:n(()=>[D("p",Se,T(l.$t("Update Product")),1),o(_,{class:"px-5"},{default:n(()=>[o(p,{justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-package",class:"flex-grow-1 me-1",rules:[a(c)],modelValue:a(e).name_en,"onUpdate:modelValue":t[0]||(t[0]=s=>a(e).name_en=s),label:"Name"},null,8,["rules","modelValue"]),o(r,{"append-inner-icon":"tabler-package",class:"flex-grow-1 ms-1 text-right",rules:[a(c)],modelValue:a(e).name_ar,"onUpdate:modelValue":t[1]||(t[1]=s=>a(e).name_ar=s),label:"الاسم",dir:"rtl"},null,8,["rules","modelValue"])]),_:1}),o(p,{class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(i,{class:"flex-grow-1 me-1",rules:[a(c)],modelValue:a(e).description_en,"onUpdate:modelValue":t[2]||(t[2]=s=>a(e).description_en=s),label:"Description"},null,8,["rules","modelValue"]),o(i,{class:"flex-grow-1 ms-1 text-right",rules:[a(c)],dir:"rtl",modelValue:a(e).description_ar,"onUpdate:modelValue":t[3]||(t[3]=s=>a(e).description_ar=s),label:"الوصف"},null,8,["rules","modelValue"])]),_:1}),a(u)=="admin"?(f(),v(p,{key:0,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-coins",modelValue:a(e).price,"onUpdate:modelValue":t[4]||(t[4]=s=>a(e).price=s),rules:[a(c),a(de)],class:"flex-grow-1 me-1",label:l.$t("Product Price")},null,8,["modelValue","rules","label"]),o(z,{"prepend-inner-icon":"tabler-bookmark",multiple:"",items:a(k),"item-value":"id","item-title":"name_en","return-object":!1,rules:[a(c)],modelValue:a(e).categories,"onUpdate:modelValue":t[5]||(t[5]=s=>a(e).categories=s),class:"flex-grow-0 ms-1 w-50 mt-6",label:l.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):y("",!0),a(u)=="admin"?(f(),v(p,{key:1,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:a(e).code,"onUpdate:modelValue":t[6]||(t[6]=s=>a(e).code=s),rules:[a(c)],class:"flex-grow-1 me-1",label:l.$t("Product Code")},null,8,["modelValue","rules","label"]),o(r,{"prepend-inner-icon":"tabler-clock",modelValue:a(e).prep_time,"onUpdate:modelValue":t[7]||(t[7]=s=>a(e).prep_time=s),rules:[a(c)],class:"flex-grow-1 ms-1",label:l.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):y("",!0),a(u)=="admin"?(f(),v(p,{key:2,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(z,{"prepend-inner-icon":"tabler-package",multiple:"","return-object":!1,items:a(O),"item-value":"id","item-title":"name",modelValue:a(e).extras,"onUpdate:modelValue":t[8]||(t[8]=s=>a(e).extras=s),class:"flex-grow-1 ms-1 mt-3",label:l.$t("Select Extra")},null,8,["items","modelValue","label"]),o(z,{multiple:"","prepend-inner-icon":"tabler-package","return-object":!1,items:a(L),"item-value":"id","item-title":"name",modelValue:a(e).flavors,"onUpdate:modelValue":t[9]||(t[9]=s=>a(e).flavors=s),class:"flex-grow-1 ms-1 mt-3",label:l.$t("Select Flavor")},null,8,["items","modelValue","label"]),o(r,{"prepend-inner-icon":"tabler-numbers",modelValue:a(e).extra_quantity,"onUpdate:modelValue":t[10]||(t[10]=s=>a(e).extra_quantity=s),rules:[a(pe)(a(e).extra_quantity,a(e).is_pre===1)],class:"flex-grow-1 ms-1 mt-3",placeholder:l.$t("extra_quantity")},null,8,["modelValue","rules","placeholder"])]),_:1})):y("",!0)]),_:1})]),_:1}),o(_,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[D("p",Be,T(l.$t("Images")),1),o(p,null,{default:n(()=>[o(_,null,{default:n(()=>[o(p,{class:"px-5"},{default:n(()=>[(f(!0),H(me,null,ce(a(m),s=>(f(),H("div",null,[D("div",Ee,[o(J,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:h=>Y(s)},null,8,["onClick"]),o(fe,{"prepend-icon":"tabler-camera",src:s.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),o(Ne,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:l.$t("Upload image"),modelValue:a(V),"onUpdate:modelValue":t[11]||(t[11]=s=>ge(V)?V.value=s:null),onChange:Q},null,8,["label","modelValue"])]),_:1})]),_:1}),a(u)=="admin"?(f(),v(_,{key:0,class:"mt-2"},{default:n(()=>[o(w,{modelValue:a(e).is_active,"onUpdate:modelValue":t[12]||(t[12]=s=>a(e).is_active=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Active")},null,8,["modelValue","label"]),o(w,{modelValue:a(e).has_image,"onUpdate:modelValue":t[13]||(t[13]=s=>a(e).has_image=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Image")},null,8,["modelValue","label"]),o(w,{modelValue:a(e).has_note,"onUpdate:modelValue":t[14]||(t[14]=s=>a(e).has_note=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Need Note")},null,8,["modelValue","label"]),o(w,{modelValue:a(e).is_pre,"onUpdate:modelValue":t[15]||(t[15]=s=>a(e).is_pre=s),inset:!1,"false-value":0,"true-value":1,label:l.$t("Is Pre")},null,8,["modelValue","label"])]),_:1})):y("",!0),o(p,{class:"px-5 mt-2"},{default:n(()=>[o(ve,{color:"primary",loading:a(b),type:"submit",block:""},{default:n(()=>[o(J,{start:"",icon:"tabler-check"}),_e(T(l.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])}}};typeof Z=="function"&&Z(Re);export{Re as default};
