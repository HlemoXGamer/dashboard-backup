import{_ as j}from"./DialogCloseBtn-8876c18b.js";import{r as U,g as M}from"./deliveries-bdd94cba.js";import{r as q,g as E}from"./deliveries-088d8f78.js";import{D as G,O,l as p,aV as H,r as P,o as D,c as X,q as e,w as a,s as t,I as R,aX as z,H as w,az as $,G as A,b7 as K,t as Q,y as x,n as J,z as T,F as W,R as Y,b as I,a2 as Z,a1 as N,A as F,a_ as ee}from"./index-62e44508.js";import{V as ae}from"./VDialog-91d65965.js";import{V as te}from"./VDataTable-329f6e33.js";import{V as le}from"./VChip-a068bcbe.js";import{_ as se}from"./AppCombobox-9f736e21.js";import{a as oe}from"./branches-8f357470.js";import{g as re}from"./deliveries-2e7560e2.js";import"./VOverlay-2d57c717.js";import"./lazy-5ea71c27.js";import"./dialog-transition-723f764d.js";import"./VCheckboxBtn-b1f0a5d3.js";import"./VSelectionControl-c75bc7bf.js";import"./VSelect-fae3330c.js";import"./VList-1328fe71.js";import"./ssrBoot-1773477a.js";import"./VDivider-2dfa86e0.js";import"./VMenu-f088b4c3.js";import"./filter-4f94d92f.js";import"./VTable-a3423897.js";import"./VCombobox-7b54def3.js";const ne={class:"d-flex gap-1"},ie={__name:"DeliveriesTable",props:{deliveries:{type:Array,default:[]},search:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(k){var y;const i=k,u=(y=JSON.parse(localStorage.getItem("userData")))==null?void 0:y.type,f=G(),o=f.t,b=O(()=>{if(f.locale.value==="en")return"branch.name_en";if(f.locale.value==="ar")return"branch.name_ar"}),_=p([]),m=p(!1),C=H(),c=p(!1),V=O(()=>[{title:o("Name"),key:"name",sortable:!1},u!=="restaurant"?{title:o("Branch"),key:b,sortable:!1}:"",{title:o("Phone Number"),key:"phone",sortable:!1},{title:o("Created At"),key:"created_at",sortable:!1},{title:o("Status"),key:"is_active",align:"center",sortable:!1},{title:o("Actions"),sortable:!1,key:"actions"}]),l=d=>{if(parseInt(d)!==0)return{color:"success",text:o("Active")};if(parseInt(d)===0)return{color:"secondary",text:o("Disabled")}};let r={};const h=d=>{r=d,_.value=JSON.stringify(d),_.value=JSON.parse(_.value),c.value=!0},B=async()=>{m.value=!0;try{u=="admin"?await U(_.value):u=="logistic"&&await q(_.value),i.deliveries.splice(i.deliveries.indexOf(r),1),C.success("Delivery man deleted successfully"),m.value=!1,c.value=!1}catch(d){C.error(d.response.data.message)}},L=(d,n,v,S)=>{n=n.split(",");const s=n[0],g=n[1];return v.raw.name.toLowerCase().includes(s.toLowerCase())&&(g=="undefined"||g=="null")?v.raw.name.toLowerCase().includes(s.toLowerCase()):v.raw.name.toLowerCase().includes(s.toLowerCase())&&g!=="undefined"&&g!=="null"&&v.raw.branch.name_en.toLowerCase().includes(g.toLowerCase())?v.raw.name.toLowerCase().includes(s.toLowerCase())&&v.raw.branch.name_en.toLowerCase().includes(g.toLowerCase()):!1};return(d,n)=>{const v=j,S=P("IconBtn");return D(),X(W,null,[e(ae,{modelValue:t(c),"onUpdate:modelValue":n[3]||(n[3]=s=>A(c)?c.value=s:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(v,{onClick:n[0]||(n[0]=s=>c.value=!t(c))}),e(R,{title:"Delete Delivery man"},{default:a(()=>[e(z,null,{default:a(()=>[w(" Are you sure that you want to delete this Delivery man? ")]),_:1}),e(z,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e($,{color:"secondary",variant:"tonal",onClick:n[1]||(n[1]=s=>c.value=!1),disabled:t(m)},{default:a(()=>[w(" Cancel ")]),_:1},8,["disabled"]),e($,{onClick:n[2]||(n[2]=s=>B()),loading:t(m)},{default:a(()=>[w(" Delete ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(R,{elevation:"0",rounded:"0",class:"px-0 mb-0 pb-5 mt-10 pt-2",loading:k.loading},{default:a(()=>[e(t(te),{items:i.deliveries,headers:t(V),search:i.search,"custom-filter":L,"items-per-page":15},K({"item.is_active":a(({item:s})=>[e(le,{color:l(s.raw.is_active).color,class:Q([`text-${l(s.raw.is_active).color}`,"font-weight-medium"]),size:"small"},{default:a(()=>[w(x(l(s.raw.is_active).text),1)]),_:2},1032,["color","class"])]),_:2},[t(u)=="admin"||t(u)=="logistic"?{name:"item.actions",fn:a(({item:s})=>[J("div",ne,[e(S,{onClick:g=>d.$router.push(`deliveries/edit/${s.raw.id}`)},{default:a(()=>[e(T,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),e(S,null,{default:a(()=>[e(T,{icon:"mdi-delete-outline",onClick:g=>h(s.value)},null,8,["onClick"])]),_:2},1024)])]),key:"0"}:t(u)=="restaurant"?{name:"item.actions",fn:a(({item:s})=>[e($,{variant:"flat",to:`/deliveries/${s.raw.id}`},{default:a(()=>[w(x(d.$t("View Details")),1)]),_:2},1032,["to"])]),key:"1"}:void 0]),1032,["items","headers","search"])]),_:1},8,["loading"])],64)}}},de={class:"text-h4"},Ae={__name:"index",setup(k){var V;const i=(V=JSON.parse(localStorage.getItem("userData")))==null?void 0:V.type,u=p(!1),f=p([]),o=p(""),b=p([]),_=p([]),m=p(),C=()=>{oe().then(({data:l,meta:r})=>{b.value=l.data.map(h=>h.name_en),_.value=l.data})},c=async()=>{u.value=!0,i=="admin"?await M().then(({data:l,meta:r})=>{f.value=l.data}):i=="restaurant"?await re().then(({data:l,meta:r})=>{f.value=l.data}):i=="logistic"&&await E().then(({data:l,meta:r})=>{f.value=l.data}),u.value=!1};return Y(()=>{i=="admin"&&C(),c()}),(l,r)=>{const h=ee,B=se,L=ie;return D(),I(N,{class:"mt-4 px-4"},{default:a(()=>[e(Z,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded"},{default:a(()=>[e(N,{class:"pt-5 pb-2 px-5",align:"center",justify:"space-between"},{default:a(()=>[J("p",de,x(l.$t("Deliveries")),1),t(i)=="admin"||t(i)=="logistic"?(D(),I($,{key:0,onClick:r[0]||(r[0]=y=>l.$router.push("deliveries/add/"))},{default:a(()=>[e(T,{start:"",icon:"tabler-plus"}),w(x(l.$t("Add Delivery")),1)]),_:1})):F("",!0)]),_:1}),e(N,{class:"px-7",align:"center",justify:"start"},{default:a(()=>[e(h,{modelValue:t(o),"onUpdate:modelValue":r[1]||(r[1]=y=>A(o)?o.value=y:null),placeholder:l.$t("Search for a Delivery"),class:"mx-2 my-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","placeholder"]),t(i)=="admin"?(D(),I(B,{key:0,modelValue:t(m),"onUpdate:modelValue":r[2]||(r[2]=y=>A(m)?m.value=y:null),items:t(b),variant:"outlined",clearable:"",placeholder:l.$t("Branches"),class:"flex-grow-0 mx-2 my-2",style:{width:"300px","max-width":"300px"}},null,8,["modelValue","items","placeholder"])):F("",!0)]),_:1}),e(L,{loading:t(u),deliveries:t(f),search:t(o)+","+t(m)},null,8,["loading","deliveries","search"])]),_:1})]),_:1})}}};export{Ae as default};
