import{_ as oe}from"./AppTextarea-49744861.js";import{l as d,aP as ne,aV as ie,R as ue,o as f,b as v,w as n,q as o,a1 as p,a2 as b,n as D,y as T,s as a,b1 as m,b3 as de,A as w,c as J,F as pe,a as me,z as Q,b4 as ce,G as fe,az as ge,H as ve,b0 as be,a$ as _e,aZ as W,aW as Ve,a_ as ye}from"./index-358c466b.js";import{g as we}from"./categories-5b1f35fe.js";import{s as xe,b as ke,u as he}from"./products-2ee3de83.js";import{g as $e,a as Ue}from"./extra-flavors-23cc4e6c.js";import{g as Ie}from"./categories-025d2c33.js";import{s as Pe,a as Fe,u as je}from"./products-c54e6430.js";import{t as Ce}from"./files-2e167225.js";import{V as z}from"./VCombobox-4f8968e1.js";import{V as qe}from"./VFileInput-7d24b278.js";import{V as x}from"./VSwitch-cb13388f.js";import"./VSelect-5e4f7ae5.js";import"./VList-8b7c6abf.js";import"./ssrBoot-404c9b1f.js";import"./VDivider-a7998058.js";import"./dialog-transition-d456e6da.js";import"./VMenu-317b780d.js";import"./VOverlay-2dca64b1.js";import"./lazy-0a540379.js";import"./VCheckboxBtn-9bbd9eb4.js";import"./VSelectionControl-32ddc2e6.js";import"./VChip-01fa3c4b.js";import"./filter-4c18135b.js";const Ne={class:"text-h4 pt-3 pb-2 px-3"},Se={class:"text-h4 pt-3 pb-2 px-3"},Be={class:"position-relative"},Ee={__name:"[id]",setup(Re){var H;const _=d(!1),u=(H=JSON.parse(localStorage.getItem("userData")))==null?void 0:H.type,g=ne().params.id,V=d([]),c=d([]),k=d([]),O=d([]),L=d([]),y=ie(),M=d(),e=d({code:"",categories:[],created_at:"",description_ar:"",description_en:"",has_image:0,has_note:0,id:"",images:"",in_stock:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",extras:[],flavors:[],quantity:1,is_pre:0}),G=d([]),Z=async t=>{if(t instanceof File){let l=await Ce(t);c.value.push({id:null,url:l}),G.value.push(t)}},K=async()=>{await Z(V.value.pop())},X=async()=>{u=="admin"?await xe(g).then(t=>{let{code:l,created_at:r,description_ar:i,description_en:s,categories:h,has_image:$,has_note:U,id:I,images:P,in_stock:F,is_active:j,name_ar:C,name_en:q,prep_time:N,price:S,extras:B,flavors:E,quantity:R,is_pre:A}=t.data.data;e.value={code:l,created_at:r,description_ar:i,description_en:s,has_image:$,has_note:U,id:I,images:P,in_stock:F,is_active:j,name_ar:C,name_en:q,prep_time:N,price:S,extras:B,flavors:E,quantity:R,is_pre:A},e.value.categories=t.data.data.categories.map(re=>re.id),c.value=e.value.images}):await Pe(g).then(t=>{let{code:l,created_at:r,categories:i,description_ar:s,description_en:h,has_image:$,has_note:U,id:I,images:P,in_stock:F,is_active:j,name_ar:C,name_en:q,prep_time:N,price:S,extras:B,flavors:E,quantity:R,is_pre:A}=t.data.data;e.value={code:l,categories:i,created_at:r,description_ar:s,description_en:h,has_image:$,has_note:U,id:I,images:P,in_stock:F,is_active:j,name_ar:C,name_en:q,prep_time:N,price:S,extras:B,flavors:E,quantity:R,is_pre:A},c.value=e.value.images})},Y=async t=>{if(se(t.url))try{c.value.splice(c.value.indexOf(t),1);const{data:l}=u=="admin"?await ke({path:t.url.split("/").pop(),product_id:g}):await Fe({path:t.url.split("/").pop(),product_id:g});y.success(l.message)}catch(l){y.error(l.response.data.message)}else c.value.splice(c.value.indexOf(t),1)},ee=async()=>{var t;(t=M.value)==null||t.validate().then(async({valid:l})=>{if(l){_.value=!0;let r=new FormData;r.append("code",e.value.code),r.append("created_at",e.value.created_at),r.append("categories",e.value.categories),r.append("description_ar",e.value.description_ar),r.append("description_en",e.value.description_en),r.append("has_image",e.value.has_image),r.append("has_note",e.value.has_note),r.append("id",e.value.id),r.append("in_stock",e.value.in_stock),r.append("is_active",e.value.is_active),r.append("name_ar",e.value.name_ar),r.append("name_en",e.value.name_en),r.append("prep_time",e.value.prep_time),r.append("price",e.value.price),e.value.extras.concat(e.value.flavors).forEach((i,s)=>{r.append(`extra_flavors[${s}]`,i)}),r.append("quantity",e.value.quantity),r.append("is_pre",e.value.is_pre),G.value.forEach((i,s)=>{r.append(`images[${s}]`,i)});try{u=="admin"?await he(g,r):await je(g,r),y.success("Product updated successfully"),_.value=!1,Ve.back()}catch(i){y.error(i.response.data.message),_.value=!1}}})},ae=()=>{u=="admin"?we().then(({data:t,meta:l})=>{k.value=t.data}):u=="markter"&&Ie().then(({data:t,meta:l})=>{k.value=t.data})},le=()=>{u=="admin"&&$e().then(({data:t,meta:l})=>{L.value=t.data})},te=()=>{u=="admin"&&Ue().then(({data:t,meta:l})=>{O.value=t.data})};function se(t){return/^(ftp|http|https):\/\/[^ "]+$/.test(t)}return ue(()=>{ae(),le(),te(),X()}),(t,l)=>{const r=ye,i=oe;return f(),v(_e,{ref_key:"refVForm",ref:M,onSubmit:be(ee,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[o(p,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[o(b,{cols:"7",style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-7"},{default:n(()=>[D("p",Ne,T(t.$t("Update Product")),1),o(b,{class:"px-5"},{default:n(()=>[o(p,{justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-package",class:"flex-grow-1 me-1",rules:[a(m)],modelValue:a(e).name_en,"onUpdate:modelValue":l[0]||(l[0]=s=>a(e).name_en=s),label:"Name"},null,8,["rules","modelValue"]),o(r,{"append-inner-icon":"tabler-package",class:"flex-grow-1 ms-1 text-right",rules:[a(m)],modelValue:a(e).name_ar,"onUpdate:modelValue":l[1]||(l[1]=s=>a(e).name_ar=s),label:"الاسم",dir:"rtl"},null,8,["rules","modelValue"])]),_:1}),o(p,{class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(i,{class:"flex-grow-1 me-1",rules:[a(m)],modelValue:a(e).description_en,"onUpdate:modelValue":l[2]||(l[2]=s=>a(e).description_en=s),label:"Description"},null,8,["rules","modelValue"]),o(i,{class:"flex-grow-1 ms-1 text-right",rules:[a(m)],dir:"rtl",modelValue:a(e).description_ar,"onUpdate:modelValue":l[3]||(l[3]=s=>a(e).description_ar=s),label:"الوصف"},null,8,["rules","modelValue"])]),_:1}),a(u)=="admin"?(f(),v(p,{key:0,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-coins",modelValue:a(e).price,"onUpdate:modelValue":l[4]||(l[4]=s=>a(e).price=s),rules:[a(m),a(de)],class:"flex-grow-1 mr-1",label:t.$t("Product Price")},null,8,["modelValue","rules","label"]),o(z,{"prepend-inner-icon":"tabler-bookmark",multiple:"",items:a(k),"item-value":"id","item-title":"name_en","return-object":!1,rules:[a(m)],modelValue:a(e).categories,"onUpdate:modelValue":l[5]||(l[5]=s=>a(e).categories=s),class:"flex-grow-0 ml-1 w-50 mt-6",label:t.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):w("",!0),a(u)=="admin"?(f(),v(p,{key:1,class:"mt-10 pb-10",justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:a(e).code,"onUpdate:modelValue":l[6]||(l[6]=s=>a(e).code=s),rules:[a(m)],class:"flex-grow-1 mr-1",label:t.$t("Product Code")},null,8,["modelValue","rules","label"]),o(r,{"prepend-inner-icon":"tabler-clock",modelValue:a(e).prep_time,"onUpdate:modelValue":l[7]||(l[7]=s=>a(e).prep_time=s),rules:[a(m)],class:"flex-grow-1 ml-1",label:t.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):w("",!0),a(u)=="admin"?(f(),v(p,{key:2,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(z,{"prepend-inner-icon":"tabler-package",multiple:"","return-object":!1,items:a(O),"item-value":"id","item-title":"name",modelValue:a(e).extras,"onUpdate:modelValue":l[8]||(l[8]=s=>a(e).extras=s),class:"flex-grow-1 ml-1 mt-3",label:t.$t("Select Extra")},null,8,["items","modelValue","label"]),o(z,{"prepend-inner-icon":"tabler-package","return-object":!1,items:a(L),"item-value":"id","item-title":"name",modelValue:a(e).flavors,"onUpdate:modelValue":l[9]||(l[9]=s=>a(e).flavors=s),class:"flex-grow-1 ml-1 mt-3",label:t.$t("Select Flavor")},null,8,["items","modelValue","label"]),o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:a(e).quantity,"onUpdate:modelValue":l[10]||(l[10]=s=>a(e).quantity=s),rules:[a(m)],class:"flex-grow-1 ml-1 mt-3",placeholder:t.$t("Quantity")},null,8,["modelValue","rules","placeholder"])]),_:1})):w("",!0)]),_:1})]),_:1}),o(b,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[D("p",Se,T(t.$t("Images")),1),o(p,null,{default:n(()=>[o(b,null,{default:n(()=>[o(p,{class:"px-5"},{default:n(()=>[(f(!0),J(pe,null,me(a(c),s=>(f(),J("div",null,[D("div",Be,[o(Q,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:h=>Y(s)},null,8,["onClick"]),o(ce,{"prepend-icon":"tabler-camera",src:s.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),o(qe,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:t.$t("Upload image"),modelValue:a(V),"onUpdate:modelValue":l[11]||(l[11]=s=>fe(V)?V.value=s:null),onChange:K},null,8,["label","modelValue"])]),_:1})]),_:1}),a(u)=="admin"?(f(),v(b,{key:0,class:"mt-2"},{default:n(()=>[o(x,{modelValue:a(e).is_active,"onUpdate:modelValue":l[12]||(l[12]=s=>a(e).is_active=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Active")},null,8,["modelValue","label"]),o(x,{modelValue:a(e).has_image,"onUpdate:modelValue":l[13]||(l[13]=s=>a(e).has_image=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Need Image")},null,8,["modelValue","label"]),o(x,{modelValue:a(e).has_note,"onUpdate:modelValue":l[14]||(l[14]=s=>a(e).has_note=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Need Note")},null,8,["modelValue","label"]),o(x,{modelValue:a(e).is_pre,"onUpdate:modelValue":l[15]||(l[15]=s=>a(e).is_pre=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Is Pre")},null,8,["modelValue","label"])]),_:1})):w("",!0),o(p,{class:"px-5 mt-2"},{default:n(()=>[o(ge,{color:"primary",loading:a(_),type:"submit",block:""},{default:n(()=>[o(Q,{start:"",icon:"tabler-check"}),ve(T(t.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])}}};typeof W=="function"&&W(Ee);export{Ee as default};
