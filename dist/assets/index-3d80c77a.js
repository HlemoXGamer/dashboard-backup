import{_ as Y}from"./AppDateTimePicker-ea2a4526.js";import{_ as Z}from"./DialogCloseBtn-513e4898.js";import{C as K,p as Q,a as ee,b as te,L as ae,c as le,P as oe,d as se,e as ne,m as O}from"./stats-ff37ee98.js";import{d as re,h as L,D as ie,l as m,R as ue,o as j,c as de,q as t,w as s,I as V,aX as $,s as u,G as S,az as I,H as P,y,a1 as k,n as D,t as ce,z as R,b as pe,a2 as me,aZ as E,Y as fe}from"./index-581c2083.js";import{m as N}from"./stats-e4bb8cc2.js";import{m as z,a as U,b as A,c as M}from"./stats-990a9a58.js";import{V as ve}from"./VDialog-9c77a5f1.js";import{V as W}from"./VSpacer-78f2ea51.js";import{V as he}from"./VSelect-91e75b33.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./dialog-transition-e2ab3ff7.js";import"./VList-800b0139.js";import"./ssrBoot-f2e19377.js";import"./VDivider-007f86e5.js";import"./VMenu-568d971d.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VChip-2cd4c1fb.js";K.register(Q,ee,te,ae,le,oe,se);const ye=re({name:"LineChart",props:{chartId:{type:String,default:"line-chart"},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{default:"",type:String},styles:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},chartOptions:{type:Object,default:()=>({})}},setup(f){return()=>L(L(ne),{chartId:f.chartId,width:f.width,height:f.height,cssClasses:f.cssClasses,styles:f.styles,plugins:f.plugins,options:f.chartOptions,data:f.chartData})}}),ge={class:"text-h4 ps-3"},be={class:"text-h4 mt-5 font-weight-bold text-uppsercase"},$e={class:"text-h4 mt-5 font-weight-bold text-uppsercase"},we={class:"text-h4 mt-5 font-weight-bold text-uppsercase"},xe={__name:"index",setup(f){var H;const w=ie().t,g=m(!1),v=m(null),h=m(null),n=(H=JSON.parse(localStorage.getItem("userData")))==null?void 0:H.type,x=JSON.parse(localStorage.getItem("userData")),d=m("today"),F=m("today"),r=m(!1),B=m({export:!1}),J=[{title:w("Custom"),value:"custom"},{title:w("This Month"),value:"month"},{title:w("This Week"),value:"week"},{title:w("Today"),value:"today"}],i=m({orders:"",product:"",sales:""}),c=l=>{_.value.labels=l.plot.map(e=>e.date),_.value.datasets[0].data=l.plot.map(e=>e.sales),_.value.datasets[1].data=l.plot.map(e=>e.orders),T.value+=1},C=async l=>{if(r.value=!0,l===!0){g.value=!1;let e=v.value,o=h.value;n=="admin"?await N(`${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1}):n=="restaurant"?await O(`branch=${x.branch_id}${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1}):n=="operation"?await z(`${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1}):n=="logistic"?await U(`${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1}):n=="finance"?await A(`${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1}):n=="agent"&&await M(`${e!==null?"&from="+e:""}${o!==null?"&to="+o:""}`).then(({data:a})=>{i.value=a,c(a)}).finally(()=>{r.value=!1})}else n=="admin"?await N(d.value).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1}):n=="restaurant"?await O(`${d.value}&branch=${x.branch_id}`).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1}):n=="operation"?await z(`${d.value}`).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1}):n=="logistic"?await U(`${d.value}`).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1}):n=="finance"?await A(`${d.value}`).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1}):n=="agent"&&await M(`${d.value}`).then(({data:e})=>{i.value=e,c(e)}).finally(()=>{r.value=!1});F.value=d.value},T=m(0),_=m({labels:[],datasets:[{fill:!0,tension:.5,pointRadius:4,label:"Sales",pointHoverRadius:5,pointStyle:"circle",borderColor:"#ffcf5c",backgroundColor:"#ffcf5c",pointHoverBorderWidth:5,pointHoverBorderColor:"white",pointBorderColor:"transparent",pointHoverBackgroundColor:"#ffcf5c",data:[]},{fill:!0,tension:.5,label:"Orders",pointRadius:4,pointHoverRadius:5,pointStyle:"circle",borderColor:"#4169e1",backgroundColor:"#4169e1",pointHoverBorderWidth:15,pointHoverBorderColor:"white",pointBorderColor:"transparent",pointHoverBackgroundColor:"#4169e1",data:[]}]}),q=()=>{g.value=!1,d.value="today",v.value=m(null),h.value=m(null),C(!1)},G=()=>{setTimeout(()=>{d.value=="custom"?g.value=!0:C(!1)},100)},X=async()=>{let l=v.value,e=h.value;B.value.export=!0;try{await fe.get(`${n!=="admin"?n:""}/stats/product?${d.value}${l!==null?"&from="+l:""}${e!==null?"&to="+e:""}&export${n=="restaurant"?"&branch="+x.branch_id:""}`,{responseType:"arraybuffer"}).then(o=>{const a=new Blob([o.data],{type:"application/vnd.ms-excel"}),p=window.URL.createObjectURL(a),b=document.createElement("a");b.href=p,b.setAttribute("download",`sales-report-${d.value}${n=="restaurant"?" - "+x.name:""}.xlsx`),document.body.appendChild(b),b.click(),document.body.removeChild(b)})}catch(o){console.log(o)}finally{B.value.export=!1}};return ue(()=>{C()}),(l,e)=>{const o=Z,a=Y;return j(),de("div",null,[t(ve,{modelValue:u(g),"onUpdate:modelValue":e[4]||(e[4]=p=>S(g)?g.value=p:null),persistent:"",class:"v-dialog-sm"},{default:s(()=>[t(o,{onClick:e[0]||(e[0]=p=>q())}),t(V,{title:l.$t("Pick a custom Date")},{default:s(()=>[t($,{class:"d-flex"},{default:s(()=>[t(a,{class:"me-1",placeholder:l.$t("From"),"prepend-inner-icon":"tabler-calendar",modelValue:u(v),"onUpdate:modelValue":e[1]||(e[1]=p=>S(v)?v.value=p:null)},null,8,["placeholder","modelValue"]),t(a,{class:"ms-1",placeholder:l.$t("To"),"prepend-inner-icon":"tabler-calendar",modelValue:u(h),"onUpdate:modelValue":e[2]||(e[2]=p=>S(h)?h.value=p:null)},null,8,["placeholder","modelValue"])]),_:1}),t($,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[t(I,{onClick:e[3]||(e[3]=p=>C(!0)),loading:u(r),disabled:!u(v)&&!u(h)},{default:s(()=>[P(y(l.$t("Pick")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),t(me,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-10"},{default:s(()=>[t(k,{class:"mx-0 my-0 pb-0 px-0 pt-3"},{default:s(()=>[D("p",ge,y(l.$t("Sales Rate")),1),t(W),t(I,{"prepend-icon":"tabler-upload",color:"success",class:"mr-3",onClick:X,loading:u(B).export},{default:s(()=>[P(y(l.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),t(k,{class:"mx-0 py-0 px-4 py-5 mt-1"},{default:s(()=>[t(he,{items:J,"item-value":"value","item-title":"title",modelValue:u(d),"onUpdate:modelValue":e[5]||(e[5]=p=>S(d)?d.value=p:null),label:l.$t("Select a period of time"),"prepend-inner-icon":"tabler-clock"},null,8,["modelValue","label"]),t(I,{class:"ms-2",onClick:e[6]||(e[6]=p=>G()),loading:u(r)},{default:s(()=>[P(y(l.$t("Search")),1)]),_:1},8,["loading"]),t(W)]),_:1}),t(k,{class:ce(["mx-0 my-0 px-4 mt-5",{"flex-nowrap":!l.$vuetify.display.sm}]),align:"center",justify:l.$vuetify.display.sm?"center":"space-between"},{default:s(()=>[t(V,{width:"300","min-width":"210",height:"260",class:"mx-0 mb-0 mt-2 px-0 py-5",color:"primary",variant:"tonal"},{default:s(()=>[t($,{class:"text-center"},{default:s(()=>[t(R,{icon:"tabler-shopping-cart",size:100}),D("p",be,y(u(i).orders||"--"),1)]),_:1})]),_:1}),t(V,{width:"300","min-width":"210",height:"260",class:"mb-0 px-0 mt-2 py-5 mx-2",color:"primary",variant:"tonal"},{default:s(()=>[t($,{class:"text-center"},{default:s(()=>[t(R,{icon:"tabler-currency-dollar",size:100}),D("p",$e,y(u(i).sales||0),1)]),_:1})]),_:1}),t(V,{width:"300","min-width":"210",height:"260",class:"mx-0 mb-0 px-0 py-5 mt-2",color:"primary",variant:"tonal"},{default:s(()=>[t($,{class:"text-center"},{default:s(()=>[t(R,{icon:"tabler-medal",size:100}),D("p",we,y(u(i).product||"--"),1)]),_:1})]),_:1})]),_:1},8,["class","justify"]),t(k,{class:"mx-0 my-0 px-4 mt-5 position-relative rounded-lg"},{default:s(()=>[(j(),pe(u(ye),{height:200,"chart-data":u(_),key:u(T)},null,8,["chart-data"]))]),_:1})]),_:1})])}}};typeof E=="function"&&E(xe);export{xe as default};
