import{_ as q}from"./AppTextarea-65db8f1d.js";import{l as i,aV as M,R as O,o as c,b as _,w as n,q as r,a$ as G,b0 as H,a2 as f,n as x,y as w,a1 as m,s as e,b1 as p,b3 as J,A as k,c as C,F as L,a as W,z as I,b4 as Z,G as K,az as Q,H as X,aZ as N,aW as Y,a_ as ee}from"./index-581c2083.js";import{g as ae}from"./categories-df5ecb75.js";import{c as le}from"./products-c2b322c9.js";import{g as te,a as se}from"./extra-flavors-eedf8c1c.js";import{g as oe}from"./categories-f7a66fa1.js";import{c as re}from"./products-a8249be9.js";import{t as j}from"./files-2e167225.js";import{V as ne}from"./VCombobox-6fdf6a72.js";import{V as ie}from"./VFileInput-2d78526d.js";import{V as h}from"./VSwitch-084d9c96.js";import"./VSelect-91e75b33.js";import"./VList-800b0139.js";import"./ssrBoot-f2e19377.js";import"./VDivider-007f86e5.js";import"./dialog-transition-e2ab3ff7.js";import"./VMenu-568d971d.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VChip-2cd4c1fb.js";import"./filter-887944dd.js";const ue={class:"text-h4 pt-3 pb-2 px-3"},de={class:"text-h4 pt-3 pb-2 px-3"},me={class:"position-relative"},pe={__name:"add",setup(ce){var F;const b=i([]),g=i([]),$=M(),v=i(!1),y=i([]),P=i([]),A=i([]),u=(F=JSON.parse(localStorage.getItem("userData")))==null?void 0:F.type,l=i({code:"",created_at:"",categories:[],description_ar:"",description_en:"",has_image:0,has_note:0,images:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",status:0}),U=i(),V=i([]),S=async t=>{if(t instanceof File){let a=await j(t);g.value.push({id:null,url:a}),V.value.push(t)}},B=async()=>{await S(b.value.pop())},D=async()=>{var t;(t=U.value)==null||t.validate().then(async({valid:a})=>{if(a){v.value=!0;let o=new FormData;o.append("code",l.value.code),o.append("categories",l.value.categories),o.append("description_ar",l.value.description_ar),o.append("description_en",l.value.description_en),o.append("has_image",l.value.has_image),o.append("has_note",l.value.has_note),o.append("is_active",l.value.is_active),o.append("name_ar",l.value.name_ar),o.append("name_en",l.value.name_en),o.append("prep_time",l.value.prep_time),o.append("price",l.value.price),o.append("status",l.value.status),V.value.forEach((d,s)=>{o.append(`images[${s}]`,d)});try{u=="admin"?await le(o):await re(o),$.success("Product added successfully"),v.value=!1,Y.back()}catch(d){$.error(d.response.data.message),v.value=!1}}})},E=()=>{u=="admin"?ae().then(({data:t,meta:a})=>{y.value=t.data}):u=="markter"&&oe().then(({data:t,meta:a})=>{y.value=t.data})},T=()=>{u=="admin"&&te().then(({data:t,meta:a})=>{A.value=t.data})},R=()=>{u=="admin"&&se().then(({data:t,meta:a})=>{P.value=t.data})},z=async t=>{const a=g.value.indexOf(g.value.filter(o=>o.url==t.url)[0]);a!==-1&&g.value.splice(a,1),V.value.forEach(async o=>{o instanceof File&&await j(o).then(d=>{d==t.url&&V.value.splice(o,1)})})};return O(()=>{E(),T(),R()}),(t,a)=>{const o=ee,d=q;return c(),_(m,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[r(G,{ref_key:"refVForm",ref:U,onSubmit:H(D,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[r(f,{cols:"8",class:"pt-0"},{default:n(()=>[r(f,{class:"px-5 rounded pb-10",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:n(()=>[x("p",ue,w(t.$t("Add Product")),1),r(f,{class:"px-5"},{default:n(()=>[r(m,{justify:"space-between",align:"start"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-package",modelValue:e(l).name_en,"onUpdate:modelValue":a[0]||(a[0]=s=>e(l).name_en=s),rules:[e(p)],class:"flex-grow-1 mr-1",label:"Name"},null,8,["modelValue","rules"]),r(o,{"append-inner-icon":"tabler-package",modelValue:e(l).name_ar,"onUpdate:modelValue":a[1]||(a[1]=s=>e(l).name_ar=s),rules:[e(p)],class:"flex-grow-1 ml-1 text-right",dir:"rtl",label:"الاسم"},null,8,["modelValue","rules"])]),_:1}),r(m,{class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[r(d,{modelValue:e(l).description_en,"onUpdate:modelValue":a[2]||(a[2]=s=>e(l).description_en=s),rules:[e(p)],class:"flex-grow-1 mr-1",label:"Description"},null,8,["modelValue","rules"]),r(d,{modelValue:e(l).description_ar,"onUpdate:modelValue":a[3]||(a[3]=s=>e(l).description_ar=s),rules:[e(p)],class:"flex-grow-1 ml-1 text-right",dir:"rtl",label:"الوصف"},null,8,["modelValue","rules"])]),_:1}),e(u)=="admin"?(c(),_(m,{key:0,class:"mt-5",justify:"space-between",align:"center"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-coins",modelValue:e(l).price,"onUpdate:modelValue":a[4]||(a[4]=s=>e(l).price=s),rules:[e(p),e(J)],class:"flex-grow-1 mr-1",label:t.$t("Product Price")},null,8,["modelValue","rules","label"]),r(ne,{"prepend-inner-icon":"tabler-bookmark",multiple:"","return-object":!1,items:e(y),"item-value":"id","item-title":"name_en",rules:[e(p)],modelValue:e(l).categories,"onUpdate:modelValue":a[5]||(a[5]=s=>e(l).categories=s),class:"flex-grow-1 ml-1 mt-6",label:t.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):k("",!0),e(u)=="admin"?(c(),_(m,{key:1,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-dna-2",modelValue:e(l).code,"onUpdate:modelValue":a[6]||(a[6]=s=>e(l).code=s),rules:[e(p)],class:"flex-grow-1 mr-1",label:t.$t("Product Code")},null,8,["modelValue","rules","label"]),r(o,{"prepend-inner-icon":"tabler-clock",modelValue:e(l).prep_time,"onUpdate:modelValue":a[7]||(a[7]=s=>e(l).prep_time=s),rules:[e(p)],class:"flex-grow-1 ml-1",label:t.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1}),r(f,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[x("p",de,w(t.$t("Images")),1),r(m,null,{default:n(()=>[r(f,null,{default:n(()=>[r(m,{class:"px-5"},{default:n(()=>[(c(!0),C(L,null,W(e(g),s=>(c(),C("div",null,[x("div",me,[r(I,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:fe=>z(s)},null,8,["onClick"]),r(Z,{"prepend-icon":"tabler-camera",src:s.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),r(ie,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:t.$t("Upload image"),modelValue:e(b),"onUpdate:modelValue":a[8]||(a[8]=s=>K(b)?b.value=s:null),onChange:B},null,8,["label","modelValue"])]),_:1})]),_:1}),e(u)=="admin"?(c(),_(f,{key:0,class:"mt-2"},{default:n(()=>[r(h,{modelValue:e(l).is_active,"onUpdate:modelValue":a[9]||(a[9]=s=>e(l).is_active=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Active")},null,8,["modelValue","label"]),r(h,{modelValue:e(l).has_image,"onUpdate:modelValue":a[10]||(a[10]=s=>e(l).has_image=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Need Image")},null,8,["modelValue","label"]),r(h,{modelValue:e(l).has_note,"onUpdate:modelValue":a[11]||(a[11]=s=>e(l).has_note=s),inset:!1,"false-value":0,"true-value":1,label:t.$t("Need Note")},null,8,["modelValue","label"])]),_:1})):k("",!0),r(m,{class:"px-5 mt-2"},{default:n(()=>[r(Q,{color:"primary",loading:e(v),type:"submit",block:""},{default:n(()=>[r(I,{start:"",icon:"tabler-plus"}),X(w(t.$t("Add")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}};typeof N=="function"&&N(pe);export{pe as default};
