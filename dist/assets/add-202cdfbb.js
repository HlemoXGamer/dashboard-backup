import{_ as M}from"./AppTextarea-49744861.js";import{l as d,aV as O,R as G,o as c,b,w as n,q as o,a$ as H,b0 as J,a2 as f,n as k,y as $,a1 as m,s as e,b1 as p,b3 as L,A as y,c as N,F as Q,a as W,z as P,b4 as Z,G as K,az as X,H as Y,aZ as S,aW as ee,a_ as ae}from"./index-358c466b.js";import{g as le}from"./categories-5b1f35fe.js";import{c as te}from"./products-2ee3de83.js";import{g as se,a as re}from"./extra-flavors-23cc4e6c.js";import{g as oe}from"./categories-025d2c33.js";import{c as ne}from"./products-c54e6430.js";import{t as q}from"./files-2e167225.js";import{V as U}from"./VCombobox-4f8968e1.js";import{V as ie}from"./VFileInput-7d24b278.js";import{V as x}from"./VSwitch-cb13388f.js";import"./VSelect-5e4f7ae5.js";import"./VList-8b7c6abf.js";import"./ssrBoot-404c9b1f.js";import"./VDivider-a7998058.js";import"./dialog-transition-d456e6da.js";import"./VMenu-317b780d.js";import"./VOverlay-2dca64b1.js";import"./lazy-0a540379.js";import"./VCheckboxBtn-9bbd9eb4.js";import"./VSelectionControl-32ddc2e6.js";import"./VChip-01fa3c4b.js";import"./filter-4c18135b.js";const ue={class:"text-h4 pt-3 pb-2 px-3"},de={class:"text-h4 pt-3 pb-2 px-3"},me={class:"position-relative"},pe={__name:"add",setup(ce){var C;const v=d([]),g=d([]),h=O(),V=d(!1),w=d([]),F=d([]),j=d([]),u=(C=JSON.parse(localStorage.getItem("userData")))==null?void 0:C.type,a=d({code:"",created_at:"",categories:[],description_ar:"",description_en:"",has_image:0,has_note:0,images:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",status:0,extra:[],flavor:[],quantity:1,is_pre:0}),I=d(),_=d([]),A=async s=>{if(s instanceof File){let l=await q(s);g.value.push({id:null,url:l}),_.value.push(s)}},E=async()=>{await A(v.value.pop())},B=async()=>{var s;(s=I.value)==null||s.validate().then(async({valid:l})=>{if(l){V.value=!0;let r=new FormData;r.append("code",a.value.code),r.append("categories",a.value.categories),r.append("description_ar",a.value.description_ar),r.append("description_en",a.value.description_en),r.append("has_image",a.value.has_image),r.append("has_note",a.value.has_note),r.append("is_active",a.value.is_active),r.append("name_ar",a.value.name_ar),r.append("name_en",a.value.name_en),r.append("prep_time",a.value.prep_time),r.append("price",a.value.price),r.append("status",a.value.status),r.append("is_pre",a.value.is_pre),a.value.extras.concat(a.value.flavors).forEach((i,t)=>{r.append(`extra_flavors[${t}]`,i)}),r.append("quantity",a.value.quantity),_.value.forEach((i,t)=>{r.append(`images[${t}]`,i)});try{u=="admin"?await te(r):await ne(r),h.success("Product added successfully"),V.value=!1,ee.back()}catch(i){h.error(i.response.data.message),V.value=!1}}})},D=()=>{u=="admin"?le().then(({data:s,meta:l})=>{w.value=s.data}):u=="markter"&&oe().then(({data:s,meta:l})=>{w.value=s.data})},T=()=>{u=="admin"&&se().then(({data:s,meta:l})=>{j.value=s.data})},R=()=>{u=="admin"&&re().then(({data:s,meta:l})=>{F.value=s.data})},z=async s=>{const l=g.value.indexOf(g.value.filter(r=>r.url==s.url)[0]);l!==-1&&g.value.splice(l,1),_.value.forEach(async r=>{r instanceof File&&await q(r).then(i=>{i==s.url&&_.value.splice(r,1)})})};return G(()=>{D(),T(),R()}),(s,l)=>{const r=ae,i=M;return c(),b(m,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[o(H,{ref_key:"refVForm",ref:I,onSubmit:J(B,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[o(f,{cols:"8",class:"pt-0"},{default:n(()=>[o(f,{class:"px-5 rounded pb-10",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:n(()=>[k("p",ue,$(s.$t("Add Product")),1),o(f,{class:"px-5"},{default:n(()=>[o(m,{justify:"space-between",align:"start"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-package",modelValue:e(a).name_en,"onUpdate:modelValue":l[0]||(l[0]=t=>e(a).name_en=t),rules:[e(p)],class:"flex-grow-1 mr-1",label:"Name"},null,8,["modelValue","rules"]),o(r,{"append-inner-icon":"tabler-package",modelValue:e(a).name_ar,"onUpdate:modelValue":l[1]||(l[1]=t=>e(a).name_ar=t),rules:[e(p)],class:"flex-grow-1 ml-1 text-right",dir:"rtl",label:"الاسم"},null,8,["modelValue","rules"])]),_:1}),o(m,{class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[o(i,{modelValue:e(a).description_en,"onUpdate:modelValue":l[2]||(l[2]=t=>e(a).description_en=t),rules:[e(p)],class:"flex-grow-1 mr-1",label:"Description"},null,8,["modelValue","rules"]),o(i,{modelValue:e(a).description_ar,"onUpdate:modelValue":l[3]||(l[3]=t=>e(a).description_ar=t),rules:[e(p)],class:"flex-grow-1 ml-1 text-right",dir:"rtl",label:"الوصف"},null,8,["modelValue","rules"])]),_:1}),e(u)=="admin"?(c(),b(m,{key:0,class:"mt-5",justify:"space-between",align:"center"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-coins",modelValue:e(a).price,"onUpdate:modelValue":l[4]||(l[4]=t=>e(a).price=t),rules:[e(p),e(L)],class:"flex-grow-1 mr-1",label:s.$t("Product Price")},null,8,["modelValue","rules","label"]),o(U,{"prepend-inner-icon":"tabler-bookmark",multiple:"","return-object":!1,items:e(w),"item-value":"id","item-title":"name_en",rules:[e(p)],modelValue:e(a).categories,"onUpdate:modelValue":l[5]||(l[5]=t=>e(a).categories=t),class:"flex-grow-1 ml-1 mt-6",label:s.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):y("",!0),e(u)=="admin"?(c(),b(m,{key:1,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:e(a).code,"onUpdate:modelValue":l[6]||(l[6]=t=>e(a).code=t),rules:[e(p)],class:"flex-grow-1 mr-1",label:s.$t("Product Code")},null,8,["modelValue","rules","label"]),o(r,{"prepend-inner-icon":"tabler-clock",modelValue:e(a).prep_time,"onUpdate:modelValue":l[7]||(l[7]=t=>e(a).prep_time=t),rules:[e(p)],class:"flex-grow-1 ml-1",label:s.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):y("",!0),e(u)=="admin"?(c(),b(m,{key:2,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[o(U,{"prepend-inner-icon":"tabler-package",multiple:"","return-object":!1,items:e(F),"item-value":"id","item-title":"name",modelValue:e(a).extra,"onUpdate:modelValue":l[8]||(l[8]=t=>e(a).extra=t),class:"flex-grow-1 ml-1 mt-3",label:s.$t("Select Extra")},null,8,["items","modelValue","label"]),o(U,{"prepend-inner-icon":"tabler-package","return-object":!1,items:e(j),"item-value":"id","item-title":"name",modelValue:e(a).flavor,"onUpdate:modelValue":l[9]||(l[9]=t=>e(a).flavor=t),class:"flex-grow-1 ml-1 mt-3",label:s.$t("Select Flavor")},null,8,["items","modelValue","label"]),o(r,{"prepend-inner-icon":"tabler-dna-2",modelValue:e(a).quantity,"onUpdate:modelValue":l[10]||(l[10]=t=>e(a).quantity=t),rules:[e(p)],class:"flex-grow-1 ml-1 mt-3",placeholder:s.$t("Quantity")},null,8,["modelValue","rules","placeholder"])]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1}),o(f,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[k("p",de,$(s.$t("Images")),1),o(m,null,{default:n(()=>[o(f,null,{default:n(()=>[o(m,{class:"px-5"},{default:n(()=>[(c(!0),N(Q,null,W(e(g),t=>(c(),N("div",null,[k("div",me,[o(P,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:fe=>z(t)},null,8,["onClick"]),o(Z,{"prepend-icon":"tabler-camera",src:t.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),o(ie,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:s.$t("Upload image"),modelValue:e(v),"onUpdate:modelValue":l[11]||(l[11]=t=>K(v)?v.value=t:null),onChange:E},null,8,["label","modelValue"])]),_:1})]),_:1}),e(u)=="admin"?(c(),b(f,{key:0,class:"mt-2"},{default:n(()=>[o(x,{modelValue:e(a).is_active,"onUpdate:modelValue":l[12]||(l[12]=t=>e(a).is_active=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Active")},null,8,["modelValue","label"]),o(x,{modelValue:e(a).has_image,"onUpdate:modelValue":l[13]||(l[13]=t=>e(a).has_image=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Need Image")},null,8,["modelValue","label"]),o(x,{modelValue:e(a).has_note,"onUpdate:modelValue":l[14]||(l[14]=t=>e(a).has_note=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Need Note")},null,8,["modelValue","label"]),o(x,{modelValue:e(a).is_pre,"onUpdate:modelValue":l[15]||(l[15]=t=>e(a).is_pre=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Is Pre")},null,8,["modelValue","label"])]),_:1})):y("",!0),o(m,{class:"px-5 mt-2"},{default:n(()=>[o(X,{color:"primary",loading:e(V),type:"submit",block:""},{default:n(()=>[o(P,{start:"",icon:"tabler-plus"}),Y($(s.$t("Add")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}};typeof S=="function"&&S(pe);export{pe as default};
