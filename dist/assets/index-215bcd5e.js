import{D as ue,O as B,l as m,R as me,o as C,b as A,w as d,q as i,s as a,G as le,U as I,A as se,I as Ve,b5 as oe,b6 as X,C as ke,c as xe,H as O,az as M,y as W,W as ae,t as f,aY as g,aZ as de,a6 as Ce,a_ as Pe,a8 as je,a9 as Re,n as Se}from"./index-ff119983.js";import{V as Ue}from"./VDataTable-bc707c71.js";import{V as Oe}from"./VPagination-c67e0355.js";import{_ as Be}from"./AppDateTimePicker-b76d694a.js";import{a as Ie}from"./branches-8ecfa874.js";import{g as Ae}from"./deliveries-eff4805d.js";import{g as De}from"./areas-8d1f0ccf.js";import{g as Ee}from"./agents-0716c08f.js";import{a as Te}from"./products-971f4d59.js";import{g as ze}from"./categories-11a4914d.js";import{a as K}from"./stats-4563f9e1.js";import{g as Ne,a as Fe}from"./deliveries-f2369493.js";import{g as _e,a as qe,b as Le,c as Me,d as We,e as Ke,f as Ge,h as He,i as Je}from"./agents-a849fb10.js";import{g as G,d as H,e as J,f as Q}from"./stats-4b42aaf9.js";import{g as Qe}from"./branches-ee35dae1.js";import{g as Ye}from"./deliveries-10343bc7.js";import{g as Ze}from"./branches-2bbdc0c9.js";import{g as Xe}from"./deliveries-a3a14271.js";import{g as et}from"./areas-c698ddd9.js";import{g as tt}from"./products-0160781a.js";import{V as at,a as lt}from"./VTabs-056d4444.js";import{V as st}from"./VSpacer-20feb7a0.js";import{V as ot,a as rt}from"./VWindowItem-3cebff1f.js";import{V as w}from"./VCombobox-378f9976.js";import"./VCheckboxBtn-043d95b9.js";import"./VSelectionControl-16166eb0.js";import"./VSelect-a49af761.js";import"./VList-565b818c.js";import"./ssrBoot-05ebc2b2.js";import"./VDivider-856000c4.js";import"./dialog-transition-17577805.js";import"./VMenu-acb5fd2d.js";import"./VOverlay-40fd52dc.js";import"./lazy-bade2ea5.js";import"./VChip-b76c50ca.js";import"./filter-46ce1e41.js";import"./VTable-4b8a39db.js";const it={__name:"ProductCategoryReport",props:{filters:{type:Object,default:{}},reports:{type:Array,default:[]},meta:{type:Object,default:{}},gettingReports:{type:Boolean,default:!1},hasProducts:{type:Boolean,default:!1}},setup($,{emit:P}){const c=$,y=ue().t,D=B(()=>[{title:y("Order ID"),key:"id",width:"200px"},{title:y("Branch"),sortable:!1,key:"branch",width:"200px"},{title:y("Area"),sortable:!1,key:"area",width:"200px"},{title:y("Product"),sortable:!1,key:"first_product",width:"200px"},{title:y("Price"),sortable:!1,key:"price",width:"200px"},{title:y("Quantity"),sortable:!1,key:"quantity",width:"200px"},{title:y("Total Amount"),sortable:!1,key:"total_amount",width:"200px"},{title:y("Created By"),sortable:!1,key:"created_by",width:"200px"}]),V=m(),Y=()=>{P("update-sort-by",V.value)},Z=h=>{P("update-page-n",h)};return me(()=>{}),(h,k)=>(C(),A(Ve,{elevation:"0",class:"px-0 mb-0 pb-0 mt-5 pt-3",loading:$.gettingReports},{default:d(()=>[i(a(Ue),{"sort-by":a(V),"onUpdate:sortBy":[k[1]||(k[1]=j=>le(V)?V.value=j:null),Y],items:$.reports,headers:a(D),"items-per-page":15},{bottom:d(()=>[i(I,{class:"mt-3 mb-0 pb-0 mx-0",align:"center",justify:"end"},{default:d(()=>[c.meta.total?(C(),A(Oe,{key:0,"total-visible":"5",modelValue:c.meta.current_page,"onUpdate:modelValue":[k[0]||(k[0]=j=>c.meta.current_page=j),Z],length:Math.ceil(c.meta.total/c.meta.per_page),disabled:c.gettingReports,size:35},null,8,["modelValue","length","disabled"])):se("",!0)]),_:1})]),_:1},8,["sort-by","items","headers"])]),_:1},8,["loading"]))}};function nt(){return oe.get("/operation/products?hasExtra")}let{get:dt,show:ea,update:ta,create:aa,remove:la}=X("/operation/categories");function ut(){return oe.get("/logistic/products?hasExtra")}let{get:mt,show:sa,update:oa,create:ra,remove:ia}=X("/logistic/categories");function pt(){return oe.get("/finance/products?hasExtra")}let{get:ct,show:na,update:da,create:ua,remove:ma}=X("/finance/categories"),{get:ft,show:pa,update:ca,create:fa,remove:ya}=X("/agent/categories");const yt=$=>(je("data-v-faf23ca8"),$=$(),Re(),$),gt=yt(()=>Se("p",{class:"text-h4 pt-3 pb-0 mb-3 px-3"},"Products And Categories",-1)),pe={__name:"index",setup($){const P=ue(),c=P.t,r=JSON.parse(localStorage.getItem("userData")).type,y=B(()=>{if(P.locale.value==="en")return"name_en";if(P.locale.value==="ar")return"name_ar"}),D=m(0),V=m([]),Y=m([]),Z=m([]),h=m([]),k=m([]),j=m([]),re=m([]),ie=m(),v=m(!1),R=m(!1),ee=m(!1),S=m("reports"),o=m({branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[],orderId:""}),E=B(()=>o.value.product.length==h.value.length),ce=m([{name:c("Created"),value:"created"},{name:c("Paid"),value:"paid"},{name:c("In Progress"),value:"in_progress"},{name:c("Ready For Delivery"),value:"ready_for_delivery"},{name:c("On The Way"),value:"on_the_way"},{name:c("Delivered"),value:"delivered"},{name:c("Cancelled"),value:"cancelled"}]),fe=m([{name:"Knet",value:"knet"},{name:"Bookey",value:"bookey"},{name:"Credit Card",value:"credit_card"}]),U=m(),ye=e=>{if(v.value=!0,R.value===!0){const t=new FormData,l=x().filters;Object.keys(l).includes("status")&&(Object.keys(l).includes("from")||Object.keys(l).includes("to"))&&(l.status.forEach(p=>{let s=te(p);l.from&&t.append(`${s}From`,l.from),l.to&&t.append(`${s}To`,l.to)}),l==null||delete l.status,l==null||delete l.from,l==null||delete l.to),E.value==!0&&(delete l.product,t.append("allProducts","")),Object.entries(l).forEach(([p,s])=>{t.append(p,s)}),t.append("page",e),t.append("limit",15);const u=new URLSearchParams(t).toString();v.value=!0,R.value=!0,r=="admin"?n(K,u):r=="agent"?n(G,u):r=="finance"?n(H,u):r=="logistic"?n(J,u):r=="operation"&&n(Q,u)}else{const t=new URLSearchParams({page:e,limit:15,sortBy:U.value??""}).toString();r=="admin"?n(K,t):r=="agent"?n(G,t):r=="finance"?n(H,t):r=="logistic"?n(J,t):r=="operation"&&n(Q,t)}},ge=e=>{U.value=e},T=e=>{e().then(({data:t})=>{V.value=t.data})},z=e=>{e().then(({data:t})=>{re.value=t.data})},N=e=>{e().then(({data:t})=>{j.value=t.data})},n=(e,t="allProducts")=>{v.value=!0,e(t).then(({data:l})=>{ie.value=l.meta,k.value=l.data}).finally(()=>{v.value=!1})},F=e=>{e().then(({data:t})=>{Z.value=t.data})},_=e=>{e().then(({data:t})=>{Y.value=t.data})},q=e=>{e().then(({data:t})=>{h.value=t.data})},x=()=>{let e={};return Object.entries(o.value).forEach(([t,l])=>{l!==null&&l.length&&(e[t]=l)}),{filters:e}},ne=()=>{if(o.value.product.length==h.value.length)o.value.product=[];else{let e=h.value.map(t=>t.id).filter(t=>!o.value.product.includes(t));o.value.product.push(...e)}},te=e=>e.replace(/_([a-z])/g,function(t,l){return l.toUpperCase()}),ve=e=>{const t=new FormData;t.append("page",1),t.append("limit",15),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(u=>{let p=te(u);e.from&&t.append(`${p}From`,e.from),e.to&&t.append(`${p}To`,e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),E.value==!0&&(delete e.product,t.append("allProducts","")),Object.entries(e).forEach(([u,p])=>{t.append(u,p)});const l=new URLSearchParams(t).toString();v.value=!0,R.value=!0,r=="admin"?n(K,l):r=="agent"?n(G,l):r=="finance"?n(H,l):r=="logistic"?n(J,l):r=="operation"&&n(Q,l)},be=()=>{R.value=!1,o.value={branch:[],status:[],delivery:[],from:[],to:[],agent:[],area:[],payment:[],category:[],product:[]},r=="admin"?n(K):r=="agent"?n(G):r=="finance"?n(H):r=="logistic"?n(J):r=="operation"&&n(Q)},$e=()=>{let e={};U.value!==void 0&&U.value.length>0&&(e["sortBy[]"]=`${U.value[0].order}-${U.value[0].key}`);const t=x().filters;Object.entries(t).forEach(([u,p])=>{e[u]=p}),Object.keys(e).includes("status")&&(Object.keys(e).includes("from")||Object.keys(e).includes("to"))&&(e.status.forEach(u=>{let p=te(u);e.from&&(e[`${p}From`]=e.from),e.to&&(e[`${p}To`]=e.to)}),e==null||delete e.status,e==null||delete e.from,e==null||delete e.to),E.value==!0&&(delete e.product,e.allProducts=""),ee.value=!0;const l=new URLSearchParams(e).toString();Ce.get(`${r!=="admin"?`/${r}`:""}/stats/custom?export${l.length?"&"+l:l}`,{responseType:"arraybuffer"}).then(u=>{const p=new Blob([u.data],{type:"application/vnd.ms-excel"}),s=window.URL.createObjectURL(p),L=document.createElement("a");L.href=s,L.setAttribute("download","custom-report.xlsx"),document.body.appendChild(L),L.click(),document.body.removeChild(L)}).finally(()=>{ee.value=!1})},he=B(()=>Object.keys(x().filters)),we=B(()=>(Object.keys(x().filters).includes("product")||Object.keys(x().filters).includes("category"))&&R.value===!0&&v.value===!1),b=B(()=>(D.value+=1,o.value.product.length===0&&o.value.category.length===0));return me(()=>{r=="admin"?(n(K),z(De),F(Ie),T(Ae),N(Ee),q(Te),_(ze)):r=="finance"?(n(H),z(_e),F(qe),T(Le),N(Me),q(pt),_(ct)):r=="operation"?(n(Q),z(We),F(Ne),T(Fe),N(Ke),q(nt),_(dt)):r=="logistic"?(n(J),z(Ge),F(Qe),T(Ye),N(He),q(ut),_(mt)):r=="agent"&&(n(G),z(et),F(Ze),T(Xe),N(Je),q(tt),_(ft))}),(e,t)=>{const l=Pe,u=Be,p=it;return C(),xe("div",null,[i(I,{class:"mx-0 my-0"},{default:d(()=>[i(at,{modelValue:a(S),"onUpdate:modelValue":t[0]||(t[0]=s=>le(S)?S.value=s:null),class:"mx-auto v-tabs-pill"},{default:d(()=>[i(lt,{value:"items"},{default:d(()=>[O("Items")]),_:1})]),_:1},8,["modelValue"]),i(st),i(M,{"prepend-icon":"tabler-upload",color:"success",class:"mr-3",onClick:$e,loading:a(ee)},{default:d(()=>[O(W(e.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),i(rt,{modelValue:a(S),"onUpdate:modelValue":t[13]||(t[13]=s=>le(S)?S.value=s:null)},{default:d(()=>[i(ot,{value:"items",class:"py-7"},{default:d(()=>[i(ae,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-5"},{default:d(()=>[gt,i(I,{class:f({"flex-column":e.$vuetify.display.xs})},{default:d(()=>[i(ae,{cols:"12",class:"pe-0 v-col-sm-12 v-col-md-10 v-col-lg-10"},{default:d(()=>[i(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[i(w,{"prepend-inner-icon":"tabler-package",modelValue:a(o).product,"onUpdate:modelValue":t[1]||(t[1]=s=>a(o).product=s),multiple:"",items:a(h),"item-value":"id","item-title":"name_en","return-object":!1,placeholder:e.$t("Select a Product"),class:f(["mx-2 flex-grow-1 products",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},{"prepend-item":d(()=>[a(E)?se("",!0):(C(),A(M,{key:0,block:"",elevation:"0",text:"",color:"transparent",onClick:ne},{default:d(()=>[O(W(e.$t("Select All")),1)]),_:1})),a(E)?(C(),A(M,{key:1,block:"",elevation:"0",text:"",color:"transparent",onClick:ne},{default:d(()=>[O(W(e.$t("Unselect All")),1)]),_:1})):se("",!0)]),_:1},8,["modelValue","items","placeholder","class","style"]),i(w,{"prepend-inner-icon":"tabler-bookmark",multiple:"",modelValue:a(o).category,"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).category=s),items:a(Y),"item-value":"id","item-title":"name_en","return-object":!1,placeholder:e.$t("Select a Category"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","items","placeholder","class","style"]),i(l,{placeholder:"Order Number","prepend-inner-icon":"tabler-number",class:"flex-grow-1",modelValue:a(o).orderId,"onUpdate:modelValue":t[3]||(t[3]=s=>a(o).orderId=s),disabled:a(b)},null,8,["modelValue","disabled"])]),_:1}),i(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[i(w,{"prepend-inner-icon":"tabler-user",modelValue:a(o).agent,"onUpdate:modelValue":t[4]||(t[4]=s=>a(o).agent=s),disabled:a(b),multiple:"",items:a(j),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select an Agent"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),i(w,{"prepend-inner-icon":"tabler-truck-delivery",multiple:"",modelValue:a(o).delivery,"onUpdate:modelValue":t[5]||(t[5]=s=>a(o).delivery=s),disabled:a(b),items:a(V),"item-value":"id","item-title":"name","return-object":!1,placeholder:e.$t("Select a Delivery"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),(C(),A(u,{modelValue:a(o).from,"onUpdate:modelValue":t[6]||(t[6]=s=>a(o).from=s),placeholder:e.$t("From"),disabled:a(b),key:a(D),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","placeholder","disabled","class","style"])),(C(),A(u,{modelValue:a(o).to,"onUpdate:modelValue":t[7]||(t[7]=s=>a(o).to=s),placeholder:e.$t("To"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":""),disabled:a(b),key:a(D)},null,8,["modelValue","placeholder","class","style","disabled"]))]),_:1}),i(I,{class:"ps-lg-1 pe-lg-0 ps-md-1 pe-md-0 ps-sm-1 pe-sm-0 mx-0 w-100 mt-3 pe-0",align:"center",justify:"space-between"},{default:d(()=>[i(w,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:a(o).branch,"onUpdate:modelValue":t[8]||(t[8]=s=>a(o).branch=s),disabled:a(b),items:a(Z),"item-title":a(y),"return-object":!1,"item-value":"id",placeholder:e.$t("Select a Branch"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","item-title","placeholder","class","style"]),i(w,{"prepend-inner-icon":"tabler-building-store",multiple:"",modelValue:a(o).area,"onUpdate:modelValue":t[9]||(t[9]=s=>a(o).area=s),disabled:a(b),items:a(re),"item-title":"name_en","return-object":!1,"item-value":"name_en",placeholder:e.$t("Select an Area"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),i(w,{"prepend-inner-icon":"tabler-activity-heartbeat",multiple:"",modelValue:a(o).status,"onUpdate:modelValue":t[10]||(t[10]=s=>a(o).status=s),disabled:a(b),items:a(ce),"item-title":"name","item-value":"value","return-object":!1,placeholder:e.$t("Select a Status"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"]),i(w,{"prepend-inner-icon":"tabler-activity-heartbeat","return-object":!1,multiple:"",modelValue:a(o).payment,"onUpdate:modelValue":t[11]||(t[11]=s=>a(o).payment=s),disabled:a(b),items:a(fe),"item-title":"name","item-value":"value",placeholder:e.$t("Select a Payment Method"),class:f(["mx-2 flex-grow-1",{"w-100 mt-3":e.$vuetify.display.xs,"my-2":!e.$vuetify.display.xs}]),style:g(e.$vuetify.display.xs?"width: 100%;":"")},null,8,["modelValue","disabled","items","placeholder","class","style"])]),_:1})]),_:1}),i(ae,{cols:"12",class:"mt-2 v-col-sm-12 v-col-md-2 v-col-lg-2"},{default:d(()=>[i(M,{class:"mx-0",block:"",variant:"tonal",color:"warning","prepend-icon":"tabler-x",onClick:be,disabled:a(v)||!a(R)},{default:d(()=>[O(W(e.$t("Reset")),1)]),_:1},8,["disabled"]),i(M,{class:"mx-0 mt-5",block:"",variant:"tonal",color:"success","prepend-icon":"tabler-search",onClick:t[12]||(t[12]=s=>ve(x().filters)),disabled:!a(he).length||a(v)},{default:d(()=>[O(W(e.$t("Search")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"]),i(p,{hasProducts:a(we),gettingReports:a(v),meta:a(ie),reports:a(k),filters:x(),onUpdateSortBy:ge,onUpdatePageN:ye},null,8,["hasProducts","gettingReports","meta","reports","filters"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};typeof de=="function"&&de(pe);const ga=ke(pe,[["__scopeId","data-v-faf23ca8"]]);export{ga as default};
