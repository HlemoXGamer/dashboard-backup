import{D as O,O as G,aV as H,aP as J,l as i,R as L,o as c,b as x,w as s,q as a,a$ as X,b0 as Z,W as d,n as k,y as b,s as o,G as C,H as I,I as K,aX as Q,c as $,F as Y,a as ee,U as V,z as B,b4 as ae,A as te,az as le,aZ as N,aW as se,a_ as ne}from"./index-36d8cfe3.js";import{a as oe,s as re}from"./categories-9dcfae31.js";import{g as ue}from"./products-3563803e.js";import{u as ie,s as de}from"./categories-11c10d5b.js";import{g as me}from"./products-e8ef94ca.js";import{t as pe}from"./files-2e167225.js";import{V as ce,a as D}from"./VTabs-7ea26e8f.js";import{a as fe,V as P}from"./VWindowItem-f9a8d930.js";import{V as R}from"./VCheckbox-06ebf408.js";import{V as ge}from"./VFileInput-5bfb7586.js";import{V as ve}from"./VSwitch-b0e69358.js";import"./lazy-7047357e.js";import"./ssrBoot-9eeea15f.js";import"./VCheckboxBtn-a58c2dae.js";import"./VSelectionControl-0b7649e7.js";import"./VChip-8213b9b6.js";const _e={class:"text-h4 pt-5 pb-2"},be={class:"text-h4 pt-5 pb-2"},Ve={class:"text-h4 pt-3 pb-2 px-3"},ye={key:0,class:"position-relative"},he={__name:"[id]",setup(we){var T;const y=O();y.t;const U=G(()=>{if(y.locale.value==="en")return"name_en";if(y.locale.value==="ar")return"name_ar"}),h=H(),g=J().params.id,v=i(!1),m=i(0),_=i([]),F=i(),l=i({is_active:0,name_en:"",name_ar:"",product:[],image:""}),u=i([]),f=i([]),p=(T=JSON.parse(localStorage.getItem("userData")))==null?void 0:T.type,A=async e=>{if(e instanceof File){let t=await pe(e);l.value.image=e,f.value=t}},W=async()=>{await A(_.value.pop())},w=i([]),j=async()=>{p=="admin"?await ue().then(e=>{w.value=e.data.data}):p=="markter"&&await me().then(e=>{w.value=e.data.data})},S=e=>{u.value.includes(e)?u.value=u.value.filter(t=>t!==e):u.value.push(e)},q=async()=>{var e;(e=F.value)==null||e.validate().then(async({valid:t})=>{if(t){v.value=!0;try{const r=new FormData;r.append("name_en",l.value.name_en),r.append("name_ar",l.value.name_ar),r.append("is_active",l.value.is_active),u.value?r.append("products",u.value):r.append("products",""),r.append("image",l.value.image),p=="admin"?await oe(g,r):p=="markter"&&await ie(g,r),h.success("Category updated successfully"),v.value=!1,se.back()}catch(r){h.error(r.response.data.message),v.value=!1}}})},z=async()=>{try{let e;p=="admin"?(e=await re(g).then(({data:t})=>t),l.value.name_en=e.data.name_en,l.value.name_ar=e.data.name_ar,l.value.is_active=e.data.is_active,l.value.image=e.data.image,f.value=e.data.image,l.value.products=e.data.products):p=="markter"&&(e=await de(g).then(({data:t})=>t),l.value.name_en=e.data.name_en,l.value.name_ar=e.data.name_ar,l.value.is_active=e.data.is_active,l.value.image=e.data.image,f.value=e.data.image,l.value.products=e.data.products),u.value=e.data.products.map(t=>t.id)}catch(e){h.error(e.response.data.message)}},E=e=>{l.value.image="",f.value=""};return L(()=>{j(),z()}),(e,t)=>{const r=ne;return c(),x(V,{class:"mt-4 px-1",justify:"space-around"},{default:s(()=>[a(X,{ref_key:"refVForm",ref:F,onSubmit:Z(q,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:s(()=>[a(d,{cols:"8",class:"pt-0"},{default:s(()=>[a(d,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded px-7 pt-2"},{default:s(()=>[k("p",_e,b(e.$t("Update Category")),1),a(d,{class:"px-2 pt-0"},{default:s(()=>[a(ce,{modelValue:o(m),"onUpdate:modelValue":t[0]||(t[0]=n=>C(m)?m.value=n:null),class:"v-tabs-pill"},{default:s(()=>[a(D,null,{default:s(()=>[I("English")]),_:1}),a(D,null,{default:s(()=>[I("Arabic")]),_:1})]),_:1},8,["modelValue"]),a(K,{class:"pt-0 mt-0",style:{"background-color":"transparent","box-shadow":"none"}},{default:s(()=>[a(Q,null,{default:s(()=>[a(fe,{modelValue:o(m),"onUpdate:modelValue":t[3]||(t[3]=n=>C(m)?m.value=n:null)},{default:s(()=>[a(P,null,{default:s(()=>[a(r,{"prepend-inner-icon":"tabler-writing",rules:[e.requiredValidator],modelValue:o(l).name_en,"onUpdate:modelValue":t[1]||(t[1]=n=>o(l).name_en=n),class:"flex-grow-1 mr-1",label:"Name"},null,8,["rules","modelValue"])]),_:1}),a(P,null,{default:s(()=>[a(r,{"append-inner-icon":"tabler-writing",rules:[e.requiredValidator],modelValue:o(l).name_ar,"onUpdate:modelValue":t[2]||(t[2]=n=>o(l).name_ar=n),class:"flex-grow-1 ml-1 text-right",dir:"rtl",label:"الاسم"},null,8,["rules","modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(d,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded px-7 pt-2 mt-5"},{default:s(()=>[k("p",be,b(e.$t("Products")),1),a(d,{class:"px-2 pt-0"},{default:s(()=>[(c(!0),$(Y,null,ee(o(w),n=>(c(),$("div",null,[o(u).includes(n.id)?(c(),x(R,{label:n[o(U)],"model-value":!0,onChange:M=>S(n.id),key:n.id},null,8,["label","onChange"])):(c(),x(R,{key:1,label:n[o(U)],onChange:M=>S(n.id)},null,8,["label","onChange"]))]))),256))]),_:1})]),_:1})]),_:1}),a(d,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:s(()=>[k("p",Ve,b(e.$t("Images")),1),a(V,null,{default:s(()=>[a(d,null,{default:s(()=>[a(V,{class:"px-5"},{default:s(()=>[o(l).image?(c(),$("div",ye,[a(B,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:t[4]||(t[4]=n=>E())}),a(ae,{"prepend-icon":"tabler-camera",src:o(f),width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])):te("",!0)]),_:1}),a(ge,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:e.$t("Upload image"),modelValue:o(_),"onUpdate:modelValue":t[5]||(t[5]=n=>C(_)?_.value=n:null),onChange:W},null,8,["label","modelValue"])]),_:1})]),_:1}),a(d,{class:"mt-2"},{default:s(()=>[a(ve,{modelValue:o(l).is_active,"onUpdate:modelValue":t[6]||(t[6]=n=>o(l).is_active=n),"false-value":0,"true-value":1,inset:!1,label:e.$t("Active")},null,8,["modelValue","label"])]),_:1}),a(V,{class:"px-5 mt-2"},{default:s(()=>[a(le,{type:"submit",color:"primary",block:"",loading:o(v)},{default:s(()=>[a(B,{start:"",icon:"tabler-check"}),I(b(e.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}};typeof N=="function"&&N(he);export{he as default};
