import{_ as W}from"./AppDateTimePicker-ea2a4526.js";import{_ as F}from"./DialogCloseBtn-513e4898.js";import{g as I}from"./stats-e4bb8cc2.js";import{l as n,D as L,O as M,R as N,o as V,c as _,q as t,w as s,I as z,aX as U,s as o,G as x,az as k,H as w,y as v,a1 as $,n as y,F as Y,a as q,aY as G,a2 as H,aZ as j,Y as X}from"./index-581c2083.js";import{V as Z}from"./VDialog-9c77a5f1.js";import{V as B}from"./VSpacer-78f2ea51.js";import{V as J}from"./VSelect-91e75b33.js";import{V as K}from"./VDataTable-06e6a8ff.js";import"./VOverlay-b3d70df2.js";import"./lazy-e0bc52de.js";import"./dialog-transition-e2ab3ff7.js";import"./VList-800b0139.js";import"./ssrBoot-f2e19377.js";import"./VDivider-007f86e5.js";import"./VMenu-568d971d.js";import"./VCheckboxBtn-36803dae.js";import"./VSelectionControl-6e42f01a.js";import"./VChip-2cd4c1fb.js";import"./filter-887944dd.js";import"./VTable-db7fafcb.js";const Q={class:"text-h4 ps-3"},ee={style:{"min-height":"600px",border:"5px solid rgb(var(--v-theme-primary))"},class:"rounded w-100 px-5 py-5"},te={class:"text-h5 text-center px-0 py-0 mx-0 my-3 font-weight-bold text-uppercase"},ae={class:"text-white py-0 mx-0 my-0 px-0 text-center font-weight-bold"},le={class:"text-h4 mt-12 ps-1"},oe={__name:"index",setup(se){const g=n(!1),m=n(null),p=n(null),u=n("today"),d=n({export:!1,search:!1}),f=L().t,E=[{title:f("Custom"),value:"custom"},{title:f("This Month"),value:"month"},{title:f("This Week"),value:"week"},{title:f("Today"),value:"today"}],O=M(()=>[{title:f("Status"),key:"stats"},{title:f("Clicks"),key:"value"},{title:f("Average Time"),key:"avg_time"}]),h=n([]),S=n([]),C=n({page_view:{value:"Page View",color:"#ff5800"},category_view:{value:"Category View",color:"#f7ab00"},product_view:{value:"Product View",color:"#009912"},add_to_cart:{value:"Add To Cart",color:"#006499"},address_details:{value:"Address Details",color:"#009989"},purchase:{value:"Purchase",color:"#000099"}}),b=a=>{if(d.value.search=!0,a===!0){g.value=!1;let e=m.value,r=p.value;I(`${e!==null?"&from="+e:""}${r!==null?"&to="+r:""}`).then(({data:i})=>{h.value=i,D(i)}).finally(()=>{d.value.search=!1})}else I(`${u.value}`).then(({data:e})=>{h.value=e,D(e)}).finally(()=>{d.value.search=!1})},P=()=>{g.value=!1,u.value="today",m.value=n(),p.value=n(),b(!1)},A=()=>{setTimeout(()=>{u.value=="custom"?g.value=!0:b(!1)},100)},R=async()=>{let a=m.value,e=p.value;d.value.export=!0;try{await X.get(`/google-analytics/?${u.value}${a!==null?"&from="+a:""}${e!==null?"&to="+e:""}&export`,{responseType:"arraybuffer"}).then(r=>{const i=new Blob([r.data],{type:"application/vnd.ms-excel"}),l=window.URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.setAttribute("download",`statistics-analytics-report-${u.value}.xlsx`),document.body.appendChild(c),c.click(),document.body.removeChild(c)})}catch(r){console.log(r)}finally{d.value.export=!1}},D=a=>{let e=[];Object.entries(a).forEach(([r,i])=>{e.push({stats:r.split("_").join(" ").toUpperCase(),value:i})}),S.value=e};return N(()=>{b()}),(a,e)=>{const r=F,i=W;return V(),_("div",null,[t(Z,{modelValue:o(g),"onUpdate:modelValue":e[4]||(e[4]=l=>x(g)?g.value=l:null),persistent:"",class:"v-dialog-sm"},{default:s(()=>[t(r,{onClick:e[0]||(e[0]=l=>P())}),t(z,{title:"Pick a custom Date"},{default:s(()=>[t(U,{class:"d-flex"},{default:s(()=>[t(i,{class:"me-1",placeholder:a.$t("From"),"prepend-inner-icon":"tabler-calendar",modelValue:o(m),"onUpdate:modelValue":e[1]||(e[1]=l=>x(m)?m.value=l:null),config:{maxDate:new Date().toISOString()}},null,8,["placeholder","modelValue","config"]),t(i,{class:"ms-1",placeholder:a.$t("To"),"prepend-inner-icon":"tabler-calendar",modelValue:o(p),"onUpdate:modelValue":e[2]||(e[2]=l=>x(p)?p.value=l:null),config:{minDate:new Date().toISOString()}},null,8,["placeholder","modelValue","config"])]),_:1}),t(U,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[t(k,{onClick:e[3]||(e[3]=l=>b(!0)),loading:o(d).search,disabled:!o(m)&&!o(p)},{default:s(()=>[w(v(a.$t("Pick")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(H,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded pb-10"},{default:s(()=>[t($,{class:"mx-0 my-0 pb-0 px-0 pt-3"},{default:s(()=>[y("p",Q,v(a.$t("Website State")),1),t(B),t(k,{"prepend-icon":"tabler-upload",loading:o(d).export,color:"success",class:"mr-3",onClick:R},{default:s(()=>[w(v(a.$t("Export Excel")),1)]),_:1},8,["loading"])]),_:1}),t($,{class:"mx-0 py-0 px-4 py-5 mt-1"},{default:s(()=>[t(J,{items:E,"item-value":"value","item-title":"title","model-value":"today",label:a.$t("Select a period of time"),"prepend-inner-icon":"tabler-clock",modelValue:o(u),"onUpdate:modelValue":e[5]||(e[5]=l=>x(u)?u.value=l:null)},null,8,["label","modelValue"]),t(k,{class:"ms-2",loading:o(d).search,onClick:e[6]||(e[6]=l=>A())},{default:s(()=>[w(v(a.$t("Search")),1)]),_:1},8,["loading"]),t(B)]),_:1}),t($,{class:"mx-0 my-0 px-4 mt-5"},{default:s(()=>[y("div",ee,[(V(!0),_(Y,null,q(o(h),(l,c)=>{var T;return V(),_("div",{key:a.i},[y("p",te,v(o(C)[c].value),1),y("div",{style:G({"background-color":(T=o(C)[c])==null?void 0:T.color,width:l>100?199:l+"%"}),class:"mt-0 mb-4 rounded-lg py-3 px-3 mx-auto d-flex align-center justify-center"},[y("p",ae,v(l),1)],4)])}),128))]),y("p",le,v(a.$t("Website State")),1),t(o(K),{headers:o(O),items:o(S),class:"mt-1"},null,8,["headers","items"])]),_:1})]),_:1})])}}};typeof j=="function"&&j(oe);export{oe as default};
