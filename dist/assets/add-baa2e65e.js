import{_ as M}from"./AppTextarea-e6af4cf3.js";import{l as d,aV as O,R as W,o as c,b,w as n,q as r,a$ as G,b0 as H,W as f,n as k,y as $,U as m,s as e,b1 as p,b3 as J,A as x,c as N,F as L,a as Z,z as P,b4 as K,G as Q,az as X,H as Y,aZ as S,aW as ee,a_ as ae}from"./index-b5d24edb.js";import{g as le}from"./categories-750de633.js";import{c as te}from"./products-2c78de26.js";import{g as se,a as oe}from"./extra-flavors-d0f63a16.js";import{g as re}from"./categories-c7a4bf03.js";import{c as ne}from"./products-d58b16b1.js";import{t as A}from"./files-2e167225.js";import{V as U}from"./VCombobox-8607af61.js";import{V as ie}from"./VFileInput-2aedd89c.js";import{V as y}from"./VSwitch-6fbde25e.js";import"./VSelect-0e70c656.js";import"./VList-837b200a.js";import"./ssrBoot-de7228ad.js";import"./VDivider-d07c9055.js";import"./dialog-transition-bca0bf81.js";import"./VMenu-7ff4824f.js";import"./VOverlay-a7019e8a.js";import"./lazy-bc0e50cc.js";import"./VCheckboxBtn-f0cfd993.js";import"./VSelectionControl-8c9886a9.js";import"./VChip-240a7907.js";import"./filter-72a3eb0c.js";const ue={class:"text-h4 pt-3 pb-2 px-3"},de={class:"text-h4 pt-3 pb-2 px-3"},me={class:"position-relative"},pe={__name:"add",setup(ce){var C;const v=d([]),g=d([]),h=O(),V=d(!1),w=d([]),F=d([]),j=d([]),u=(C=JSON.parse(localStorage.getItem("userData")))==null?void 0:C.type,a=d({code:"",created_at:"",categories:[],description_ar:"",description_en:"",has_image:0,has_note:0,images:"",is_active:0,name_ar:"",name_en:"",prep_time:"",price:"",status:0,extras:[],flavors:[],extra_quantity:1,is_pre:0}),I=d(),_=d([]),E=async s=>{if(s instanceof File){let l=await A(s);g.value.push({id:null,url:l}),_.value.push(s)}},B=async()=>{await E(v.value.pop())},q=async()=>{var s;(s=I.value)==null||s.validate().then(async({valid:l})=>{if(l){V.value=!0;let o=new FormData;o.append("code",a.value.code),o.append("categories",a.value.categories),o.append("description_ar",a.value.description_ar),o.append("description_en",a.value.description_en),o.append("has_image",a.value.has_image),o.append("has_note",a.value.has_note),o.append("is_active",a.value.is_active),o.append("name_ar",a.value.name_ar),o.append("name_en",a.value.name_en),o.append("prep_time",a.value.prep_time),o.append("price",a.value.price),o.append("status",a.value.status),o.append("is_pre",a.value.is_pre),a.value.extras.concat(a.value.flavors).forEach((i,t)=>{o.append(`extra_flavors[${t}]`,i)}),o.append("quantity",a.value.extra_quantity),_.value.forEach((i,t)=>{o.append(`images[${t}]`,i)});try{u=="admin"?await te(o):await ne(o),h.success("Product added successfully"),V.value=!1,ee.back()}catch(i){h.error(i.response.data.message),V.value=!1}}})},D=()=>{u=="admin"?le().then(({data:s,meta:l})=>{w.value=s.data}):u=="markter"&&re().then(({data:s,meta:l})=>{w.value=s.data})},T=()=>{u=="admin"&&se().then(({data:s,meta:l})=>{j.value=s.data})},R=()=>{u=="admin"&&oe().then(({data:s,meta:l})=>{F.value=s.data})},z=async s=>{const l=g.value.indexOf(g.value.filter(o=>o.url==s.url)[0]);l!==-1&&g.value.splice(l,1),_.value.forEach(async o=>{o instanceof File&&await A(o).then(i=>{i==s.url&&_.value.splice(o,1)})})};return W(()=>{D(),T(),R()}),(s,l)=>{const o=ae,i=M;return c(),b(m,{class:"mt-4 px-4",justify:"space-around"},{default:n(()=>[r(G,{ref_key:"refVForm",ref:I,onSubmit:H(q,["prevent"]),class:"w-100 d-flex justify-content-between"},{default:n(()=>[r(f,{cols:"8",class:"pt-0"},{default:n(()=>[r(f,{class:"px-5 rounded pb-10",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:n(()=>[k("p",ue,$(s.$t("Add Product")),1),r(f,{class:"px-5"},{default:n(()=>[r(m,{justify:"space-between",align:"start"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-package",modelValue:e(a).name_en,"onUpdate:modelValue":l[0]||(l[0]=t=>e(a).name_en=t),rules:[e(p)],class:"flex-grow-1 me-1",label:"Name"},null,8,["modelValue","rules"]),r(o,{"append-inner-icon":"tabler-package",modelValue:e(a).name_ar,"onUpdate:modelValue":l[1]||(l[1]=t=>e(a).name_ar=t),rules:[e(p)],class:"flex-grow-1 ms-1 text-right",dir:"rtl",label:"الاسم"},null,8,["modelValue","rules"])]),_:1}),r(m,{class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[r(i,{modelValue:e(a).description_en,"onUpdate:modelValue":l[2]||(l[2]=t=>e(a).description_en=t),rules:[e(p)],class:"flex-grow-1 me-1",label:"Description"},null,8,["modelValue","rules"]),r(i,{modelValue:e(a).description_ar,"onUpdate:modelValue":l[3]||(l[3]=t=>e(a).description_ar=t),rules:[e(p)],class:"flex-grow-1 ms-1 text-right",dir:"rtl",label:"الوصف"},null,8,["modelValue","rules"])]),_:1}),e(u)=="admin"?(c(),b(m,{key:0,class:"mt-5",justify:"space-between",align:"center"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-coins",modelValue:e(a).price,"onUpdate:modelValue":l[4]||(l[4]=t=>e(a).price=t),rules:[e(p),e(J)],class:"flex-grow-1 me-1",label:s.$t("Product Price")},null,8,["modelValue","rules","label"]),r(U,{"prepend-inner-icon":"tabler-bookmark",multiple:"","return-object":!1,items:e(w),"item-value":"id","item-title":"name_en",rules:[e(p)],modelValue:e(a).categories,"onUpdate:modelValue":l[5]||(l[5]=t=>e(a).categories=t),class:"flex-grow-1 ms-1 mt-6",label:s.$t("Select Category")},null,8,["items","rules","modelValue","label"])]),_:1})):x("",!0),e(u)=="admin"?(c(),b(m,{key:1,class:"mt-10",justify:"space-between",align:"start"},{default:n(()=>[r(o,{"prepend-inner-icon":"tabler-dna-2",modelValue:e(a).code,"onUpdate:modelValue":l[6]||(l[6]=t=>e(a).code=t),rules:[e(p)],class:"flex-grow-1 me-1",label:s.$t("Product Code")},null,8,["modelValue","rules","label"]),r(o,{"prepend-inner-icon":"tabler-clock",modelValue:e(a).prep_time,"onUpdate:modelValue":l[7]||(l[7]=t=>e(a).prep_time=t),rules:[e(p)],class:"flex-grow-1 ms-1",label:s.$t("Preparation Time")},null,8,["modelValue","rules","label"])]),_:1})):x("",!0),e(u)=="admin"?(c(),b(m,{key:2,class:"mt-10",justify:"space-between",align:"center"},{default:n(()=>[r(U,{"prepend-inner-icon":"tabler-package",multiple:"","return-object":!1,items:e(F),"item-value":"id","item-title":"name",modelValue:e(a).extras,"onUpdate:modelValue":l[8]||(l[8]=t=>e(a).extras=t),class:"flex-grow-1 ms-1 mt-3",label:s.$t("Select Extra")},null,8,["items","modelValue","label"]),r(U,{"prepend-inner-icon":"tabler-package","return-object":!1,items:e(j),multiple:"","item-value":"id","item-title":"name",modelValue:e(a).flavors,"onUpdate:modelValue":l[9]||(l[9]=t=>e(a).flavors=t),class:"flex-grow-1 ms-1 mt-3",label:s.$t("Select Flavor")},null,8,["items","modelValue","label"])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1}),r(f,{cols:"4",style:{"background-color":"rgb(var(--v-theme-surface))",height:"fit-content"},class:"rounded pb-10"},{default:n(()=>[k("p",de,$(s.$t("Images")),1),r(m,null,{default:n(()=>[r(f,null,{default:n(()=>[r(m,{class:"px-5"},{default:n(()=>[(c(!0),N(L,null,Z(e(g),t=>(c(),N("div",null,[k("div",me,[r(P,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:fe=>z(t)},null,8,["onClick"]),r(K,{"prepend-icon":"tabler-camera",src:t.url,width:"90px",style:{height:"90px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])])]))),256))]),_:1}),r(ie,{class:"px-2 mt-8",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",multiple:"",label:s.$t("Upload image"),modelValue:e(v),"onUpdate:modelValue":l[10]||(l[10]=t=>Q(v)?v.value=t:null),onChange:B},null,8,["label","modelValue"])]),_:1})]),_:1}),e(u)=="admin"?(c(),b(f,{key:0,class:"mt-2"},{default:n(()=>[r(y,{modelValue:e(a).is_active,"onUpdate:modelValue":l[11]||(l[11]=t=>e(a).is_active=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Active")},null,8,["modelValue","label"]),r(y,{modelValue:e(a).has_image,"onUpdate:modelValue":l[12]||(l[12]=t=>e(a).has_image=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Need Image")},null,8,["modelValue","label"]),r(y,{modelValue:e(a).has_note,"onUpdate:modelValue":l[13]||(l[13]=t=>e(a).has_note=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Need Note")},null,8,["modelValue","label"]),r(y,{modelValue:e(a).is_pre,"onUpdate:modelValue":l[14]||(l[14]=t=>e(a).is_pre=t),inset:!1,"false-value":0,"true-value":1,label:s.$t("Is Pre")},null,8,["modelValue","label"])]),_:1})):x("",!0),r(m,{class:"px-5 mt-2"},{default:n(()=>[r(X,{color:"primary",loading:e(V),type:"submit",block:""},{default:n(()=>[r(P,{start:"",icon:"tabler-plus"}),Y($(s.$t("Add")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}};typeof S=="function"&&S(pe);export{pe as default};
