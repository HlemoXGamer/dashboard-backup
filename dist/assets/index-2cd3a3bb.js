import{bb as T,a3 as N,ab as U,a5 as L,aw as M,l as b,E as k,R as z,a7 as F,q as l,F as $,ay as O,az as R,X as W,cA as q,aA as j,ac as G,b4 as E,aV as H,aM as J,o as v,b as _,w as d,a2 as B,n as X,y as D,a1 as C,c as I,a as A,s as w,z as Z,G as K,H as Q,A as Y,aZ as P}from"./index-d6ee0790.js";import{t as S}from"./files-2e167225.js";import{V as ee}from"./VFileInput-113516f2.js";import{m as ae,a as te,V as le}from"./VWindowItem-e4c0b92b.js";import"./VChip-2f8d0b0e.js";import"./lazy-11894c6a.js";import"./ssrBoot-cd175d0d.js";let{get:se,show:Ve,update:xe,create:re,remove:ke}=T("/banners"),{get:ne,show:_e,update:Be,create:oe,remove:Ce}=T("markter/banners");const ie=N()({name:"VCarousel",props:{color:String,cycle:Boolean,delimiterIcon:{type:U,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:e=>Number(e)>0},progress:[Boolean,String],verticalDelimiters:[Boolean,String],...ae({continuous:!0,mandatory:"force",showArrows:!0})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:r}=o;const i=L(e,"modelValue"),{t:n}=M(),g=b();let c=-1;k(i,p),k(()=>e.interval,p),k(()=>e.cycle,m=>{m?p():window.clearTimeout(c)}),z(V);function V(){!e.cycle||!g.value||(c=window.setTimeout(g.value.group.next,+e.interval>0?+e.interval:6e3))}function p(){window.clearTimeout(c),window.requestAnimationFrame(V)}return F(()=>l(te,{ref:g,modelValue:i.value,"onUpdate:modelValue":m=>i.value=m,class:["v-carousel",{"v-carousel--hide-delimiter-background":e.hideDelimiterBackground,"v-carousel--vertical-delimiters":e.verticalDelimiters},e.class],style:[{height:j(e.height)},e.style],continuous:!0,mandatory:"force",showArrows:e.showArrows},{default:r.default,additional:m=>{let{group:u}=m;return l($,null,[!e.hideDelimiters&&l("div",{class:"v-carousel__controls",style:{left:e.verticalDelimiters==="left"&&e.verticalDelimiters?0:"auto",right:e.verticalDelimiters==="right"?0:"auto"}},[u.items.value.length>0&&l(O,{defaults:{VBtn:{color:e.color,icon:e.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[u.items.value.map((f,x)=>{const h={id:`carousel-item-${f.id}`,"aria-label":n("$vuetify.carousel.ariaLabel.delimiter",x+1,u.items.value.length),class:[u.isSelected(f.id)&&"v-btn--active"],onClick:()=>u.select(f.id,!0)};return r.item?r.item({props:h,item:f}):l(R,W(f,h),null)})]})]),e.progress&&l(q,{class:"v-carousel__progress",color:typeof e.progress=="string"?e.progress:void 0,modelValue:(u.getItemIndex(i.value)+1)/u.items.value.length*100},null)])},prev:r.prev,next:r.next})),{}}}),ue=N()({name:"VCarouselItem",inheritAttrs:!1,props:{value:null,...G()},setup(e,o){let{slots:r,attrs:i}=o;F(()=>l(le,{class:["v-carousel-item",e.class],style:e.style,value:e.value},{default:()=>[l(E,i,r)]}))}}),ce={class:"text-h4 pt-3 pb-2 px-3"},de={class:"position-relative"},me={__name:"index",setup(e){var h;const o=b([]),r=b([]),i=b(!1),n=b([]),g=H(),c=(h=JSON.parse(localStorage.getItem("userData")))==null?void 0:h.type,V=async t=>{if(t instanceof File){let a=await S(t);n.value.push(a),o.value.push(t)}},p=async()=>{await V(r.value.pop())},m=()=>{c=="admin"?se().then(({data:t})=>{t.data.banners.map(a=>a.image).forEach(a=>{n.value.push(a)}),o.value=t.data.banners.map(a=>a.image)}):c=="markter"&&ne().then(({data:t})=>{t.data.banners.map(a=>a.image).forEach(a=>{n.value.push(a)}),o.value=t.data.banners.map(a=>a.image)})},u=async()=>{i.value=!0;let t=new FormData,a=0;o.value.forEach((s,y)=>{t.append(`banners[${a}]`,s),a++});try{c=="admin"?await re(t).then().finally(()=>{i.value=!1}):c=="markter"&&await oe(t).then().finally(()=>{i.value=!1}),g.success("Banners updated successfully")}catch(s){console.log(s),g.error(s.response.data.message)}},f=async t=>{if(x(t)){const a=n.value.indexOf(t);n.value.splice(a,1),o.value.splice(a,1)}else{const a=n.value.indexOf(t);a!==-1&&n.value.splice(a,1),o.value.forEach(async s=>{s instanceof File&&await S(s).then(y=>{y==t&&o.value.splice(s,1)})})}};function x(t){return/^(ftp|http|https):\/\/[^ "]+$/.test(t)}return J(()=>{m()}),(t,a)=>(v(),_(C,{class:"mt-4 px-4"},{default:d(()=>[l(B,{style:{"background-color":"rgb(var(--v-theme-surface))"},class:"rounded"},{default:d(()=>[X("p",ce,D(t.$t("Banners")),1),l(B,null,{default:d(()=>[l(C,{class:"px-5"},{default:d(()=>[(v(!0),I($,null,A(w(n),(s,y)=>(v(),I("div",de,[l(Z,{class:"position-absolute bg-red rounded px-1",style:{width:"30px",height:"30px","background-color":"rgb(199, 0, 0)","z-index":"2",right:"-5px",top:"-7px"},color:"#fff",icon:"tabler-ban",onClick:fe=>f(s)},null,8,["onClick"]),l(E,{"prepend-icon":"tabler-camera",src:s,width:"150px",style:{height:"150px"},cover:"",class:"mx-1 my-2 rounded"},null,8,["src"])]))),256))]),_:1}),l(C,{align:"center",class:"mt-8 px-5"},{default:d(()=>[l(ee,{class:"px-2",accept:"image/png, image/jpeg, image/bmp","prepend-icon":"tabler-camera",placeholder:"Pick an image",label:t.$t("Upload image"),modelValue:w(r),"onUpdate:modelValue":a[0]||(a[0]=s=>K(r)?r.value=s:null),onChange:p},null,8,["label","modelValue"]),l(R,{onClick:u,loading:w(i)},{default:d(()=>[Q(D(t.$t("Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1}),l(B,{class:"px-5 mt-2"},{default:d(()=>[w(n).length?(v(),_(ie,{key:0,"hide-delimiters":"",class:"rounded mt-2"},{default:d(()=>[(v(!0),I($,null,A(w(n),(s,y)=>(v(),_(ue,{key:y,src:s,cover:""},null,8,["src"]))),128))]),_:1})):Y("",!0)]),_:1})]),_:1})]),_:1}))}};typeof P=="function"&&P(me);export{me as default};
