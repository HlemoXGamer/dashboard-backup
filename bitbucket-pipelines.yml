image: node:14

pipelines:
  default:
    - step:
        name: Build and Deploy
        caches:
          - node
        script:
          # - nvm use v14.21.3
          - echo "$SSH_PRIVATE_KEY" > ~/.ssh/id_rsa
          - chmod 600 ~/.ssh/id_rsa
          - npm install
          - npm run build
          - pipe: atlassian/scp-deploy:1.4.1
            variables:
              USER: 'root'
              SERVER: '164.92.88.138'
              REMOTE_PATH: '/var/www/Sable/dashboard/'
              LOCAL_PATH: 'dist/'
